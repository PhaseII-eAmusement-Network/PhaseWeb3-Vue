import{u as Z,r as E,o as O,a as t,i as f,j as C,c as i,w as d,g as o,b as m,X as D,k as s,t as y,_ as A,F as h,ap as ee,s as le,N as ae,l as te,e as r,m as re,f as x,aB as se,W as j,av as ne,aw as ie,ao as oe,aa as b,z as ue,U as k,aC as ce,aD as de,n as me,p as _e,q as be}from"./index.01bf54cf.js";import{_ as ye,g as U,a as S}from"./ProfileCard.fc7ab485.js";import{_ as pe}from"./FormControl.975fbbf3.js";import{a as fe}from"./profile.100576ae.js";import{g as N}from"./danClass.233b0381.js";import"./userData.bcc92478.js";const ve={class:"flex space-x-2 mb-2"},ge={class:"flex justify-between items-center"},ke={class:"grid"},he={class:"text-lg font-bold"},we={class:"text-md"},Ve={class:"text-lg"},$e={class:"text-lg"},z={__name:"JubilityTable",props:{jubilityData:{type:Array,required:!0},version:{type:Number,required:!0}},setup(F){const w=F,P=Z(),_=E(null),u={0:{label:"Basic",color:"info"},1:{label:"Advanced",color:"warning"},2:{label:"Extreme",color:"danger"}};return O(async()=>{try{_.value=null;const g=w.jubilityData.map(p=>p.song_id),n=await P.getMusicData("jubeat",w.version,g),e=w.jubilityData.map(p=>{const V=n.find($=>$.id===p.song_id&&$.chart===p.chart);return{...p,...V?{songData:V}:{}}});e.sort((p,V)=>V.rate-p.rate),_.value=e}catch(g){console.error("Failed to fetch music data:",g)}}),(g,n)=>_.value?(t(!0),f(h,{key:0},C(_.value,e=>(t(),i(A,{key:e.id,"color-prop":"bg-slate-800 dark:bg-slate-800",class:"my-3 p-5","has-table":""},{default:d(()=>[o("div",ve,[m(D,{label:u[e.chart].label,color:u[e.chart].color},null,8,["label","color"]),e.hard?(t(),i(D,{key:0,label:"Hard Mode",color:"danger"})):s("",!0)]),o("div",ge,[o("div",ke,[o("h1",he,y(e.songData.name),1),o("h2",we,y(e.songData.artist),1)]),o("div",null,[o("h2",Ve,"Jubility: "+y(e.value/10),1),o("h2",$e,"Rate: "+y(e.rate/10),1)])])]),_:2},1024))),128)):s("",!0)}},Se={class:"md:flex pb-6 md:justify-between md:items-center"},De={key:0,class:"mt-2 md:mt-0 md:w-1/3 md:text-right"},Pe=o("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Version ",-1),xe=["src"],je={class:"bg-white dark:bg-slate-900/90 rounded-2xl pt-6 p-3 card-content"},Ne={class:"w-full"},Ce={class:"md:w-1/3 grid grid-cols-1 md:grid-cols-2 gap-3"},Ae={class:"my-6 grid grid-cols-1 md:grid-cols-4 gap-6"},Fe={class:"my-6 grid grid-cols-2 md:grid-cols-5 xl:grid-cols-6 gap-6"},Je={class:"my-6 grid grid-cols-1 md:grid-cols-2 gap-6"},Re={__name:"PlayerView",setup(F){const w=_e(),P=be();var _=null,u=null,g=null;_=w.params.game,g=w.params.userId,u=ee(_),u||P.push({name:"ErrorPage",params:{catchAll:"404"}});const n=le({currentVersion:null});ae(()=>n.currentVersion,()=>{p()});const e=E(null);O(async()=>{p()}),u.versions||(n.currentVersion=1);async function p(){try{e.value=null;const l=await fe(_,n.currentVersion,g);e.value=Q(l),l&&!n.currentVersion&&(n.currentVersion=l.versions[l.versions.length-1])}catch(l){console.error("Failed to fetch user profile data:",l)}}var V=[{label:"Register Date",type:String,span:"md:col-span-2",key:"first_play_timestamp"},{label:"Last Play",type:String,span:"md:col-span-2",key:"last_play_timestamp"},{label:"First Arcade",type:String,span:"md:col-span-2",key:"first_play_arcade"},{label:"Last Arcade",type:String,span:"md:col-span-2",key:"last_play_arcade"},{label:"Total Plays",type:Number,key:"total_plays"},{label:"EXP",type:Number,key:"exp"},{label:"SP Plays",type:Number,key:"single_plays"},{label:"DP Plays",type:Number,key:"double_plays"},{label:"SP DJPOINT",type:Number,key:"single_dj_points"},{label:"DP DJPOINT",type:Number,key:"double_dj_points"}];function $(){return n.currentVersion?`/assets/games/${u.id}/card/${n.currentVersion}.webp`:u.cardBG}function q(){var l;return n.currentVersion&&((l=u.videoTable)==null?void 0:l.includes(n.currentVersion))?`https://web3.phaseii.network/gameassets/video/${u.id}/${n.currentVersion}.mp4`:null}function X(){var l;return(l=u.videoTable)!=null&&l.includes(n.currentVersion)?null:`
      background-image: url('${$()}');
      background-size: cover;
      background-repeat: no-repeat;
    `}function H(l,a){if(a){if(l.isSkill&&a.jubility)return U(a.jubility);if(l.isJubility&&a.records.skill)return S(a.records.skill)}return""}function W(l){var a=[];for(const v of u.versions)l.includes(v.id)&&a.push(v);return a}function K(l,a){return l.isSkill?a.stats[l.key]/100:l.isJubility?a.stats[l.key]/10:a.stats[l.key]}function Q(l){if(l.stats){if(l.stats.first_play_timestamp){const a=new Date(l.stats.first_play_timestamp*1e3);l.stats.first_play_timestamp=a.toLocaleString()}if(l.stats.last_play_timestamp){const a=new Date(l.stats.last_play_timestamp*1e3);l.stats.last_play_timestamp=a.toLocaleString()}l.dp&&l.dp.dan!==void 0&&(l.dp.dan=N(l.dp.dan).short)}return l}function Y(l){var v;const a=(v=l.stats)==null?void 0:v.count;return a?[a.mfc!=null?{label:"MFCs",value:a.mfc}:0,a.pfc!=null?{label:"PFCs",value:a.pfc}:0,a.fc!=null?{label:"GFCs",value:a.fc}:0,a.gfc!=null?{label:"FCs",value:a.gfc}:0,a.life4!=null?{label:"Life-4 Clears",value:a.life4}:0]:[]}return(l,a)=>(t(),i(me,null,{default:d(()=>[e.value?(t(),i(te,{key:0},{default:d(()=>{var v,J,B,I,T,L,G,M,R;return[o("div",Se,[m(x,{icon:r(re),href:`/#/games/${r(_)}`,class:"w-full md:w-auto",color:"info",label:`${r(u).shortName?r(u).shortName:r(u).name} Home`},null,8,["icon","href","label"]),r(u).versions&&e.value?(t(),f("div",De,[Pe,m(pe,{modelValue:n.currentVersion,"onUpdate:modelValue":a[0]||(a[0]=c=>n.currentVersion=c),options:W(e.value.versions)},null,8,["modelValue","options"])])):s("",!0)]),m(j,{icon:r(se),title:"View Profile",main:""},null,8,["icon"]),n.currentVersion&&e.value?(t(),f("div",{key:0,style:oe(X()),class:"rounded-2xl mb-6 card-container"},[o("video",{autoplay:"",muted:"",loop:"",playsinline:"",src:q(),class:"background-video"},null,8,xe),o("div",je,[o("div",Ne,[m(ye,{"use-small":"",game:r(_),version:n.currentVersion,profile:e.value},{default:d(()=>[o("div",Ce,[m(x,{href:`/#/games/${r(_)}/scores/${e.value.userId}`,icon:r(ne),class:"w-full md:w-auto",color:"info",label:"View Scores"},null,8,["href","icon"]),m(x,{href:`/#/games/${r(_)}/records/${e.value.userId}`,icon:r(ie),class:"w-full md:w-auto",color:"info",label:"View Records"},null,8,["href","icon"])])]),_:1},8,["game","version","profile"])])])],4)):s("",!0),o("div",Ae,[(t(!0),f(h,null,C(r(V),c=>(t(),f(h,{key:c},[e.value.stats[c.key]?(t(),i(b,{key:0,class:ue(c.span),label:c.label,number:c.type==Number?K(c,e.value):null,"num-color":H(c)},{default:d(()=>[k(y(c.type==String?e.value.stats[c.key]:null)+" ",1)]),_:2},1032,["class","label","number","num-color"])):s("",!0)],64))),128)),(J=(v=e.value.stats)==null?void 0:v.count)!=null&&J.records?(t(),i(b,{key:0,label:"Records",number:(I=(B=e.value.stats)==null?void 0:B.count)==null?void 0:I.records},null,8,["number"])):s("",!0),(L=(T=e.value.stats)==null?void 0:T.count)!=null&&L.attempts?(t(),i(b,{key:1,label:"Attempts",number:(M=(G=e.value.stats)==null?void 0:G.count)==null?void 0:M.attempts},null,8,["number"])):s("",!0),e.value.skill?(t(),i(b,{key:2,label:"Skill Points",number:e.value.skill/100,"num-color":r(U)(e.value.skill)},null,8,["number","num-color"])):s("",!0),e.value.profile_skill?(t(),i(b,{key:3,label:"Skill Level"},{default:d(()=>[k(y(e.value.profile_skill/100),1)]),_:1})):s("",!0),e.value.jubility?(t(),i(b,{key:4,label:"Jubility","num-color":r(S)(e.value.jubility)},{default:d(()=>[k(y(e.value.jubility/10),1)]),_:1},8,["num-color"])):s("",!0),e.value.pick_up_jubility?(t(),i(b,{key:5,label:"Pick-Up Jubility","num-color":r(S)(e.value.pick_up_jubility)},{default:d(()=>[k(y(e.value.pick_up_jubility/10),1)]),_:1},8,["num-color"])):s("",!0),e.value.common_jubility?(t(),i(b,{key:6,label:"Common Jubility","num-color":r(S)(e.value.common_jubility)},{default:d(()=>[k(y(e.value.common_jubility/10),1)]),_:1},8,["num-color"])):s("",!0),e.value.deller?(t(),i(b,{key:7,label:"Deller",number:e.value.deller},null,8,["number"])):s("",!0),e.value.sgrade?(t(),i(b,{key:8,label:"SP DAN"},{default:d(()=>[k(y(r(N)(e.value.sgrade).label),1)]),_:1})):s("",!0),e.value.dgrade?(t(),i(b,{key:9,label:"DP DAN"},{default:d(()=>[k(y(r(N)(e.value.dgrade).label),1)]),_:1})):s("",!0)]),(R=e.value.stats)!=null&&R.count?(t(),f(h,{key:1},[m(j,{icon:r(ce),title:"Stats",main:""},null,8,["icon"]),o("div",Fe,[(t(!0),f(h,null,C(Y(e.value),c=>(t(),f(h,{key:c},[c.value?(t(),i(b,{key:0,label:c.label,number:c.value},null,8,["label","number"])):s("",!0)],64))),128))])],64)):s("",!0),e.value.jubility?(t(),f(h,{key:2},[m(j,{icon:r(de),title:"Jubility Breakdown",main:""},null,8,["icon"]),o("div",Je,[e.value.pick_up_breakdown?(t(),i(A,{key:0},{default:d(()=>[m(D,{label:"Pick-Up",color:"info"}),m(z,{"jubility-data":e.value.pick_up_breakdown,",":"",version:n.currentVersion},null,8,["jubility-data","version"])]),_:1})):s("",!0),e.value.other_breakdown?(t(),i(A,{key:1},{default:d(()=>[m(D,{label:"Common",color:"info"}),m(z,{"jubility-data":e.value.other_breakdown,",":"",version:n.currentVersion},null,8,["jubility-data","version"])]),_:1})):s("",!0)])],64)):s("",!0)]}),_:1})):s("",!0)]),_:1}))}};export{Re as default};
