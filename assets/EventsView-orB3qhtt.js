import{r as h,o as g,c as k,d as v,w as d,e as a,_ as B,j as N,f as q,F as C,h as i,i as l,P as o,g as u,aH as D,az as P,aI as E,n as I}from"./index-DuDIkw19.js";import{_ as r}from"./GeneralTable-PIxTmObx.js";import{h as M}from"./admin-_mdJyTo9.js";const T={class:"bg-white dark:bg-slate-900/95 rounded-2xl lg:flex lg:justify-between"},y={class:"w-full"},R={class:"bg-white dark:bg-slate-900/95 rounded-2xl lg:flex lg:justify-between"},A={class:"w-full"},V={class:"bg-white dark:bg-slate-900/95 rounded-2xl lg:flex lg:justify-between"},$={class:"w-full"},z={__name:"EventsView",setup(j){const c=h({}),m=h(!0);g(async()=>{try{const t=await M();c.value=t,m.value=!1}catch(t){console.log("Failed to fetch admin data:",t)}});const _=[{text:"Timestamp",value:"date",width:120},{text:"IP Address",value:"data.ip",width:120},{text:"Game",value:"data.model",width:120},{text:"PCBID",value:"data.pcbid",width:120},{text:"Name",value:"data.name",width:120},{text:"Value",value:"data.value",width:120}],x=[{text:"Timestamp",value:"date",width:120},{text:"PCBID",value:"data.pcbid",width:120},{text:"Delta",value:"data.delta",width:120},{text:"Remaining Balance",value:"data.balance",width:120},{text:"Reason",value:"data.reason",width:120}],f=[{text:"Timestamp",value:"date",width:120},{text:"Service",value:"data.service",width:120},{text:"PCBID",value:"data.pcbid",width:120},{text:"Model",value:"data.model",width:120},{text:"Request",value:"data.requestName",width:120},{text:"Method",value:"data.method",width:120},{text:"Traceback",value:"data.traceback",width:120}];function n(t){return t.map(e=>{if(e.timestamp){const s=new Date(e.timestamp*1e3);e.date=s.toLocaleString()}if(e?.data?.service==="xrpc"&&e?.data?.request){const s=w(e.data.request);e.data.pcbid=s.pcbid,e.data.model=s.model,e.data.requestName=s.requestName,e.data.method=s.method}return e})}function w(t){const e=t.match(/<call[^>]*model="([^"]+)"/),s=t.match(/<call[^>]*srcid="([^"]+)"/),p=t.match(/<([^ >]+)[^>]*method="([^"]+)"/),b=t.match(/<call[^>]*>\s*<([^ >]+)/);return{model:e?.[1]||null,pcbid:s?.[1]||null,requestName:b?.[1]||null,method:p?.[2]||null}}return(t,e)=>(v(),k(I,null,{default:d(()=>[a(B,null,{default:d(()=>[m.value?q("",!0):(v(),N(C,{key:0},[a(i,{class:"mb-6 p-1"},{default:d(()=>e[0]||(e[0]=[l("h1",{class:"text-3xl"},"Service Logs",-1)])),_:1,__:[0]}),a(o,{icon:u(D),title:"Recent Tracebacks",color:"text-red-400",main:""},null,8,["icon"]),a(i,{"has-table":"",class:"mb-4"},{default:d(()=>[l("div",T,[l("div",y,[a(r,{headers:f,items:n(c.value?.exception)},null,8,["items"])])])]),_:1}),a(o,{icon:u(P),title:"Recent PCB Events",color:"text-amber-400",main:""},null,8,["icon"]),a(i,{"has-table":"",class:"mb-4"},{default:d(()=>[l("div",R,[l("div",A,[a(r,{headers:_,items:n(c.value?.pcbevent)},null,8,["items"])])])]),_:1}),a(o,{icon:u(E),title:"Recent PASELI Transactions",color:"text-emerald-400",main:""},null,8,["icon"]),a(i,{"has-table":""},{default:d(()=>[l("div",V,[l("div",$,[a(r,{headers:x,items:n(c.value?.paseli_transaction)},null,8,["items"])])])]),_:1})],64))]),_:1})]),_:1}))}};export{z as default};
