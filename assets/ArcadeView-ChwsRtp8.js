import{b as D,r as c,u as G,o as z,c as b,e as s,w as r,f as a,_ as H,l as _,g as m,F as w,k as y,i,P as N,aK as K,j as S,y as O,Q as x,as as Q,n as p,D as I,at as T,au as W,aL as X,av as Y,m as Z,aM as ee,ap as ae,q as le}from"./index-BLNUJ2NM.js";import{_ as te}from"./ArcadeCard-Cha11XwG.js";import{_ as h}from"./FormField-DvuyRx6-.js";import{_ as P}from"./FormCheckRadio-DYx8yVAH.js";import{_ as U}from"./FormControl-C432udtk.js";import{s as V,g as B}from"./values-CmNcmtTU.js";import{A as ne,a as oe,b as ie}from"./arcade-Bdjl_Mk3.js";import{l as se,c as re}from"./admin-BOwxU-p3.js";const de={class:"mb-4 flex gap-2 items-stretch"},ue={key:0,class:"space-x-2 mt-6"},ce={class:"grid grid-cols-1 w-full gap-2 md:gap-6 md:flex md:place-content-stretch"},me={key:0,class:"space-x-2 mt-6"},pe={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-3 mb-6"},we={__name:"ArcadeView",setup(fe){const E=D(),u=c(null),A=c(null),d=c(null),$=c(!0),k=c(null),n=c(null),L=G(),g=parseInt(L.params.id);var C=[{id:"paseli_enabled",name:"PASELI Services",help:"Enable PASELI for this arcade.",type:"Boolean"},{id:"paseli_infinite",name:"Infinite PASELI",help:"Enable infinite PASELI for this arcade.",type:"Boolean"},{id:"maint",name:"Maintenance Mode",help:"Place this arcade under maintenance.",type:"Boolean"},{id:"hide_network",name:"Incognito Mode",help:"Hide the network and all ranking data.",type:"Boolean"}];async function f(){try{d.value={},u.value={},A.value={};const o=await ne(g);d.value=o,n.value=JSON.parse(JSON.stringify(o));for(const e of C){const l=B(d.value.data,e.id);V(u.value,e.id,l),V(A.value,e.id,l)}$.value=!1}catch(o){console.error("Failed to fetch arcade data:",o)}}async function M(){(await oe(g,u.value)).status!="error"&&await f()}z(()=>{f()});function F(o,e="NA_"){var l=[...o].map(v=>v.charCodeAt(0)<128?v:e).join("");return l=l.replace(/[!"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~]/g,""),l=l.replace(/\s+/g,"_"),l}async function R(){try{const o=await ie(g),e=new Blob([o],{type:"application/ovpn"}),l=document.createElement("a");l.href=URL.createObjectURL(e),l.download=`gradius-${F(d.value.name)}-phaseii-config.ovpn`,document.body.appendChild(l),l.click(),URL.revokeObjectURL(l.href),document.body.removeChild(l)}catch(o){console.log("Failed to fetch arcade data:",o)}}async function J(){if(n.value.name){const o=await re(n.value.name);o.unused!=null&&(k.value=o.unused)}}async function j(){(await se(g,{name:n.value.name,description:n.value.description,beta:n.value.data.is_beta})).status!="error"&&await f()}return(o,e)=>(s(),b(le,null,{default:r(()=>[a(H,null,{default:r(()=>{var l,v;return[$.value?m("",!0):(s(),_(w,{key:0},[a(te,{class:"mb-6",arcade:d.value},null,8,["arcade"]),i(E).userAdmin?(s(),_(w,{key:0},[a(N,{icon:i(K),title:"Arcade Administration",main:""},null,8,["icon"]),a(S,{"is-form":"",class:"mb-6",onSubmit:O(j,["prevent"])},{default:r(()=>[a(x,{color:"info",label:"General Information",icon:i(Q),class:"mb-2"},null,8,["icon"]),a(h,{label:"Arcade Name"},{default:r(()=>[a(U,{modelValue:n.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>n.value.name=t),"input-value":n.value.name,name:"arcadeName",required:""},null,8,["modelValue","input-value"])]),_:1}),y("div",de,[a(p,{color:"info",label:"Check Name",onClick:e[1]||(e[1]=t=>J())}),k.value==!0?(s(),b(I,{key:0,path:i(T),color:"text-green-400",size:"25"},null,8,["path"])):k.value==!1?(s(),b(I,{key:1,path:i(W),color:"text-red-400",size:"25"},null,8,["path"])):m("",!0)]),a(h,{label:"Description"},{default:r(()=>[a(U,{modelValue:n.value.description,"onUpdate:modelValue":e[2]||(e[2]=t=>n.value.description=t),name:"description",required:""},null,8,["modelValue"])]),_:1}),a(h,{label:"Beta Enabled"},{default:r(()=>[a(P,{modelValue:n.value.data.is_beta,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value.data.is_beta=t),name:"beta","model-value":n.value.data.is_beta,"input-value":n.value.data.is_beta,type:"switch"},null,8,["modelValue","model-value","input-value"])]),_:1}),JSON.stringify(d.value)!==JSON.stringify(n.value)?(s(),_("div",ue,[a(p,{color:"success",label:"Save",type:"submit"}),a(p,{color:"danger",label:"Revert",onClick:e[4]||(e[4]=t=>f())})])):m("",!0)]),_:1})],64)):m("",!0),a(N,{icon:i(X),title:"Arcade Management",main:""},null,8,["icon"]),a(S,{"is-form":"",class:"mb-6",onSubmit:O(M,["prevent"])},{default:r(()=>[a(x,{color:"info",label:"Settings",icon:i(Y),class:"mb-2"},null,8,["icon"]),y("div",ce,[(s(!0),_(w,null,Z(i(C),t=>(s(),b(h,{key:t.id,label:t.name,help:t.help},{default:r(()=>[t.type=="Boolean"?(s(),b(P,{key:0,name:t.id,"model-value":!!(i(B)(u.value,t.id)??!1),"input-value":!0,type:"switch","onUpdate:modelValue":q=>i(V)(u.value,t.id,q??!1)},null,8,["name","model-value","onUpdate:modelValue"])):m("",!0)]),_:2},1032,["label","help"]))),128))]),JSON.stringify(u.value)!==JSON.stringify(A.value)?(s(),_("div",me,[a(p,{color:"success",label:"Save",type:"submit"}),a(p,{color:"danger",label:"Revert",onClick:e[5]||(e[5]=t=>f())})])):m("",!0)]),_:1}),a(S,{class:"w-full md:w-1/2 mb-6"},{default:r(()=>[e[7]||(e[7]=y("h1",{class:"text-lg md:text-xl"},"OpenVPN Configuration",-1)),e[8]||(e[8]=y("p",{class:"pb-1 dark:text-white/50"}," Use this to download your VPN config. ",-1)),a(p,{small:!1,color:"success",class:"my-2",label:"Export",onClick:e[6]||(e[6]=t=>R())})]),_:1}),a(N,{icon:i(ee),title:"Arcade Overview",main:""},null,8,["icon"]),y("div",pe,[a(ae,{number:(v=(l=d.value)==null?void 0:l.machines)==null?void 0:v.length,label:"Active Machines"},null,8,["number"])])],64))]}),_:1})]),_:1}))}};export{we as default};
