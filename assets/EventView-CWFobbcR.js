import{r as y,B as $,l as D,o as E,X as M,Q as N,c as d,a as s,w as c,b as i,_ as R,d as p,e as m,F as G,f as T,g as r,ay as W,n as Q,p as u,M as X,t as q,h as z,s as x,k as H,ab as O}from"./index-BbEl7F8w.js";import{_ as K}from"./ArcadeCard-CDetx79Z.js";import{_ as U}from"./FormField-B9DH-KpM.js";import{_ as v}from"./FormControl-C6hCQuvp.js";import{_ as Y}from"./FormCheckRadio-DsMQtz6y.js";import{s as b,g as f}from"./values-CmNcmtTU.js";import{A as Z,c as ee,d as ae}from"./arcade-JzALLH2f.js";import"./PhCashRegister.vue-CG5nybhX.js";import"./PhHouse.vue-CJOcjei5.js";const oe={class:"mb-4"},le={class:"grid md:grid-cols-2 gap-4"},te={key:0},ne={key:0},se={class:"text-xl"},re={key:0,class:"space-x-2 mt-6"},ye={__name:"EventView",setup(ie){const t=y(null),l=$({game:null,version:null}),g=$([]),_=y(null),V=y(null),h=y(!0),w=D(),S=parseInt(w.params.id);async function A(){try{V.value=null,t.value={},_.value={};const o=await Z(S);V.value=o,h.value=!1}catch(o){console.error("Failed to fetch arcade data:",o)}}async function k(){try{t.value={},_.value={};const o=await ae(S,l.game,l.version);t.value=JSON.parse(JSON.stringify(o)),_.value=o}catch(o){console.error("Failed to fetch arcade setting data:",o)}}E(()=>{A(),I()});function I(){for(const o of M){const a=o.gameOptions;a&&g.push({game:o.id,gameOptions:a})}}function B(){var o=[];for(const a of g)a.gameOptions&&o.push({id:a.game,label:O(a.game).name});return o}function F(){const o=g.find(n=>n.game==l.game),a=O(l.game);var e=[];for(const n of Object.entries(o.gameOptions))if(a.versions==null)e.push({id:n[0],label:a.name}),l.version=1;else{const L=a.versions.find(P=>P.id==n[0]);e.push({id:n[0],label:L.label})}return e}function C(){const o=O(l.game);var a=null;return o.versions&&(a=o.versions.find(e=>e.id==l.version)),`${o.name} ${a?.label??""}`}function j(){return g.find(a=>a.game==l.game).gameOptions[l.version]}async function J(){(await ee(S,l.game,l.version,t.value)).status!="error"&&await k()}return N(()=>l.game,()=>{l.version=null,t.value={}}),N(()=>l.version,()=>{l.version&&k()}),(o,a)=>(s(),d(H,null,{default:c(()=>[i(R,null,{default:c(()=>[h.value?m("",!0):(s(),p(G,{key:0},[i(K,{class:"mb-6",arcade:V.value,"use-small":!0},null,8,["arcade"]),i(T,{icon:r(W),title:"Game Event Settings",main:""},null,8,["icon"]),i(Q,{class:"mb-6"},{default:c(()=>[u("div",oe,[i(U,{label:"Select Game",help:"Pick a game and version to get started."},{default:c(()=>[u("div",le,[u("div",null,[a[4]||(a[4]=u("p",{class:"pb-2 text-lg"},"Game",-1)),i(v,{modelValue:l.game,"onUpdate:modelValue":a[0]||(a[0]=e=>l.game=e),name:"game",options:B()},null,8,["modelValue","options"])]),l.game?(s(),p("div",te,[a[5]||(a[5]=u("p",{class:"pb-2 text-lg"},"Version",-1)),i(v,{modelValue:l.version,"onUpdate:modelValue":a[1]||(a[1]=e=>l.version=e),name:"version",options:F()},null,8,["modelValue","options"])])):m("",!0)])]),_:1})]),l.game&&l.version?(s(),p("div",ne,[u("h2",se,[a[6]||(a[6]=X(" Settings for ",-1)),u("b",null,q(C()),1)]),a[7]||(a[7]=u("hr",{class:"pb-1 my-2"},null,-1)),(s(!0),p(G,null,z(j(),e=>(s(),d(U,{key:e.id,label:e.name,help:e.help},{default:c(()=>[e.type=="String"?(s(),d(v,{key:0,"model-value":r(f)(t.value,e.id)??"",name:e.name,placeholder:"Not Set","onUpdate:modelValue":n=>r(b)(t.value,e.id,n)},null,8,["model-value","name","onUpdate:modelValue"])):m("",!0),e.type=="LargeText"?(s(),d(v,{key:1,"model-value":r(f)(t.value,e.id)??"",name:e.name,placeholder:"Not Set",type:"textarea","onUpdate:modelValue":n=>r(b)(t.value,e.id,n)},null,8,["model-value","name","onUpdate:modelValue"])):m("",!0),e.type=="Boolean"?(s(),d(Y,{key:2,name:e.id,"model-value":!!(r(f)(t.value,e.id)??0),"input-value":!0,type:"switch","onUpdate:modelValue":n=>r(b)(t.value,e.id,n??0)},null,8,["name","model-value","onUpdate:modelValue"])):m("",!0),e.type=="Array"?(s(),d(v,{key:3,"model-value":r(f)(t.value,e.id)??0,options:e.options,name:e.id,selected:r(f)(t.value,e.id)??0,placeholder:"Select...","onUpdate:modelValue":n=>r(b)(t.value,e.id,Number(n))},null,8,["model-value","options","name","selected","onUpdate:modelValue"])):m("",!0)]),_:2},1032,["label","help"]))),128)),JSON.stringify(t.value)!=JSON.stringify(_.value)?(s(),p("div",re,[i(x,{color:"success",label:"Save",onClick:a[2]||(a[2]=e=>J())}),i(x,{color:"danger",label:"Revert",onClick:a[3]||(a[3]=e=>k())})])):m("",!0)])):m("",!0)]),_:1})],64))]),_:1})]),_:1}))}};export{ye as default};
