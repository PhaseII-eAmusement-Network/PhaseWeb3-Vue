import{a as $,b as T,u as x,a7 as S,r as _,o as I,c as P,d as h,w as d,e as t,_ as A,j as C,f as R,F,g as l,P as y,av as B,l as D,bJ as E,h as N,n as G}from"./index-CZV9MRmx.js";import{_ as L}from"./GeneralTable-duKeEe4G.js";import{_ as H}from"./GameHeader-DRVBaAJl.js";import{A as M}from"./profile-NlEViifW.js";import"./sources-D9OwmSIa.js";const z={__name:"PersonalScores",setup(V){const u=$(),f=T(),g=x();var n=null,e=null,c=null;n=u.params.game,c=u.params.userId,e=S(n),e||f.push({name:"ErrorPage",params:{catchAll:"404"}});const s=_(null),i=_([]),p=[{text:"Timestamp",value:"timestamp",width:140},{text:"New PB",value:"newRecord",width:100},{text:"Song",value:"song.name",width:180},{text:"Artist",value:"song.artist",width:180},{text:"Chart",value:"song.chart",width:100},{text:"Grade",value:"data.rank",width:80},{text:"Score",value:"points",width:120}];if(e.scoreHeaders)for(var k of e.scoreHeaders)p.push(k);I(async()=>{try{const r=await g.getAttemptData(n,c);i.value=w(r)}catch(r){console.error("Failed to fetch score data:",r)}v()});async function v(){try{s.value=null;const r=await M(n,null,c);s.value=r}catch(r){console.error("Failed to fetch user profile data:",r)}}function w(r){var o=[];for(var a of r){if(a.newRecord?a.newRecord="âœ…":a.newRecord="",a.timestamp){const m=new Date(a.timestamp*1e3);a.timestamp=m.toLocaleString()}a.points!=null&&(a.points=a.points.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),a.data?.stats?.score!=null&&(a.exscore=a.points.toString(),a.points=a.data?.stats?.score.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),a.song?.chart!=null&&e.chartTable&&(a.song.chart=e.chartTable[a.song?.chart]),a.data?.halo!=null&&e.haloTable&&(a.data.halo=e.haloTable[a.data?.halo]),a.data?.medal!=null&&e.medalTable&&(a.data.medal=e.medalTable[a.data?.medal]),a.data?.clear_status!=null&&e.medalTable&&(a.data.medal=e.medalTable[a.data?.clear_status]),a.data?.rank!=null&&e.rankTable&&(a.data.rank=e.rankTable[a.data?.rank]),a.data?.result_rank!=null&&e.rankTable&&(a.data.rank=e.rankTable[a.data?.result_rank]),a.data?.grade!=null&&e.rankTable&&(a.data.rank=e.rankTable[a.data?.grade]),a.data?.skill_perc>0?a.data.skill_perc=`${a.data?.skill_perc/100}%`:a.data.skill_perc="0%",a.data?.skill_points&&(a.data.skill_points=a.data?.skill_points/10),a.data?.perc>0?a.data.perc=`${a.data?.perc/100}%`:a.data.perc="0%",a.data?.new_skill&&(a.data.new_skill=a.data?.new_skill/10),a.data?.music_rate&&(a.data.music_rate=a.data?.music_rate/10),a.data?.excellent?a.medal="EX FC":a.data?.fullcombo?a.medal="FC":a.data?.clear?a.medal="CLEARED":a.medal="FAILED",o.push(a)}return o}const b=r=>{const o=r.song.id;f.push(`/games/${n}/song/${o}`)};return(r,o)=>(h(),P(G,null,{default:d(()=>[t(A,null,{default:d(()=>[s.value?(h(),C(F,{key:0},[t(H,{game:l(e),profile:s.value},null,8,["game","profile"]),t(y,{icon:l(B),title:`${s.value.username}'s ${l(e).shortName?l(e).shortName:l(e).name} Scores`,main:""},{default:d(()=>[t(D,{icon:l(E),href:`/#/games/${l(e).id}/profiles/${s.value.userId}`,outline:!1,color:"info",label:`${s.value.username}'s Profile`},null,8,["icon","href","label"])]),_:1},8,["icon","title"]),t(N,{"has-table":""},{default:d(()=>[t(L,{headers:p,items:i.value,onRowClicked:b},null,8,["items"])]),_:1})],64)):R("",!0)]),_:1})]),_:1}))}};export{z as default};
