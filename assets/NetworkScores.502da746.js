import{u as O,a as Q,b as U,ag as W,r as Y,o as Z,c as aa,e as ea,w as l,f as r,g as n,$ as sa,bC as ta,_ as ra,p as na,q as da}from"./index.0899d6d1.js";import{_ as la}from"./GeneralTable.e74dd68c.js";import{_ as oa}from"./GameHeader.99a8772e.js";import"./sources.63bf053b.js";const pa={__name:"NetworkScores",setup(ca){const V=O(),o=Q(),X=U();var d=null,e=null;d=V.params.game,e=W(d),e||o.push({name:"ErrorPage",params:{catchAll:"404"}});const c=Y([]),u=[{text:"Player",value:"username",width:120},{text:"New PB",value:"newRecord",width:100},{text:"Timestamp",value:"timestamp",width:140},{text:"Song",value:"song.name",width:180},{text:"Artist",value:"song.artist",width:150},{text:"Chart",value:"song.chart",width:100},{text:"Grade",value:"data.rank",width:80},{text:"Score",value:"points",width:120}];if(e.scoreHeaders)for(var j of e.scoreHeaders)u.push(j);Z(async()=>{try{const s=await X.getAttemptData(d);c.value=z(s)}catch(s){console.error("Failed to fetch score data:",s)}});function z(s){var f,_,i,p,h,g,k,w,b,v,T,$,x,S,C,R,m,A,B,D,E,I,N,F,y,G,L,P,H,M,q;var t=[];for(var a of s){if(a.newRecord?a.newRecord="\u2705":a.newRecord="",a.timestamp){const K=new Date(a.timestamp*1e3);a.timestamp=K.toLocaleString()}a.points!=null&&(a.points=a.points.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),((_=(f=a.data)==null?void 0:f.stats)==null?void 0:_.score)!=null&&(a.exscore=a.points.toString(),a.points=(p=(i=a.data)==null?void 0:i.stats)==null?void 0:p.score.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),((h=a.song)==null?void 0:h.chart)!=null&&e.chartTable&&(a.song.chart=e.chartTable[(g=a.song)==null?void 0:g.chart]),((k=a.data)==null?void 0:k.halo)!=null&&e.haloTable&&(a.data.halo=e.haloTable[(w=a.data)==null?void 0:w.halo]),((b=a.data)==null?void 0:b.medal)!=null&&e.medalTable&&(a.data.medal=e.medalTable[(v=a.data)==null?void 0:v.medal]),((T=a.data)==null?void 0:T.clear_status)!=null&&e.medalTable&&(a.data.medal=e.medalTable[($=a.data)==null?void 0:$.clear_status]),((x=a.data)==null?void 0:x.rank)!=null&&e.rankTable&&(a.data.rank=e.rankTable[(S=a.data)==null?void 0:S.rank]),((C=a.data)==null?void 0:C.result_rank)!=null&&e.rankTable&&(a.data.rank=e.rankTable[(R=a.data)==null?void 0:R.result_rank]),((m=a.data)==null?void 0:m.grade)!=null&&e.rankTable&&(a.data.rank=e.rankTable[(A=a.data)==null?void 0:A.grade]),((B=a.data)==null?void 0:B.skill_perc)>0?a.data.skill_perc=`${((D=a.data)==null?void 0:D.skill_perc)/100}%`:a.data.skill_perc="0%",(E=a.data)!=null&&E.skill_points&&(a.data.skill_points=((I=a.data)==null?void 0:I.skill_points)/10),((N=a.data)==null?void 0:N.perc)>0?a.data.perc=`${((F=a.data)==null?void 0:F.perc)/100}%`:a.data.perc="0%",(y=a.data)!=null&&y.new_skill&&(a.data.new_skill=((G=a.data)==null?void 0:G.new_skill)/10),(L=a.data)!=null&&L.music_rate&&(a.data.music_rate=((P=a.data)==null?void 0:P.music_rate)/10),(H=a.data)!=null&&H.excellent?a.medal="EX FC":(M=a.data)!=null&&M.fullcombo?a.medal="FC":(q=a.data)!=null&&q.clear?a.medal="CLEARED":a.medal="FAILED",t.push(a)}return t}const J=s=>{const t=s.song.id;o.push(`/games/${d}/song/${t}`)};return(s,t)=>(aa(),ea(da,null,{default:l(()=>[r(na,null,{default:l(()=>[r(oa,{game:n(e)},null,8,["game"]),r(sa,{icon:n(ta),title:`All ${n(e).shortName?n(e).shortName:n(e).name} Scores`,main:""},null,8,["icon","title"]),r(ra,{"has-table":""},{default:l(()=>[r(la,{headers:u,items:c.value,onRowClicked:J},null,8,["items"])]),_:1})]),_:1})]),_:1}))}};export{pa as default};
