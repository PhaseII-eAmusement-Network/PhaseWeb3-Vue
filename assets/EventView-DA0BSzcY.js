import{r as y,p as $,u as j,o as D,R as E,L as O,c as d,d as s,w as c,e as i,_ as M,j as p,f as m,F as G,N as T,g as r,aR as W,h as H,i as u,H as q,t as z,k as K,l as x,n as Q,a4 as N}from"./index-vA9N45XP.js";import{_ as X}from"./ArcadeCard-DnKlr5sp.js";import{_ as U}from"./FormField-BJ53twuK.js";import{_ as v}from"./FormControl-CbA50xCq.js";import{_ as Y}from"./FormCheckRadio-Roj-HW28.js";import{s as V,g as f}from"./values-CmNcmtTU.js";import{A as Z,c as ee,d as ae}from"./arcade-CXvzpsdX.js";const le={class:"mb-4"},oe={class:"grid md:grid-cols-2 gap-4"},te={key:0},ne={key:0},se={class:"text-xl"},re={key:0,class:"space-x-2 mt-6"},ge={__name:"EventView",setup(ie){const t=y(null),o=$({game:null,version:null}),g=$([]),_=y(null),b=y(null),h=y(!0),w=j(),S=parseInt(w.params.id);async function A(){try{b.value=null,t.value={},_.value={};const l=await Z(S);b.value=l,h.value=!1}catch(l){console.error("Failed to fetch arcade data:",l)}}async function k(){try{t.value={},_.value={};const l=await ae(S,o.game,o.version);t.value=JSON.parse(JSON.stringify(l)),_.value=l}catch(l){console.error("Failed to fetch arcade setting data:",l)}}D(()=>{A(),F()});function F(){for(const l of E){const e=l.gameOptions;e&&g.push({game:l.id,gameOptions:e})}}function I(){var l=[];for(const e of g)e.gameOptions&&l.push({id:e.game,label:N(e.game).name});return l}function B(){const l=g.find(n=>n.game==o.game),e=N(o.game);var a=[];for(const n of Object.entries(l.gameOptions))if(e.versions==null)a.push({id:n[0],label:e.name}),o.version=1;else{const P=e.versions.find(R=>R.id==n[0]);a.push({id:n[0],label:P.label})}return a}function C(){const l=N(o.game);var e=null;return l.versions&&(e=l.versions.find(a=>a.id==o.version)),`${l.name} ${(e==null?void 0:e.label)??""}`}function L(){return g.find(e=>e.game==o.game).gameOptions[o.version]}async function J(){(await ee(S,o.game,o.version,t.value)).status!="error"&&await k()}return O(()=>o.game,()=>{o.version=null,t.value={}}),O(()=>o.version,()=>{o.version&&k()}),(l,e)=>(s(),d(Q,null,{default:c(()=>[i(M,null,{default:c(()=>[h.value?m("",!0):(s(),p(G,{key:0},[i(X,{class:"mb-6",arcade:b.value,"use-small":!0},null,8,["arcade"]),i(T,{icon:r(W),title:"Game Event Settings",main:""},null,8,["icon"]),i(H,{class:"mb-6"},{default:c(()=>[u("div",le,[i(U,{label:"Select Game",help:"Pick a game and version to get started."},{default:c(()=>[u("div",oe,[u("div",null,[e[4]||(e[4]=u("p",{class:"pb-2 text-lg"},"Game",-1)),i(v,{modelValue:o.game,"onUpdate:modelValue":e[0]||(e[0]=a=>o.game=a),name:"game",options:I()},null,8,["modelValue","options"])]),o.game?(s(),p("div",te,[e[5]||(e[5]=u("p",{class:"pb-2 text-lg"},"Version",-1)),i(v,{modelValue:o.version,"onUpdate:modelValue":e[1]||(e[1]=a=>o.version=a),name:"version",options:B()},null,8,["modelValue","options"])])):m("",!0)])]),_:1})]),o.game&&o.version?(s(),p("div",ne,[u("h2",se,[e[6]||(e[6]=q(" Settings for ")),u("b",null,z(C()),1)]),e[7]||(e[7]=u("hr",{class:"pb-1 my-2"},null,-1)),(s(!0),p(G,null,K(L(),a=>(s(),d(U,{key:a.id,label:a.name,help:a.help},{default:c(()=>[a.type=="String"?(s(),d(v,{key:0,"model-value":r(f)(t.value,a.id)??"",name:a.name,placeholder:"Not Set","onUpdate:modelValue":n=>r(V)(t.value,a.id,n)},null,8,["model-value","name","onUpdate:modelValue"])):m("",!0),a.type=="LargeText"?(s(),d(v,{key:1,"model-value":r(f)(t.value,a.id)??"",name:a.name,placeholder:"Not Set",type:"textarea","onUpdate:modelValue":n=>r(V)(t.value,a.id,n)},null,8,["model-value","name","onUpdate:modelValue"])):m("",!0),a.type=="Boolean"?(s(),d(Y,{key:2,name:a.id,"model-value":!!(r(f)(t.value,a.id)??0),"input-value":!0,type:"switch","onUpdate:modelValue":n=>r(V)(t.value,a.id,n??0)},null,8,["name","model-value","onUpdate:modelValue"])):m("",!0),a.type=="Array"?(s(),d(v,{key:3,"model-value":r(f)(t.value,a.id)??0,options:a.options,name:a.id,selected:r(f)(t.value,a.id)??0,placeholder:"Select...","onUpdate:modelValue":n=>r(V)(t.value,a.id,Number(n))},null,8,["model-value","options","name","selected","onUpdate:modelValue"])):m("",!0)]),_:2},1032,["label","help"]))),128)),JSON.stringify(t.value)!=JSON.stringify(_.value)?(s(),p("div",re,[i(x,{color:"success",label:"Save",onClick:e[2]||(e[2]=a=>J())}),i(x,{color:"danger",label:"Revert",onClick:e[3]||(e[3]=a=>k())})])):m("",!0)])):m("",!0)]),_:1})],64))]),_:1})]),_:1}))}};export{ge as default};
