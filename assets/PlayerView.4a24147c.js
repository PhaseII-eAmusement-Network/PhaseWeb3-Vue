import{u as I,r as A,o as L,a as r,i as f,j,c as o,w as d,g as c,b as m,R as P,k as n,t as _,_ as N,F as h,ad as O,s as z,N as H,l as X,e as s,m as Y,f as x,aq as K,P as F,ak as Q,al as W,ac as Z,aj as y,y as ee,Y as v,ar as le,n as ae,p as te,q as re}from"./index.3929e2aa.js";import{_ as se,g as J,a as V}from"./ProfileCard.4e618e9e.js";import{_ as ie}from"./FormControl.051ee0f7.js";import{g as D}from"./danClass.233b0381.js";import"./userData.bcc92478.js";const ne={class:"flex space-x-2 mb-2"},oe={class:"flex justify-between items-center"},ue={class:"grid"},ce={class:"text-lg font-bold"},de={class:"text-md"},me={class:"text-lg"},_e={class:"text-lg"},B={__name:"JubilityTable",props:{jubilityData:{type:Array,required:!0},version:{type:Number,required:!0}},setup(C){const g=C,S=I(),k=A(null),b={0:{label:"Basic",color:"info"},1:{label:"Advanced",color:"warning"},2:{label:"Extreme",color:"danger"}};return L(async()=>{try{k.value=null;const u=g.jubilityData.map(e=>e.song_id),w=await S.getMusicData("jubeat",g.version,u),t=g.jubilityData.map(e=>{const p=w.find($=>$.id===e.song_id&&$.chart===e.chart);return{...e,...p?{songData:p}:{}}});t.sort((e,p)=>p.rate-e.rate),k.value=t}catch(u){console.error("Failed to fetch music data:",u)}}),(u,w)=>k.value?(r(!0),f(h,{key:0},j(k.value,t=>(r(),o(N,{key:t.id,"color-prop":"bg-slate-800 dark:bg-slate-800",class:"my-3 p-5","has-table":""},{default:d(()=>[c("div",ne,[m(P,{label:b[t.chart].label,color:b[t.chart].color},null,8,["label","color"]),t.hard?(r(),o(P,{key:0,label:"Hard Mode",color:"danger"})):n("",!0)]),c("div",oe,[c("div",ue,[c("h1",ce,_(t.songData.name),1),c("h2",de,_(t.songData.artist),1)]),c("div",null,[c("h2",me,"Jubility: "+_(t.value/10),1),c("h2",_e,"Rate: "+_(t.rate/10),1)])])]),_:2},1024))),128)):n("",!0)}},be={class:"md:flex pb-6 md:justify-between md:items-center"},ye={key:0,class:"mt-2 md:mt-0 md:w-1/3 md:text-right"},fe=c("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Version ",-1),pe={class:"bg-white dark:bg-slate-900/90 rounded-2xl pt-6 p-3"},ve={class:"w-full"},ge={class:"md:w-1/3 grid grid-cols-1 md:grid-cols-2 gap-3"},ke={class:"my-6 grid grid-cols-1 md:grid-cols-4 gap-6"},he={key:1,class:"my-6 grid grid-cols-2 md:grid-cols-5 xl:grid-cols-6 gap-6"},we={class:"my-6 grid grid-cols-1 md:grid-cols-2 gap-6"},De={__name:"PlayerView",setup(C){const g=te(),S=re(),k=I();var b=null,u=null,w=null;b=g.params.game,w=g.params.userId,u=O(b),u||S.push({name:"ErrorPage",params:{catchAll:"404"}});const t=z({currentVersion:null});H(()=>t.currentVersion,()=>{p()});const e=A(null);L(async()=>{p()}),u.versions||(t.currentVersion=1);async function p(){try{e.value=null;const l=await k.getUserProfile(b,t.currentVersion,w);e.value=q(l),l&&!t.currentVersion&&(t.currentVersion=l.versions[l.versions.length-1])}catch(l){console.error("Failed to fetch user profile data:",l)}}var $=[{label:"Register Date",type:String,span:"md:col-span-2",key:"first_play_timestamp"},{label:"Last Play",type:String,span:"md:col-span-2",key:"last_play_timestamp"},{label:"First Arcade",type:String,span:"md:col-span-2",key:"first_play_arcade"},{label:"Last Arcade",type:String,span:"md:col-span-2",key:"last_play_arcade"},{label:"Total Plays",type:Number,key:"total_plays"},{label:"EXP",type:Number,key:"exp"},{label:"SP Plays",type:Number,key:"single_plays"},{label:"DP Plays",type:Number,key:"double_plays"},{label:"SP DJPOINT",type:Number,key:"single_dj_points"},{label:"DP DJPOINT",type:Number,key:"double_dj_points"}];function T(){var l=null;return t.currentVersion?l=`/assets/games/${u.id}/card/${t.currentVersion}.webp`:l=u.cardBG,l}function M(){return`
      background-image: url('${T()}');
      background-size: cover;
      background-repeat: no-repeat;
    `}function R(l,a){if(a){if(l.isSkill&&a.jubility)return J(a.jubility);if(l.isJubility&&a.records.skill)return V(a.records.skill)}return""}function G(l){var a=[];for(const i of u.versions)l.includes(i.id)&&a.push(i);return a}function U(l,a){return l.isSkill?a.stats[l.key]/100:l.isJubility?a.stats[l.key]/10:a.stats[l.key]}function q(l){if(l.stats){if(l.stats.first_play_timestamp){const a=new Date(l.stats.first_play_timestamp*1e3);l.stats.first_play_timestamp=a.toLocaleString()}if(l.stats.last_play_timestamp){const a=new Date(l.stats.last_play_timestamp*1e3);l.stats.last_play_timestamp=a.toLocaleString()}l.dp&&l.dp.dan!==void 0&&(l.dp.dan=D(l.dp.dan).short)}return l}function E(l){const a=l.stats[`count_${t.currentVersion}`];return a?[a.mfc!=null?{label:"MFCs",value:a.mfc}:0,a.pfc!=null?{label:"PFCs",value:a.pfc}:0,a.fc!=null?{label:"GFCs",value:a.fc}:0,a.gfc!=null?{label:"FCs",value:a.gfc}:0,a.life4!=null?{label:"Life-4 Clears",value:a.life4}:0]:[]}return(l,a)=>(r(),o(ae,null,{default:d(()=>[e.value?(r(),o(X,{key:0},{default:d(()=>[c("div",be,[m(x,{icon:s(Y),href:`/#/games/${s(b)}`,class:"w-full md:w-auto",color:"info",label:`${s(u).shortName?s(u).shortName:s(u).name} Home`},null,8,["icon","href","label"]),s(u).versions&&e.value?(r(),f("div",ye,[fe,m(ie,{modelValue:t.currentVersion,"onUpdate:modelValue":a[0]||(a[0]=i=>t.currentVersion=i),options:G(e.value.versions)},null,8,["modelValue","options"])])):n("",!0)]),m(F,{icon:s(K),title:"View Profile",main:""},null,8,["icon"]),t.currentVersion&&e.value?(r(),f("div",{key:0,style:Z(M()),class:"rounded-2xl mb-6"},[c("div",pe,[c("div",ve,[m(se,{"use-small":"",game:s(b),version:t.currentVersion,profile:e.value},{default:d(()=>[c("div",ge,[m(x,{href:`/#/games/${s(b)}/scores/${e.value.userId}`,icon:s(Q),class:"w-full md:w-auto",color:"info",label:"View Scores"},null,8,["href","icon"]),m(x,{href:`/#/games/${s(b)}/records/${e.value.userId}`,icon:s(W),class:"w-full md:w-auto",color:"info",label:"View Records"},null,8,["href","icon"])])]),_:1},8,["game","version","profile"])])])],4)):n("",!0),c("div",ke,[(r(!0),f(h,null,j(s($),i=>(r(),f(h,{key:i},[e.value.stats[i.key]?(r(),o(y,{key:0,class:ee(i.span),label:i.label,number:i.type==Number?U(i,e.value):null,"num-color":R(i)},{default:d(()=>[v(_(i.type==String?e.value.stats[i.key]:null)+" ",1)]),_:2},1032,["class","label","number","num-color"])):n("",!0)],64))),128)),e.value.skill?(r(),o(y,{key:0,label:"Skill Points",number:e.value.skill/100,"num-color":s(J)(e.value.skill)},null,8,["number","num-color"])):n("",!0),e.value.profile_skill?(r(),o(y,{key:1,label:"Skill Level"},{default:d(()=>[v(_(e.value.profile_skill/100),1)]),_:1})):n("",!0),e.value.jubility?(r(),o(y,{key:2,label:"Jubility","num-color":s(V)(e.value.jubility)},{default:d(()=>[v(_(e.value.jubility/10),1)]),_:1},8,["num-color"])):n("",!0),e.value.pick_up_jubility?(r(),o(y,{key:3,label:"Pick-Up Jubility","num-color":s(V)(e.value.pick_up_jubility)},{default:d(()=>[v(_(e.value.pick_up_jubility/10),1)]),_:1},8,["num-color"])):n("",!0),e.value.common_jubility?(r(),o(y,{key:4,label:"Common Jubility","num-color":s(V)(e.value.common_jubility)},{default:d(()=>[v(_(e.value.common_jubility/10),1)]),_:1},8,["num-color"])):n("",!0),e.value.deller?(r(),o(y,{key:5,label:"Deller",number:e.value.deller},null,8,["number"])):n("",!0),e.value.sgrade?(r(),o(y,{key:6,label:"SP DAN"},{default:d(()=>[v(_(s(D)(e.value.sgrade).label),1)]),_:1})):n("",!0),e.value.dgrade?(r(),o(y,{key:7,label:"DP DAN"},{default:d(()=>[v(_(s(D)(e.value.dgrade).label),1)]),_:1})):n("",!0)]),e.value.stats[`count_${t.currentVersion}`]?(r(),f("div",he,[(r(!0),f(h,null,j(E(e.value),i=>(r(),f(h,{key:i},[i.value?(r(),o(y,{key:0,label:i.label,number:i.value},null,8,["label","number"])):n("",!0)],64))),128))])):n("",!0),e.value.jubility?(r(),f(h,{key:2},[m(F,{icon:s(le),title:"Jubility Breakdown",main:""},null,8,["icon"]),c("div",we,[e.value.pick_up_breakdown?(r(),o(N,{key:0},{default:d(()=>[m(P,{label:"Pick-Up",color:"info"}),m(B,{"jubility-data":e.value.pick_up_breakdown,",":"",version:t.currentVersion},null,8,["jubility-data","version"])]),_:1})):n("",!0),e.value.other_breakdown?(r(),o(N,{key:1},{default:d(()=>[m(P,{label:"Common",color:"info"}),m(B,{"jubility-data":e.value.other_breakdown,",":"",version:t.currentVersion},null,8,["jubility-data","version"])]),_:1})):n("",!0)])],64)):n("",!0)]),_:1})):n("",!0)]),_:1}))}};export{De as default};
