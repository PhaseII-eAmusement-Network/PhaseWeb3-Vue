import{r as w,u as I,N as U,a as i,c as u,w as _,b as c,W as R,X as D,e as F,$ as L,g as m,i as f,j as x,_ as C,f as h,k as d,Y as N,V as P,t as p,F as V,l as T,n as B,p as H,q as O,a0 as W,a1 as q}from"./index.9ae50f2b.js";import{e as M,f as j}from"./account.021470cf.js";const z={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},E={key:0,class:"text-lg"},K={key:1,class:"text-lg"},Q={class:"space-x-2"},Z={__name:"IntegrationView",setup(X){const b=H(),k=O(),y="https://discord.com/oauth2/authorize?client_id=947985989421395988&response_type=code&redirect_uri=https%3A%2F%2Fweb3.phaseii.network%2F%23%2Fprofile%2Fintegrate%2Fdiscord&scope=identify",$="https://kamai.tachi.ac/oauth/request-auth?clientID=CIce4260e1939ceed11c8e48ee857a3aef2a87ba56",g=w(b.params.service);if(g.value){const t=new URLSearchParams(window.location.search),s=t.get("code");t.delete("code"),s!==void 0&&(console.log(s),A(g.value,s))}const r=I(),a=w(r.userData);U(()=>r.userData,t=>{a.value=t});const S=[{id:"discord",name:"Discord",icon:W,oAuth:y},{id:"tachi",name:"Kamaitachi",icon:q,oAuth:$}];async function v(t){await j(t.id)&&(r.userLoaded=!1,r.loadUser(),k.push({name:"profile_integrations"}))}async function A(t,s){if(await M(t,s)){const n=new URLSearchParams(window.location.search);n.delete("code");const o=n.toString(),l=`${window.location.pathname}${o?"?"+o:""}`;window.history.replaceState(null,"",l),r.userLoaded=!1,r.loadUser(),k.push({name:"profile_integrations"})}}return(t,s)=>(i(),u(B,null,{default:_(()=>[c(T,null,{default:_(()=>[c(R,{class:"mb-6","use-small":"","even-smaller":""}),c(D,{icon:F(L),title:"Server Integrations",main:""},null,8,["icon"]),m("div",z,[(i(),f(V,null,x(S,e=>c(C,{key:e.id},{footer:_(()=>{var n,o,l;return[m("div",Q,[!a.value[e.id]||!((n=a.value[e.id])!=null&&n.linked)?(i(),u(h,{key:0,color:"success",label:"Link Now",href:e.oAuth,target:"_blank"},null,8,["href"])):d("",!0),a.value[e.id]&&((o=a.value[e.id])==null?void 0:o.linked)?(i(),u(h,{key:1,color:"info",label:"Relink",href:e.oAuth,target:"_blank"},null,8,["href"])):d("",!0),a.value[e.id]&&((l=a.value[e.id])==null?void 0:l.linked)?(i(),u(h,{key:2,color:"danger",label:"Unlink",onClick:Y=>v(e)},null,8,["onClick"])):d("",!0)])]}),default:_(()=>{var n,o,l;return[c(N,{color:"info",icon:e.icon,label:e.name,class:"mb-2"},null,8,["icon","label"]),a.value[e.id]&&((n=a.value[e.id])==null?void 0:n.linked)?(i(),f("h1",E,[P(p(e.name)+" is linked to ",1),m("b",null,p((o=a.value[e.id])==null?void 0:o.username),1)])):d("",!0),!a.value[e.id]||!((l=a.value[e.id])!=null&&l.linked)?(i(),f("h1",K,p(e.name)+" isn't linked! ",1)):d("",!0)]}),_:2},1024)),64))])]),_:1})]),_:1}))}};export{Z as default};
