import{u as Y,r as m,a as Z,b as ee,D as ae,o as le,c as _,d as i,w as o,e as l,_ as ne,j as b,f as g,F as w,i as s,g as r,J as x,h as y,s as S,K as k,l as d,v as L,ao as te,L as se,k as R,as as oe,t as ie,aq as re,ag as de,m as ce}from"./index-DJGMd7tL.js";import{H as ue}from"./PhCheckCircle.vue-CTjb5yTx.js";import{F as P}from"./PhGear.vue-Bo3l1eNn.js";import{H as D}from"./PhInfo.vue-DGrHrQvw.js";import{_ as me}from"./ArcadeCard-BS5SlV1H.js";import{_ as h}from"./FormField-CRsa5bYy.js";import{_ as F}from"./FormCheckRadio-D7QHfqJb.js";import{_ as C}from"./FormControl-DC2h-_Ln.js";import{_ as fe}from"./BaseButtons-CONJcBRF.js";import{s as U,g as J}from"./values-CmNcmtTU.js";import{A as pe,a as ve,b as _e}from"./arcade-BJDK-ETj.js";import{m as be,s as ge,c as Ae,t as ye,u as he,v as we}from"./admin-w3ER0L90.js";import"./PhCashRegister.vue-1JwhnVql.js";import"./PhHouse.vue-DWtKbWDv.js";const ke={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},$e={class:"mb-4 flex gap-2 items-stretch"},Ve={key:0,class:"space-x-2 mt-6 mb-4"},Ne={class:"mb-4"},xe={class:"mb-4"},Se={class:"grid gap-4"},Pe={class:"flex justify-between items-center"},Ce={class:"m-[-5px] md:flex items-center gap-2"},Ue={class:"w-8 md:w-12"},Ie={class:"text-lg lg:text-xl font-bold"},Me={class:"grid grid-cols-1 w-full gap-2 md:gap-6 md:flex md:place-content-stretch"},Oe={key:0,class:"space-x-2 mt-6"},Be={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-3 mb-6"},Xe={__name:"ArcadeView",setup(Ee){const $=Y(),v=m(null),V=m(null),c=m(null),I=m(!0),N=m(null),t=m(null),A=m(null),M=m(null),j=Z(),O=ee(),f=parseInt(j.params.id);var B=[{id:"paseli_enabled",name:"PASELI Services",help:"Enable PASELI for this arcade.",type:"Boolean"},{id:"paseli_infinite",name:"Infinite PASELI",help:"Enable infinite PASELI for this arcade.",type:"Boolean"},{id:"maint",name:"Maintenance Mode",help:"Place this arcade under maintenance.",type:"Boolean"},{id:"hide_network",name:"Incognito Mode",help:"Hide the network and all ranking data.",type:"Boolean"}];async function p(){try{c.value={},v.value={},V.value={};const n=await pe(f);c.value=n,t.value=JSON.parse(JSON.stringify(n));for(const a of B){const e=J(c.value.data,a.id);U(v.value,a.id,e),U(V.value,a.id,e)}I.value=!1}catch(n){console.error("Failed to fetch arcade data:",n)}}async function E(){if($.userAdmin)try{const n=await be(!0),a=[];for(const e of n)e.username!=null&&a.push({id:e.id,label:e.username});a.sort((e,u)=>e.label.localeCompare(u.label)),M.value=a}catch(n){console.error("Failed to fetch admin user data:",n)}}ae(()=>$.userAdmin,()=>{E()});async function G(){(await ve(f,v.value)).status!="error"&&await p()}le(()=>{p(),E()});function q(n,a="NA_"){var e=[...n].map(u=>u.charCodeAt(0)<128?u:a).join("");return e=e.replace(/[!"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~]/g,""),e=e.replace(/\s+/g,"_"),e}async function H(){try{const n=await _e(f),a=new Blob([n],{type:"application/ovpn"}),e=document.createElement("a");e.href=URL.createObjectURL(a),e.download=`gradius-${q(c.value.name)}-phaseii-config.ovpn`,document.body.appendChild(e),e.click(),URL.revokeObjectURL(e.href),document.body.removeChild(e)}catch(n){console.log("Failed to fetch arcade data:",n)}}async function z(){if(t.value.name){const n=await Ae(t.value.name);n.unused!=null&&(N.value=n.unused)}}async function T(){(await ge(f,{name:t.value.name,description:t.value.description,beta:t.value.data.is_beta})).status!="error"&&await p()}async function K(){if(A.value==null)return;(await he(f,A.value)).status!="error"&&(A.value=null,p())}async function Q(n){if(!n)return;(await we(f,n)).status!="error"&&p()}async function W(){window.confirm(`Are you really?
This will remove all owners, machines, and arcade data.`)&&(await ye(f)).status!="error"&&await O.push({name:"admin_arcades"})}const X=n=>{O.push(`/profiles/${n}`)};return(n,a)=>(i(),_(ce,null,{default:o(()=>[l(ne,null,{default:o(()=>[I.value?g("",!0):(i(),b(w,{key:0},[l(me,{class:"mb-6",arcade:c.value},null,8,["arcade"]),r($).userAdmin?(i(),b(w,{key:0},[l(x,{icon:r(P),title:"Arcade Administration",main:""},null,8,["icon"]),s("div",ke,[l(y,{"is-form":"",class:"lg:mb-6",onSubmit:S(T,["prevent"])},{default:o(()=>[l(k,{color:"info",label:"General Information",icon:r(D),class:"mb-2"},null,8,["icon"]),l(h,{label:"Arcade Name"},{default:o(()=>[l(C,{modelValue:t.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value.name=e),"input-value":t.value.name,name:"arcadeName",required:""},null,8,["modelValue","input-value"])]),_:1}),s("div",$e,[l(d,{color:"info",label:"Check Name",onClick:a[1]||(a[1]=e=>z())}),N.value==!0?(i(),_(L,{key:0,icon:r(ue),color:"text-green-400",size:"25"},null,8,["icon"])):N.value==!1?(i(),_(L,{key:1,icon:r(te),color:"text-red-400",size:"25"},null,8,["icon"])):g("",!0)]),l(h,{label:"Description"},{default:o(()=>[l(C,{modelValue:t.value.description,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value.description=e),name:"description",required:""},null,8,["modelValue"])]),_:1}),l(h,{label:"Beta Enabled"},{default:o(()=>[l(F,{modelValue:t.value.data.is_beta,"onUpdate:modelValue":a[3]||(a[3]=e=>t.value.data.is_beta=e),name:"beta","model-value":t.value.data.is_beta,"input-value":t.value.data.is_beta,type:"switch"},null,8,["modelValue","model-value","input-value"])]),_:1}),JSON.stringify(c.value)!==JSON.stringify(t.value)?(i(),b("div",Ve,[l(d,{color:"success",label:"Save",type:"submit"}),l(d,{color:"warning",label:"Revert",onClick:a[4]||(a[4]=e=>p())})])):g("",!0),s("div",null,[l(d,{color:"danger",label:"Delete Arcade",onClick:a[5]||(a[5]=e=>W())})])]),_:1}),l(y,{class:"mb-6"},{default:o(()=>[s("div",Ne,[l(k,{color:"info",label:"Add Manager",icon:r(D),class:"mb-2"},null,8,["icon"]),s("form",{class:"h-full",onSubmit:S(K,["prevent"])},[l(h,{label:"Username"},{default:o(()=>[l(C,{modelValue:A.value,"onUpdate:modelValue":a[6]||(a[6]=e=>A.value=e),name:"username",options:M.value,required:""},null,8,["modelValue","options"])]),_:1}),l(d,{color:"success",type:"submit",label:"Add Manager"})],32)]),l(se),s("div",xe,[l(k,{color:"warning",label:"Managers",class:"mb-4"}),s("div",Se,[(i(!0),b(w,null,R(c.value.owners,e=>(i(),_(y,{key:e,"color-prop":"bg-slate-800 dark:bg-slate-800"},{default:o(()=>[s("div",Pe,[s("div",Ce,[s("div",Ue,[l(oe,{username:e.username,avatar:e.avatar},null,8,["username","avatar"])]),s("h1",Ie,ie(e.username),1)]),l(fe,null,{default:o(()=>[l(d,{label:"Open Profile",color:"info",onClick:u=>X(e.id)},null,8,["onClick"]),l(d,{color:"danger",label:"Remove",onClick:u=>Q(e.id)},null,8,["onClick"])]),_:2},1024)])]),_:2},1024))),128))])])]),_:1})])],64)):g("",!0),l(x,{icon:r(P),title:"Arcade Management",main:""},null,8,["icon"]),l(y,{"is-form":"",class:"mb-6",onSubmit:S(G,["prevent"])},{default:o(()=>[l(k,{color:"info",label:"Settings",icon:r(P),class:"mb-2"},null,8,["icon"]),s("div",Me,[(i(!0),b(w,null,R(r(B),e=>(i(),_(h,{key:e.id,label:e.name,help:e.help},{default:o(()=>[e.type=="Boolean"?(i(),_(F,{key:0,name:e.id,"model-value":!!(r(J)(v.value,e.id)??!1),"input-value":!0,type:"switch","onUpdate:modelValue":u=>r(U)(v.value,e.id,u??!1)},null,8,["name","model-value","onUpdate:modelValue"])):g("",!0)]),_:2},1032,["label","help"]))),128))]),JSON.stringify(v.value)!==JSON.stringify(V.value)?(i(),b("div",Oe,[l(d,{color:"success",label:"Save",type:"submit"}),l(d,{color:"danger",label:"Revert",onClick:a[7]||(a[7]=e=>p())})])):g("",!0)]),_:1}),l(y,{class:"w-full md:w-1/2 mb-6"},{default:o(()=>[a[9]||(a[9]=s("h1",{class:"text-lg md:text-xl"},"OpenVPN Configuration",-1)),a[10]||(a[10]=s("p",{class:"pb-1 dark:text-white/50"}," Use this to download your VPN config. ",-1)),l(d,{small:!1,color:"success",class:"my-2",label:"Export",onClick:a[8]||(a[8]=e=>H())})]),_:1,__:[9,10]}),l(x,{icon:r(re),title:"Arcade Overview",main:""},null,8,["icon"]),s("div",Be,[l(de,{number:c.value?.machines?.length,label:"Active Machines"},null,8,["number"])])],64))]),_:1})]),_:1}))}};export{Xe as default};
