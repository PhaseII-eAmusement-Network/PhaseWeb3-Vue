import{u as S,Y as E,c as m,a as d,w as n,b as e,_ as G,p as c,N as B,f as I,g as L,I as N,O as x,n as p,q as f,d as V,F as U,h as F,t as j,e as M,k as O,af as q,a5 as z,a8 as v}from"./index-CzFGUGVD.js";import{_}from"./FormField-CX5ENjvM.js";import{e as i}from"./contentExport-BLtRrY5c.js";import{A as h}from"./profile-DpgDJbCL.js";import{g as J,A as K}from"./music-Dv5JVI1H.js";const R={class:"grid grid-cols-1 sm:grid-cols-2 gap-6 mb-6"},T={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},Y={class:"text-xl font-bold"},H={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},oa={__name:"ExportView",setup(Q){const t=S(),b=E(()=>t.userProfiles);function P(a){if(a){var r=[];for(const s of a){const o=v(s.game);o&&(s.gameData=o,r.push(s))}return r.sort((s,o)=>s.gameData.name.localeCompare(o.gameData.name)),r}}async function w(){const a=await q(t.userId);i("_user_account",a)}async function k(){const a=await z();i("_user_cards",a)}async function $(a){const s={versionKey:v(a).versions??null},o=await h(a,null,t.userId);if(!o?.versions){window.alert("Failed to export data!");return}const u=[...o.versions],y=u.length>1?u.pop():1,g=l=>{if(!l)return null;const{versions:D,stats:W,machine_judge_adjust:X,...A}=l;return A};t.continueLoad=u.length>0;for(const l of u){const D=await h(a,l,t.userId);s[l]=g(D)}t.continueLoad=!1,t.isLoading=!1,t.isSaving=!1,t.loadingPool=[],t.savingPool=[],s[y]=g(o),i(`_${a}_profiles`,s)}async function C(a){const r=await J(a,t.userId);i(`_${a}_attempts`,r);const s=await K(a,t.userId);i(`_${a}_records`,s)}return(a,r)=>(d(),m(O,null,{default:n(()=>[e(G,null,{default:n(()=>[e(B,{class:"mb-6","use-small":"","even-smaller":""}),e(I,{icon:L(N),title:"Export your Data",main:""},null,8,["icon"]),e(x,{color:"success",label:"Personal Data",class:"mb-4"}),c("div",R,[e(p,null,{default:n(()=>[e(_,{label:"General Data",help:"Basic user data for your account (email, Discord info, Tachi info, news, app settings)"},{default:n(()=>[e(f,{color:"success",label:"Export",onClick:w})]),_:1})]),_:1}),e(p,null,{default:n(()=>[e(_,{label:"Card Data",help:"Login cards (exported as internal and access code)"},{default:n(()=>[e(f,{color:"success",label:"Export",onClick:k})]),_:1})]),_:1})]),e(x,{color:"warning",label:"Profile Data",class:"mb-4"}),c("div",T,[(d(!0),V(U,null,F(P(b.value),s=>(d(),m(p,null,{default:n(()=>[c("h1",Y,j(s.gameData.name),1),r[0]||(r[0]=c("hr",{class:"mb-4"},null,-1)),c("div",H,[e(_,{label:"Account Data",help:"Data for the account (all played versions) for event tracking and settings. Does not include scores."},{default:n(()=>[e(f,{color:"success",label:"Export",onClick:o=>$(s.game)},null,8,["onClick"])]),_:2},1024),s.gameData.noScores?M("",!0):(d(),m(_,{key:0,label:"Score Data",help:"Data for music, scores, and records. May take a while to export."},{default:n(()=>[e(f,{color:"success",label:"Export",onClick:o=>C(s.game)},null,8,["onClick"])]),_:2},1024))])]),_:2,__:[0]},1024))),256))])]),_:1})]),_:1}))}};export{oa as default};
