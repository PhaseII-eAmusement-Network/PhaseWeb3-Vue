import{u as S,U as E,c as m,d,w as n,e,_ as G,i as c,I,J as B,g as L,ab as U,K as x,h as p,l as f,j as V,F as N,k as j,t as F,f as J,m as K,ac as M,a1 as z,a4 as v}from"./index-Dk9pwBdW.js";import{_}from"./FormField-Cvxm0MqE.js";import{e as i}from"./contentExport-f1OZccaW.js";import{A as h}from"./profile-DncFcBYb.js";import{g as O,A as R}from"./music-teFLScGK.js";const T={class:"grid grid-cols-1 sm:grid-cols-2 gap-6 mb-6"},q={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},H={class:"text-xl font-bold"},Q={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},oa={__name:"ExportView",setup(W){const t=S(),b=E(()=>t.userProfiles);function P(a){if(a){var r=[];for(const s of a){const o=v(s.game);o&&(s.gameData=o,r.push(s))}return r.sort((s,o)=>s.gameData.name.localeCompare(o.gameData.name)),r}}async function w(){const a=await M(t.userId);i("_user_account",a)}async function k(){const a=await z();i("_user_cards",a)}async function $(a){const s={versionKey:v(a).versions??null},o=await h(a,null,t.userId);if(!o?.versions){window.alert("Failed to export data!");return}const u=[...o.versions],y=u.length>1?u.pop():1,g=l=>{if(!l)return null;const{versions:D,stats:X,machine_judge_adjust:Y,...A}=l;return A};t.continueLoad=u.length>0;for(const l of u){const D=await h(a,l,t.userId);s[l]=g(D)}t.continueLoad=!1,t.isLoading=!1,t.isSaving=!1,t.loadingPool=[],t.savingPool=[],s[y]=g(o),i(`_${a}_profiles`,s)}async function C(a){const r=await O(a,t.userId);i(`_${a}_attempts`,r);const s=await R(a,t.userId);i(`_${a}_records`,s)}return(a,r)=>(d(),m(K,null,{default:n(()=>[e(G,null,{default:n(()=>[e(I,{class:"mb-6","use-small":"","even-smaller":""}),e(B,{icon:L(U),title:"Export your Data",main:""},null,8,["icon"]),e(x,{color:"success",label:"Personal Data",class:"mb-4"}),c("div",T,[e(p,null,{default:n(()=>[e(_,{label:"General Data",help:"Basic user data for your account (email, Discord info, Tachi info, news, app settings)"},{default:n(()=>[e(f,{color:"success",label:"Export",onClick:w})]),_:1})]),_:1}),e(p,null,{default:n(()=>[e(_,{label:"Card Data",help:"Login cards (exported as internal and access code)"},{default:n(()=>[e(f,{color:"success",label:"Export",onClick:k})]),_:1})]),_:1})]),e(x,{color:"warning",label:"Profile Data",class:"mb-4"}),c("div",q,[(d(!0),V(N,null,j(P(b.value),s=>(d(),m(p,null,{default:n(()=>[c("h1",H,F(s.gameData.name),1),r[0]||(r[0]=c("hr",{class:"mb-4"},null,-1)),c("div",Q,[e(_,{label:"Account Data",help:"Data for the account (all played versions) for event tracking and settings. Does not include scores."},{default:n(()=>[e(f,{color:"success",label:"Export",onClick:o=>$(s.game)},null,8,["onClick"])]),_:2},1024),s.gameData.noScores?J("",!0):(d(),m(_,{key:0,label:"Score Data",help:"Data for music, scores, and records. May take a while to export."},{default:n(()=>[e(f,{color:"success",label:"Export",onClick:o=>C(s.game)},null,8,["onClick"])]),_:2},1024))])]),_:2,__:[0]},1024))),256))])]),_:1})]),_:1}))}};export{oa as default};
