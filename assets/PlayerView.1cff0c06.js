import{u as C,ad as F,s as T,N as J,r as G,o as O,a as t,c as u,w as m,l as R,g as f,b as d,e as s,m as z,f as p,i as _,k as o,aq as E,P as M,ak as U,al as q,ac as X,j as H,F as P,aj as y,y as Y,Y as b,t as g,n as K,p as Q,q as W}from"./index.ef6c145a.js";import{_ as Z,g as S,a as ee}from"./ProfileCard.206878f8.js";import{_ as ae}from"./FormControl.3fead597.js";import{g as v}from"./danClass.233b0381.js";import"./userData.bcc92478.js";const le={class:"md:flex pb-6 md:justify-between md:items-center"},se={key:0,class:"mt-2 md:mt-0 md:w-1/3 md:text-right"},re=f("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Version ",-1),te={class:"bg-white dark:bg-slate-900/90 rounded-2xl pt-6 p-3"},ne={class:"w-full"},ie={class:"md:w-1/3 grid grid-cols-1 md:grid-cols-2 gap-3"},oe={class:"my-6 grid grid-cols-1 md:grid-cols-4 gap-6"},_e={__name:"PlayerView",setup(ue){const k=Q(),w=W(),N=C();var c=null,i=null,h=null;c=k.params.game,h=k.params.userId,i=F(c),i||w.push({name:"ErrorPage",params:{catchAll:"404"}});const n=T({currentVersion:null});J(()=>n.currentVersion,()=>{V()});const a=G(null);O(async()=>{V()}),i.versions||(n.currentVersion=1);async function V(){try{a.value=null;const e=await N.getUserProfile(c,n.currentVersion,h);a.value=B(e),e&&!n.currentVersion&&(n.currentVersion=e.versions[e.versions.length-1])}catch(e){console.error("Failed to fetch user profile data:",e)}}var $=[{label:"Register Date",type:String,span:"md:col-span-2",key:"first_play_timestamp"},{label:"Last Play",type:String,span:"md:col-span-2",key:"last_play_timestamp"},{label:"First Arcade",type:String,span:"md:col-span-2",key:"first_play_arcade"},{label:"Last Arcade",type:String,span:"md:col-span-2",key:"last_play_arcade"},{label:"Total Plays",type:Number,key:"total_plays"},{label:"EXP",type:Number,key:"exp"},{label:"SP Plays",type:Number,key:"single_plays"},{label:"DP Plays",type:Number,key:"double_plays"},{label:"SP DJPOINT",type:Number,key:"single_dj_points"},{label:"DP DJPOINT",type:Number,key:"double_dj_points"}];function x(){var e=null;return n.currentVersion?e=`/assets/games/${i.id}/card/${n.currentVersion}.png`:e=i.cardBG,e}function D(){return`
      background-image: url('${x()}');
      background-size: cover;
      background-repeat: no-repeat;
    `}function I(e,l){if(l){if(e.isSkill&&l.jubility)return S(l.jubility);if(e.isJubility&&l.records.skill)return ee(l.records.skill)}return""}function j(e){var l=[];for(const r of i.versions)e.includes(r.id)&&l.push(r);return l}function L(e,l){return e.isSkill?l.stats[e.key]/100:e.isJubility?l.stats[e.key]/10:l.stats[e.key]}function A(e,l){return l?e/10:e/100}function B(e){if(e.stats){if(e.stats.first_play_timestamp){const l=new Date(e.stats.first_play_timestamp*1e3);e.stats.first_play_timestamp=l.toLocaleString()}if(e.stats.last_play_timestamp){const l=new Date(e.stats.last_play_timestamp*1e3);e.stats.last_play_timestamp=l.toLocaleString()}e.dp&&e.dp.dan!==void 0&&(e.dp.dan=v(e.dp.dan).short)}return e}return(e,l)=>(t(),u(K,null,{default:m(()=>[a.value?(t(),u(R,{key:0},{default:m(()=>[f("div",le,[d(p,{icon:s(z),href:`/#/games/${s(c)}`,class:"w-full md:w-auto",color:"info",label:`${s(i).shortName?s(i).shortName:s(i).name} Home`},null,8,["icon","href","label"]),s(i).versions&&a.value?(t(),_("div",se,[re,d(ae,{modelValue:n.currentVersion,"onUpdate:modelValue":l[0]||(l[0]=r=>n.currentVersion=r),options:j(a.value.versions)},null,8,["modelValue","options"])])):o("",!0)]),d(M,{icon:s(E),title:"View Profile",main:""},null,8,["icon"]),n.currentVersion&&a.value?(t(),_("div",{key:0,style:X(D()),class:"rounded-2xl mb-6"},[f("div",te,[f("div",ne,[d(Z,{"use-small":"",game:s(c),version:n.currentVersion,profile:a.value},{default:m(()=>[f("div",ie,[d(p,{href:`/#/games/${s(c)}/scores/${a.value.userId}`,icon:s(U),class:"w-full md:w-auto",color:"info",label:"View Scores"},null,8,["href","icon"]),d(p,{href:`/#/games/${s(c)}/records/${a.value.userId}`,icon:s(q),class:"w-full md:w-auto",color:"info",label:"View Records"},null,8,["href","icon"])])]),_:1},8,["game","version","profile"])])])],4)):o("",!0),f("div",oe,[(t(!0),_(P,null,H(s($),r=>(t(),_(P,{key:r},[a.value.stats[r.key]?(t(),u(y,{key:0,class:Y(r.span),label:r.label,number:r.type==Number?L(r,a.value):null,"num-color":I(r)},{default:m(()=>[b(g(r.type==String?a.value.stats[r.key]:null)+" ",1)]),_:2},1032,["class","label","number","num-color"])):o("",!0)],64))),128)),a.value.skill?(t(),u(y,{key:0,label:"Skill Points",number:A(a.value.skill,!1),"num-color":s(S)(a.value.skill)},null,8,["number","num-color"])):o("",!0),a.value.profile_skill?(t(),u(y,{key:1,label:"Skill Level",number:a.value.profile_skill},null,8,["number"])):o("",!0),a.value.deller?(t(),u(y,{key:2,label:"Deller",number:a.value.deller},null,8,["number"])):o("",!0),a.value.sgrade?(t(),u(y,{key:3,label:"SP DAN"},{default:m(()=>[b(g(s(v)(a.value.sgrade).label),1)]),_:1})):o("",!0),a.value.dgrade?(t(),u(y,{key:4,label:"DP DAN"},{default:m(()=>[b(g(s(v)(a.value.dgrade).label),1)]),_:1})):o("",!0)])]),_:1})):o("",!0)]),_:1}))}};export{_e as default};
