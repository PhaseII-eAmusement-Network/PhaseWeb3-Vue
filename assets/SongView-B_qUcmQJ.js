import{Z as C,$ as A,s as g,d as c,a as o,a0 as I,e as x,p as t,a1 as N,aQ as T,l as D,m as B,aa as L,r as O,o as P,z,c as y,w as p,g as s,_ as G,b as f,f as w,n as M,t as b,F as V,h as Z,x as R,a4 as F,am as J,L as j,as as E,k as H}from"./index-C1tgo1DE.js";import{_ as U}from"./GeneralTable-BOTu8frw.js";import{_ as X}from"./FormControl-KZaKznhH.js";import{_ as q}from"./GameHeader-Bc_r1lQ_.js";import{b as Q}from"./music-BCBK5pdV.js";import{f as k}from"./scoreDataFilters-CKK1u78i.js";import{f as W,a as K,t as Y}from"./scores-DgwQZdre.js";import"./contentExport-dtJdRoOU.js";import"./PhGear.vue-DqFyHo1S.js";import"./PhHouse.vue-B8mbLwAc.js";const ee=["width","height","fill","transform"],te={key:0},ae=t("path",{d:"M211.45,52.51l-80-24A12,12,0,0,0,116,40V140.22A52,52,0,1,0,140,184V104.13l64.55,19.36A12,12,0,0,0,220,112V64A12,12,0,0,0,211.45,52.51ZM88,212a28,28,0,1,1,28-28A28,28,0,0,1,88,212ZM196,95.87l-56-16.8V56.13l56,16.8Z"},null,-1),se=[ae],re={key:1},le=t("path",{d:"M128,184a40,40,0,1,1-40-40A40,40,0,0,1,128,184Z",opacity:"0.2"},null,-1),oe=t("path",{d:"M210.3,56.34l-80-24A8,8,0,0,0,120,40V148.26A48,48,0,1,0,136,184V98.75l69.7,20.91A8,8,0,0,0,216,112V64A8,8,0,0,0,210.3,56.34ZM88,216a32,32,0,1,1,32-32A32,32,0,0,1,88,216ZM200,101.25l-64-19.2V50.75L200,70Z"},null,-1),ne=[le,oe],ie={key:2},ce=t("path",{d:"M210.3,56.34l-80-24A8,8,0,0,0,120,40V148.26A48,48,0,1,0,136,184V98.75l69.7,20.91A8,8,0,0,0,216,112V64A8,8,0,0,0,210.3,56.34Z"},null,-1),de=[ce],ue={key:3},me=t("path",{d:"M209.72,58.25l-80-24A6,6,0,0,0,122,40V153.05A46,46,0,1,0,134,184V96.06l72.28,21.69A6,6,0,0,0,214,112V64A6,6,0,0,0,209.72,58.25ZM88,218a34,34,0,1,1,34-34A34,34,0,0,1,88,218ZM202,103.94l-68-20.4V48.06l68,20.4Z"},null,-1),fe=[me],he={key:4},ge=t("path",{d:"M210.3,56.34l-80-24A8,8,0,0,0,120,40V148.26A48,48,0,1,0,136,184V98.75l69.7,20.91A8,8,0,0,0,216,112V64A8,8,0,0,0,210.3,56.34ZM88,216a32,32,0,1,1,32-32A32,32,0,0,1,88,216ZM200,101.25l-64-19.2V50.75L200,70Z"},null,-1),pe=[ge],_e={key:5},ve=t("path",{d:"M209.15,60.17l-80-24A4,4,0,0,0,124,40V158.75A44,44,0,1,0,132,184V93.38l74.85,22.45A4,4,0,0,0,212,112V64A4,4,0,0,0,209.15,60.17ZM88,220a36,36,0,1,1,36-36A36,36,0,0,1,88,220ZM204,106.62,132,85V45.38L204,67Z"},null,-1),Ae=[ve],ye={name:"PhMusicNote"},be=C({...ye,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(_){const d=_,u=A("weight","regular"),n=A("size","1em"),m=A("color","currentColor"),a=A("mirrored",!1),e=g(()=>d.weight??u),i=g(()=>d.size??n),$=g(()=>d.color??m),S=g(()=>d.mirrored!==void 0?d.mirrored?"scale(-1, 1)":void 0:a?"scale(-1, 1)":void 0);return(v,r)=>(o(),c("svg",N({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:i.value,height:i.value,fill:$.value,transform:S.value},v.$attrs),[I(v.$slots,"default"),e.value==="bold"?(o(),c("g",te,se)):e.value==="duotone"?(o(),c("g",re,ne)):e.value==="fill"?(o(),c("g",ie,de)):e.value==="light"?(o(),c("g",ue,fe)):e.value==="regular"?(o(),c("g",he,pe)):e.value==="thin"?(o(),c("g",_e,Ae)):x("",!0)],16,ee))}});function Ve(_,d){var u=JSON.parse(JSON.stringify(d));if(_?.id==T.IIDX)for(const a in u.charts){var n=u.charts[a];const e=(n.data.notecount??5730)*2;n.records=n?.records.map(i=>({...i,maxScore:e}));for(const i in n.records){var m=n.records[i];m=W(m.maxScore,m),n.records[i]=m}u.charts[a]=n}return u}const xe={class:"grid gap-4 bg-slate-900/90 card-content"},$e={class:"text-3xl font-bold"},Se={class:"text-2xl"},we={class:"text-xl font-light italic"},Me={class:"grid grid-cols-3 sm:flex gap-2"},Ze={class:"grid grid-cols-2 lg:grid-cols-5 gap-4 mb-6"},ke={class:"flex place-content-between mb-2"},Ce={class:"md:w-1/3 md:text-right"},Ie={class:"bg-white dark:bg-slate-900/95 rounded-2xl lg:flex lg:justify-between"},Ne={class:"w-full"},Je={__name:"SongView",setup(_){const d=D(),u=B();var n=d.params.game,m=d.params.songId;const a=L(n);var e=O({});a||u.push({name:"ErrorPage",params:{catchAll:"404"}}),P(async()=>{try{const r=await Q(n,m);e.value=Ve(a,r)}catch(r){console.error("Failed to fetch score data:",r)}});const i=z({currentChart:0}),$=g(()=>e.value.charts?e.value.charts.filter(r=>r.data?.difficulty!==0&&r.data?.difficulty!=null&&a.chartTable[r.chart]).map((r,h)=>{const l=`${a.chartTable[r.chart]} - ${k(r.data?.difficulty,a.difficultyDenom)}`;return{id:r.chart,label:l}}):[]),S=g(()=>{if(!e.value.charts||e.value.charts.length===0)return[];const r=JSON.parse(JSON.stringify(e.value.charts[i.currentChart]));return K(a,r?.records??[])}),v=r=>{const h=r.userId;u.push(`/games/${n}/profiles/${h}`)};return(r,h)=>(o(),y(H,null,{default:p(()=>[s(e)?(o(),y(G,{key:0},{default:p(()=>[f(q,{game:s(a)},null,8,["game"]),f(w,{icon:s(be),title:"Song Overview",main:""},null,8,["icon"]),f(M,{class:"mb-6","has-table":""},{default:p(()=>[t("div",xe,[t("div",null,[t("h1",$e,b(s(e).name),1),t("h2",Se,b(s(e).artist),1),t("h2",we,b(s(e).genre),1)]),t("div",Me,[(o(!0),c(V,null,Z(s(e).charts,l=>(o(),c(V,{key:l.db_id},[l.data?.difficulty!=0&&s(a).chartTable[l.chart]?(o(),y(R,{key:0,color:"info",label:`${s(a).chartTable[l.chart]} - ${s(k)(l.data?.difficulty,s(a).difficultyDenom)}`},null,8,["label"])):x("",!0)],64))),128))])])]),_:1}),f(w,{icon:s(F),title:"Top Records",main:""},null,8,["icon"]),t("div",Ze,[(o(!0),c(V,null,Z(s(e).charts,l=>(o(),c(V,{key:l.db_id},[l.data?.difficulty!=0&&s(a).chartTable[l.chart]?(o(),y(J,{key:0,label:`${s(a).chartTable[l.chart]}`,"small-content":""},{default:p(()=>[j(b(l.records[0]?`${l.records[0]?.username} - ${l.records[0].points?.toLocaleString()}`:"Unclaimed"),1)]),_:2},1032,["label"])):x("",!0)],64))),128))]),t("div",ke,[f(w,{icon:s(E),title:"All Scores",main:""},null,8,["icon"]),t("div",Ce,[h[1]||(h[1]=t("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Chart ",-1)),f(X,{modelValue:i.currentChart,"onUpdate:modelValue":h[0]||(h[0]=l=>i.currentChart=l),options:$.value},null,8,["modelValue","options"])])]),f(M,{"has-table":""},{default:p(()=>[t("div",Ie,[t("div",Ne,[f(U,{headers:s(Y)(s(a)),items:S.value,onRowClicked:v},null,8,["headers","items"])])])]),_:1})]),_:1})):x("",!0)]),_:1}))}};export{Je as default};
