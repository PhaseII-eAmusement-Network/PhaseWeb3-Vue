import{b as N,r as y,o as v,p as h,c as V,d as $,w as o,e as a,_ as k,h as r,i as n,P as f,g as p,aM as C,v as U,l as A,aN as B,n as R}from"./index-CHivKhhP.js";import{_ as I}from"./GeneralTable-Dm8yzA2j.js";import{_ as d}from"./FormField-vtioLqMT.js";import{_ as u}from"./FormControl-BLuW9GWW.js";import{j as L,k as M}from"./admin-YL_-tKB5.js";const P={class:"bg-white dark:bg-slate-900/95 rounded-2xl lg:flex lg:justify-between"},j={class:"w-full"},O={__name:"NewsView",setup(q){const w=N(),i=y([]),_=[{text:"Title",value:"title",width:150,sortable:!0},{text:"Body",value:"body",width:300},{text:"Image URL",value:"data.img",width:300}];v(async()=>{m()});async function m(){try{const t=await L();var l=[];for(var e of t){if(e.timestamp){const x=new Date(e.timestamp*1e3);e.timestamp=x.toLocaleString()}l.push(e)}i.value=l}catch(t){console.error("Failed to fetch news data:",t)}}const b=l=>{const e=l.id;w.push(`/news/${e}`)},c={title:null,body:null,data:{img:null}},s=h({...c});async function g(){try{const l=await M(s);i.value=l}catch(l){console.error("Failed to post news:",l)}Object.assign(s,c),m()}return(l,e)=>($(),V(R,null,{default:o(()=>[a(k,null,{default:o(()=>[a(r,{class:"mb-6 p-1"},{default:o(()=>e[4]||(e[4]=[n("h1",{class:"text-3xl"},"News Management",-1),n("p",{class:"text-sm text-gray-400"},"Enter an post to read it",-1)])),_:1}),a(f,{icon:p(C),title:"Create News",color:"text-emerald-600",main:""},null,8,["icon"]),a(r,{"is-form":"",class:"row-span-1 mb-6",onSubmit:e[3]||(e[3]=U(t=>g(),["prevent"]))},{default:o(()=>[a(d,{label:"Title",help:"News headline."},{default:o(()=>[a(u,{modelValue:s.title,"onUpdate:modelValue":e[0]||(e[0]=t=>s.title=t),required:""},null,8,["modelValue"])]),_:1}),a(d,{label:"Body",help:"News body."},{default:o(()=>[a(u,{modelValue:s.body,"onUpdate:modelValue":e[1]||(e[1]=t=>s.body=t),required:"",type:"textarea"},null,8,["modelValue"])]),_:1}),a(d,{label:"Image URL",help:"News image URL."},{default:o(()=>[a(u,{modelValue:s.data.img,"onUpdate:modelValue":e[2]||(e[2]=t=>s.data.img=t),required:""},null,8,["modelValue"])]),_:1}),n("div",null,[a(A,{type:"submit",color:"success",label:"Create",small:!1})])]),_:1}),a(f,{icon:p(B),title:"All News",color:"text-blue-400",main:""},null,8,["icon"]),a(r,{"has-table":"",class:"mb-6"},{default:o(()=>[n("div",P,[n("div",j,[a(I,{headers:_,items:i.value,onRowClicked:b},null,8,["items"]),e[5]||(e[5]=n("h1",{class:"mx-4 mt-1 mb-2 text-md lg:text-lg"}," Click row to open arcade ",-1))])])]),_:1})]),_:1})]),_:1}))}};export{O as default};
