import{a as y,r as N,o as v,s as V,c as h,e as $,w as o,f as a,_ as k,j as r,k as n,P as f,i as w,aL as C,y as U,n as A,aM as B,q as L}from"./index-DdOAy-ci.js";import{_ as R}from"./GeneralTable-ChZWVYGd.js";import{_ as d}from"./FormField-2BkvaPEM.js";import{_ as u}from"./FormControl-DpgwkAiB.js";import{j,k as q}from"./admin-C7ngnmxT.js";const I={class:"bg-white dark:bg-slate-900/95 rounded-2xl lg:flex lg:justify-between"},M={class:"w-full"},O={__name:"NewsView",setup(P){const p=y(),i=N([]),_=[{text:"Title",value:"title",width:150,sortable:!0},{text:"Body",value:"body",width:300},{text:"Image URL",value:"data.img",width:300}];v(async()=>{m()});async function m(){try{const t=await j();var s=[];for(var e of t){if(e.timestamp){const g=new Date(e.timestamp*1e3);e.timestamp=g.toLocaleString()}s.push(e)}i.value=s}catch(t){console.error("Failed to fetch news data:",t)}}const b=s=>{const e=s.id;p.push(`/news/${e}`)},c={title:null,body:null,data:{img:null}},l=V({...c});async function x(){try{const s=await q(l);i.value=s}catch(s){console.error("Failed to post news:",s)}Object.assign(l,c),m()}return(s,e)=>($(),h(L,null,{default:o(()=>[a(k,null,{default:o(()=>[a(r,{class:"mb-6 p-1"},{default:o(()=>e[4]||(e[4]=[n("h1",{class:"text-3xl"},"News Management",-1),n("p",{class:"text-sm text-gray-400"},"Enter an post to read it",-1)])),_:1}),a(f,{icon:w(C),title:"Create News",color:"text-emerald-600",main:""},null,8,["icon"]),a(r,{"is-form":"",class:"row-span-1 mb-6",onSubmit:e[3]||(e[3]=U(t=>x(),["prevent"]))},{default:o(()=>[a(d,{label:"Title",help:"News headline."},{default:o(()=>[a(u,{modelValue:l.title,"onUpdate:modelValue":e[0]||(e[0]=t=>l.title=t),required:""},null,8,["modelValue"])]),_:1}),a(d,{label:"Body",help:"News body."},{default:o(()=>[a(u,{modelValue:l.body,"onUpdate:modelValue":e[1]||(e[1]=t=>l.body=t),required:"",type:"textarea"},null,8,["modelValue"])]),_:1}),a(d,{label:"Image URL",help:"News image URL."},{default:o(()=>[a(u,{modelValue:l.data.img,"onUpdate:modelValue":e[2]||(e[2]=t=>l.data.img=t),required:""},null,8,["modelValue"])]),_:1}),n("div",null,[a(A,{type:"submit",color:"success",label:"Create",small:!1})])]),_:1}),a(f,{icon:w(B),title:"All News",color:"text-blue-400",main:""},null,8,["icon"]),a(r,{"has-table":"",class:"mb-6"},{default:o(()=>[n("div",I,[n("div",M,[a(R,{headers:_,items:i.value,onRowClicked:b},null,8,["items"]),e[5]||(e[5]=n("h1",{class:"mx-4 mt-1 mb-2 text-md lg:text-lg"}," Click row to open arcade ",-1))])])]),_:1})]),_:1})]),_:1}))}};export{O as default};
