import{u as Y,r as m,a as Z,b as ee,M as ae,o as le,c as _,d as i,w as r,e as a,_ as ne,j as g,f as A,F as k,i as o,g as d,P as N,aT as te,h as y,v as x,Q as V,az as R,l as u,C as L,aA as se,aB as oe,R as ie,k as D,aU as re,t as de,aV as ue,aC as ce,aW as me,an as fe,n as pe}from"./index-Cn7Qxkym.js";import{_ as ve}from"./ArcadeCard-BdfoLNlq.js";import{_ as w}from"./FormField-pnf59gPm.js";import{_ as F}from"./FormCheckRadio-Cj2oiu3q.js";import{_ as O}from"./FormControl-DUODGQBr.js";import{s as P,g as j}from"./values-CmNcmtTU.js";import{A as be,a as _e,b as ge}from"./arcade-B1UQGAAy.js";import{j as Ae,p as he,c as ye,q as we,r as ke,s as Ve}from"./admin-BCHp0qne.js";const $e={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Se={class:"mb-4 flex gap-2 items-stretch"},Ce={key:0,class:"space-x-2 mt-6 mb-4"},Ne={class:"mb-4"},xe={class:"mb-4"},Oe={class:"grid gap-4"},Pe={class:"flex justify-between items-center"},Ue={class:"m-[-5px] md:flex items-center gap-2"},Ie={class:"w-8 md:w-12"},Me={class:"text-lg lg:text-xl font-bold"},Be={class:"grid grid-cols-1 w-full gap-2 md:gap-6 md:flex md:place-content-stretch"},Ee={key:0,class:"space-x-2 mt-6"},Re={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-3 mb-6"},He={__name:"ArcadeView",setup(Le){const $=Y(),b=m(null),S=m(null),c=m(null),U=m(!0),C=m(null),s=m(null),h=m(null),I=m(null),J=Z(),q=ee(),f=parseInt(J.params.id);var M=[{id:"paseli_enabled",name:"PASELI Services",help:"Enable PASELI for this arcade.",type:"Boolean"},{id:"paseli_infinite",name:"Infinite PASELI",help:"Enable infinite PASELI for this arcade.",type:"Boolean"},{id:"maint",name:"Maintenance Mode",help:"Place this arcade under maintenance.",type:"Boolean"},{id:"hide_network",name:"Incognito Mode",help:"Hide the network and all ranking data.",type:"Boolean"}];async function p(){try{c.value={},b.value={},S.value={};const n=await be(f);c.value=n,s.value=JSON.parse(JSON.stringify(n));for(const e of M){const t=j(c.value.data,e.id);P(b.value,e.id,t),P(S.value,e.id,t)}U.value=!1}catch(n){console.error("Failed to fetch arcade data:",n)}}async function B(){if($.userAdmin)try{const n=await Ae(!0),e=[];for(const t of n)t.username!=null&&e.push({id:t.id,label:t.username});e.sort((t,v)=>t.label.localeCompare(v.label)),I.value=e}catch(n){console.error("Failed to fetch admin user data:",n)}}ae(()=>$.userAdmin,()=>{B()});async function z(){(await _e(f,b.value)).status!="error"&&await p()}le(()=>{p(),B()});function G(n,e="NA_"){var t=[...n].map(v=>v.charCodeAt(0)<128?v:e).join("");return t=t.replace(/[!"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~]/g,""),t=t.replace(/\s+/g,"_"),t}async function T(){try{const n=await ge(f),e=new Blob([n],{type:"application/ovpn"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=`gradius-${G(c.value.name)}-phaseii-config.ovpn`,document.body.appendChild(t),t.click(),URL.revokeObjectURL(t.href),document.body.removeChild(t)}catch(n){console.log("Failed to fetch arcade data:",n)}}async function H(){if(s.value.name){const n=await ye(s.value.name);n.unused!=null&&(C.value=n.unused)}}async function Q(){(await he(f,{name:s.value.name,description:s.value.description,beta:s.value.data.is_beta})).status!="error"&&await p()}async function W(){if(h.value==null)return;(await ke(f,h.value)).status!="error"&&(h.value=null,p())}async function K(n){if(!n)return;(await Ve(f,n)).status!="error"&&p()}async function X(){window.confirm(`Are you really?
This will remove all owners, machines, and arcade data.`)&&(await we(f)).status!="error"&&await q.push({name:"admin_arcades"})}return(n,e)=>(i(),_(pe,null,{default:r(()=>[a(ne,null,{default:r(()=>{var t,v;return[U.value?A("",!0):(i(),g(k,{key:0},[a(ve,{class:"mb-6",arcade:c.value},null,8,["arcade"]),d($).userAdmin?(i(),g(k,{key:0},[a(N,{icon:d(te),title:"Arcade Administration",main:""},null,8,["icon"]),o("div",$e,[a(y,{"is-form":"",class:"lg:mb-6",onSubmit:x(Q,["prevent"])},{default:r(()=>[a(V,{color:"info",label:"General Information",icon:d(R),class:"mb-2"},null,8,["icon"]),a(w,{label:"Arcade Name"},{default:r(()=>[a(O,{modelValue:s.value.name,"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.name=l),"input-value":s.value.name,name:"arcadeName",required:""},null,8,["modelValue","input-value"])]),_:1}),o("div",Se,[a(u,{color:"info",label:"Check Name",onClick:e[1]||(e[1]=l=>H())}),C.value==!0?(i(),_(L,{key:0,path:d(se),color:"text-green-400",size:"25"},null,8,["path"])):C.value==!1?(i(),_(L,{key:1,path:d(oe),color:"text-red-400",size:"25"},null,8,["path"])):A("",!0)]),a(w,{label:"Description"},{default:r(()=>[a(O,{modelValue:s.value.description,"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.description=l),name:"description",required:""},null,8,["modelValue"])]),_:1}),a(w,{label:"Beta Enabled"},{default:r(()=>[a(F,{modelValue:s.value.data.is_beta,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.data.is_beta=l),name:"beta","model-value":s.value.data.is_beta,"input-value":s.value.data.is_beta,type:"switch"},null,8,["modelValue","model-value","input-value"])]),_:1}),JSON.stringify(c.value)!==JSON.stringify(s.value)?(i(),g("div",Ce,[a(u,{color:"success",label:"Save",type:"submit"}),a(u,{color:"warning",label:"Revert",onClick:e[4]||(e[4]=l=>p())})])):A("",!0),o("div",null,[a(u,{color:"danger",label:"Delete Arcade",onClick:e[5]||(e[5]=l=>X())})])]),_:1}),a(y,{class:"mb-6"},{default:r(()=>[o("div",Ne,[a(V,{color:"info",label:"Add Manager",icon:d(R),class:"mb-2"},null,8,["icon"]),o("form",{class:"h-full",onSubmit:x(W,["prevent"])},[a(w,{label:"Username"},{default:r(()=>[a(O,{modelValue:h.value,"onUpdate:modelValue":e[6]||(e[6]=l=>h.value=l),name:"username",options:I.value,required:""},null,8,["modelValue","options"])]),_:1}),a(u,{color:"success",type:"submit",label:"Add Manager"})],32)]),a(ie),o("div",xe,[a(V,{color:"warning",label:"Managers",class:"mb-4"}),o("div",Oe,[(i(!0),g(k,null,D(c.value.owners,l=>(i(),_(y,{key:l,"color-prop":"bg-slate-800 dark:bg-slate-800"},{default:r(()=>[o("div",Pe,[o("div",Ue,[o("div",Ie,[a(re,{username:l.username,avatar:l.avatar},null,8,["username","avatar"])]),o("h1",Me,de(l.username),1)]),a(u,{color:"danger",label:"Remove",onClick:E=>K(l.id)},null,8,["onClick"])])]),_:2},1024))),128))])])]),_:1})])],64)):A("",!0),a(N,{icon:d(ue),title:"Arcade Management",main:""},null,8,["icon"]),a(y,{"is-form":"",class:"mb-6",onSubmit:x(z,["prevent"])},{default:r(()=>[a(V,{color:"info",label:"Settings",icon:d(ce),class:"mb-2"},null,8,["icon"]),o("div",Be,[(i(!0),g(k,null,D(d(M),l=>(i(),_(w,{key:l.id,label:l.name,help:l.help},{default:r(()=>[l.type=="Boolean"?(i(),_(F,{key:0,name:l.id,"model-value":!!(d(j)(b.value,l.id)??!1),"input-value":!0,type:"switch","onUpdate:modelValue":E=>d(P)(b.value,l.id,E??!1)},null,8,["name","model-value","onUpdate:modelValue"])):A("",!0)]),_:2},1032,["label","help"]))),128))]),JSON.stringify(b.value)!==JSON.stringify(S.value)?(i(),g("div",Ee,[a(u,{color:"success",label:"Save",type:"submit"}),a(u,{color:"danger",label:"Revert",onClick:e[7]||(e[7]=l=>p())})])):A("",!0)]),_:1}),a(y,{class:"w-full md:w-1/2 mb-6"},{default:r(()=>[e[9]||(e[9]=o("h1",{class:"text-lg md:text-xl"},"OpenVPN Configuration",-1)),e[10]||(e[10]=o("p",{class:"pb-1 dark:text-white/50"}," Use this to download your VPN config. ",-1)),a(u,{small:!1,color:"success",class:"my-2",label:"Export",onClick:e[8]||(e[8]=l=>T())})]),_:1}),a(N,{icon:d(me),title:"Arcade Overview",main:""},null,8,["icon"]),o("div",Re,[a(fe,{number:(v=(t=c.value)==null?void 0:t.machines)==null?void 0:v.length,label:"Active Machines"},null,8,["number"])])],64))]}),_:1})]),_:1}))}};export{He as default};
