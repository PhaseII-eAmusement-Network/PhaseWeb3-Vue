import{u as R,a as G,ag as E,r as S,s as L,o as U,B as N,c as l,e as $,w as g,g as t,p as j,k as u,f as d,j as n,i as b,n as p,bA as C,$ as T,F as v,l as F,_ as q,t as f,V as M,q as W}from"./index.3b748ec3.js";import{_ as z}from"./FormControl.a0e2c269.js";import{_ as H}from"./GameHeader.41279c5c.js";import{b as J}from"./music.c96d0bcf.js";import{A as K}from"./profile.71fa7a1f.js";import"./sources.b67a3d59.js";const O={class:"flex gap-2 mb-2 md:mb-0"},Q={key:0,class:"md:w-1/3 md:text-right"},X={class:"lg:flex w-full lg:place-content-between"},Y={class:"mb-4 lg:mb-0 space-y-1"},Z={class:"text-lg lg:text-xl"},ee={class:"text-md lg:text-lg"},se={class:"grid md:grid-cols-2 lg:flex gap-2 lg:justify-end lg:place-content-end"},re={key:0,class:"bg-gray-900 dark:bg-gray-700 p-4 rounded-lg"},ae={class:"text-md lg:text-lg"},de={__name:"PersonalRecords",setup(te){var k;const V=R(),y=G();var _=V.params.game;const e=E(_);var h=(k=V.params.userId)!=null?k:null,m=S([]);const o=S(null),i=L({currentVersion:null});e||y.push({name:"ErrorPage",params:{catchAll:"404"}}),h||y.push({name:"ErrorPage",params:{catchAll:"404"}}),e.versions||(i.currentVersion=1),U(async()=>{var s,r;try{const a=await J(_,h);m.value=a,B(),e.versions&&!i.currentVersion&&(i.currentVersion=(r=(s=x.value.at(-1))==null?void 0:s.id)!=null?r:null)}catch(a){console.error("Failed to fetch score data:",a)}});async function B(){try{o.value=null;const s=await K(_,null,h);o.value=s}catch(s){console.error("Failed to fetch user profile data:",s)}}const x=N(()=>{if(!e.versions)return[];const s=new Set(m.value.map(r=>r.version));return e.versions.filter(r=>s.has(r.id))}),D=N(()=>i.currentVersion?m.value.filter(s=>s.version===i.currentVersion):m.value);return(s,r)=>(l(),$(W,null,{default:g(()=>[t(m)?(l(),$(j,{key:0},{default:g(()=>[o.value?(l(),u(v,{key:0},[d(H,{game:t(e),profile:o.value},null,8,["game","profile"]),n("div",O,[d(b,{icon:s.mdiAccountDetails,href:`/#/games/${t(e).id}/profiles/${o.value.userId}`,outline:!1,color:"info",label:`${o.value.username}'s Profile`},null,8,["icon","href","label"]),d(b,{icon:s.mdiAccountDetails,href:`/#/games/${t(e).id}/scores/${o.value.userId}`,outline:!1,color:"info",label:`${o.value.username}'s Scores`},null,8,["icon","href","label"])]),d(T,{icon:t(C),title:`${o.value.username}'s ${t(e).shortName?t(e).shortName:t(e).name} Records`,main:""},{default:g(()=>[t(e).versions?(l(),u("div",Q,[r[1]||(r[1]=n("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Version ",-1)),d(z,{modelValue:i.currentVersion,"onUpdate:modelValue":r[0]||(r[0]=a=>i.currentVersion=a),options:x.value.slice().reverse()},null,8,["modelValue","options"])])):p("",!0)]),_:1},8,["icon","title"]),(l(!0),u(v,null,F(D.value,a=>(l(),$(q,{key:a.id,class:"mb-6"},{default:g(()=>[n("div",X,[n("div",Y,[n("h1",Z,f(a.name),1),n("h2",ee,f(a.artist),1),d(b,{label:"View Song",color:"info",href:`/#/games/${t(_)}/song/${a.id}`},null,8,["href"])]),n("div",se,[(l(!0),u(v,null,F(a.charts,c=>{var w,I,P,A;return l(),u(v,{key:c.db_id},[((w=c.data)==null?void 0:w.difficulty)!=0?(l(),u("div",re,[n("h2",ae,f(t(e).chartTable[c.chart])+" - "+f((I=c.data)==null?void 0:I.difficulty),1),M(" "+f(c.record?`${(P=c.record)==null?void 0:P.username} - ${(A=c.record.points)==null?void 0:A.toLocaleString()}`:"Unclaimed"),1)])):p("",!0)],64)}),128))])])]),_:2},1024))),128))],64)):p("",!0)]),_:1})):p("",!0)]),_:1}))}};export{de as default};
