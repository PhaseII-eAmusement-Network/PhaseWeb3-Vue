import{a as T,b as x,u as S,a4 as I,r as _,o as R,c as P,d as h,w as c,e as t,_ as A,j as B,f as C,F,i as y,g as r,l as g,G as E,Z as G,J as N,al as D,h as H,m as L}from"./index-DrhAnfmx.js";import{_ as V}from"./GeneralTable-CsIYovPk.js";import{_ as M}from"./GameHeader-1-4MA9IX.js";import{A as j}from"./profile-ClKq2qvw.js";import"./PhGear.vue-q7vz76Kz.js";import"./PhHouse.vue-CpIDFyGM.js";const J={class:"flex gap-2 mb-6"},Q={__name:"PersonalScores",setup(U){const u=T(),f=x(),k=S();var o=null,e=null,d=null;o=u.params.game,d=u.params.userId,e=I(o),e||f.push({name:"ErrorPage",params:{catchAll:"404"}});const l=_(null),i=_([]),p=[{text:"Timestamp",value:"timestamp",width:140},{text:"New PB",value:"newRecord",width:100},{text:"Song",value:"song.name",width:180},{text:"Artist",value:"song.artist",width:180},{text:"Chart",value:"song.chart",width:100},{text:"Grade",value:"data.rank",width:80},{text:"Score",value:"points",width:120}];if(e.scoreHeaders)for(var v of e.scoreHeaders)p.push(v);R(async()=>{try{const s=await k.getAttemptData(o,d);i.value=$(s)}catch(s){console.error("Failed to fetch score data:",s)}b()});async function b(){try{l.value=null;const s=await j(o,null,d);l.value=s}catch(s){console.error("Failed to fetch user profile data:",s)}}function $(s){var n=[];for(var a of s){if(a.newRecord?a.newRecord="âœ…":a.newRecord="",a.timestamp){const w=new Date(a.timestamp*1e3);a.timestamp=w.toLocaleString()}a.points!=null&&(a.points=a.points.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),a.data?.stats?.score!=null&&(a.exscore=a.points.toString(),a.points=a.data?.stats?.score.toString().replace(new RegExp("\\B(?<!\\.\\d*)(?=(\\d{3})+(?!\\d))","g"),",")),a.song?.chart!=null&&e.chartTable&&(a.song.chart=e.chartTable[a.song?.chart]),a.data?.halo!=null&&e.haloTable&&(a.data.halo=e.haloTable[a.data?.halo]),a.data?.medal!=null&&e.medalTable&&(a.data.medal=e.medalTable[a.data?.medal]),a.data?.clear_status!=null&&e.medalTable&&(a.data.medal=e.medalTable[a.data?.clear_status]),a.data?.rank!=null&&e.rankTable&&(a.data.rank=e.rankTable[a.data?.rank]),a.data?.result_rank!=null&&e.rankTable&&(a.data.rank=e.rankTable[a.data?.result_rank]),a.data?.grade!=null&&e.rankTable&&(a.data.rank=e.rankTable[a.data?.grade]),a.data?.skill_perc>0?a.data.skill_perc=`${a.data?.skill_perc/100}%`:a.data.skill_perc="0%",a.data?.skill_points&&(a.data.skill_points=a.data?.skill_points/10),a.data?.perc>0?a.data.perc=`${a.data?.perc/100}%`:a.data.perc="0%",a.data?.new_skill&&(a.data.new_skill=a.data?.new_skill/10),a.data?.music_rate&&(a.data.music_rate=a.data?.music_rate/10),a.data?.excellent?a.medal="EX FC":a.data?.fullcombo?a.medal="FC":a.data?.clear?a.medal="CLEARED":a.medal="FAILED",n.push(a)}return n}const m=s=>{const n=s.song.id;f.push(`/games/${o}/song/${n}`)};return(s,n)=>(h(),P(L,null,{default:c(()=>[t(A,null,{default:c(()=>[l.value?(h(),B(F,{key:0},[t(M,{game:r(e),profile:l.value},null,8,["game","profile"]),y("div",J,[t(g,{icon:r(E),href:`/#/games/${r(e).id}/profiles/${l.value.userId}`,outline:!1,color:"info",label:`${l.value.username}'s Profile`},null,8,["icon","href","label"]),t(g,{icon:r(G),href:`/#/games/${r(e).id}/records/${l.value.userId}`,outline:!1,color:"info",label:`${l.value.username}'s Records`},null,8,["icon","href","label"])]),t(N,{icon:r(D),title:`${l.value.username}'s ${r(e).shortName?r(e).shortName:r(e).name} Scores`,main:""},null,8,["icon","title"]),t(H,{"has-table":""},{default:c(()=>[t(V,{headers:p,items:i.value,onRowClicked:m},null,8,["items"])]),_:1})],64)):C("",!0)]),_:1})]),_:1}))}};export{Q as default};
