import{R as J,S as P,U as f,j as p,d as u,V as W,f as h,i as r,W as O,r as S,a as G,o as K,c as y,w as d,e as l,_ as Q,F as Y,J as X,g as s,ag as H,h as L,K as M,l as U,m as ee}from"./index-DwYnfYUr.js";import{F}from"./PhCashRegister.vue-_VXpJ-jE.js";import{I as ae}from"./PhCreditCard.vue-CREb6-3k.js";import{I as R}from"./PhPlusCircle.vue-Dw3hO4Pa.js";import{_ as j}from"./GeneralTable-yVUI-94y.js";import{_ as le}from"./ArcadeCard-CY11Bi1w.js";import{_ as k}from"./FormControl-BemwZxz1.js";import{_ as C}from"./FormField-CkVagh-a.js";import{A as te,e as ne,f as re}from"./arcade-Ck7wvZve.js";import"./contentExport-C9gRftu5.js";import"./PhHouse.vue-CsFwf3sR.js";const oe=["width","height","fill","transform"],ue={key:0},se=r("path",{d:"M209.29,55.6l-56,68.4H176a12,12,0,0,1,0,24H140v16h36a12,12,0,0,1,0,24H140v28a12,12,0,0,1-24,0V188H80a12,12,0,0,1,0-24h36V148H80a12,12,0,0,1,0-24h22.68l-56-68.4A12,12,0,1,1,65.29,40.4L128,117.05,190.71,40.4a12,12,0,1,1,18.58,15.2Z"},null,-1),ce=[se],ie={key:1},de=r("path",{d:"M200,48l-72,88L56,48Z",opacity:"0.2"},null,-1),me=r("path",{d:"M206.19,53.07,144.88,128H176a8,8,0,0,1,0,16H136v16h40a8,8,0,0,1,0,16H136v40a8,8,0,0,1-16,0V176H80a8,8,0,0,1,0-16h40V144H80a8,8,0,0,1,0-16h31.12L49.81,53.07A8,8,0,0,1,62.19,42.93L128,123.37l65.81-80.44a8,8,0,1,1,12.38,10.14Z"},null,-1),ve=[de,me],pe={key:2},fe=r("path",{d:"M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm54.4,52.8L144,128h16a8,8,0,0,1,0,16H136v16h24a8,8,0,0,1,0,16H136v16a8,8,0,0,1-16,0V176H96a8,8,0,0,1,0-16h24V144H96a8,8,0,0,1,0-16h16L73.6,76.8a8,8,0,1,1,12.8-9.6L128,122.67,169.6,67.2a8,8,0,0,1,12.8,9.6Z"},null,-1),he=[fe],ge={key:3},be=r("path",{d:"M204.64,51.8l-64,78.2H176a6,6,0,0,1,0,12H134v20h42a6,6,0,0,1,0,12H134v42a6,6,0,0,1-12,0V174H80a6,6,0,0,1,0-12h42V142H80a6,6,0,0,1,0-12h35.34l-64-78.2a6,6,0,1,1,9.28-7.6L128,126.53,195.36,44.2a6,6,0,0,1,9.28,7.6Z"},null,-1),_e=[be],ye={key:4},Ie=r("path",{d:"M206.19,53.07,144.88,128H176a8,8,0,0,1,0,16H136v16h40a8,8,0,0,1,0,16H136v40a8,8,0,0,1-16,0V176H80a8,8,0,0,1,0-16h40V144H80a8,8,0,0,1,0-16h31.12L49.81,53.07A8,8,0,0,1,62.19,42.93L128,123.37l65.81-80.44a8,8,0,1,1,12.38,10.14Z"},null,-1),He=[Ie],we={key:5},Ve=r("path",{d:"M203.1,50.53,136.44,132H176a4,4,0,0,1,0,8H132v24h44a4,4,0,0,1,0,8H132v44a4,4,0,0,1-8,0V172H80a4,4,0,0,1,0-8h44V140H80a4,4,0,0,1,0-8h39.56L52.9,50.53a4,4,0,0,1,6.2-5.06L128,129.68l68.9-84.21a4,4,0,1,1,6.2,5.06Z"},null,-1),Ae=[Ve],xe={name:"PhCurrencyJpy"},v=J({...xe,props:{weight:{type:String},size:{type:[String,Number]},color:{type:String},mirrored:{type:Boolean}},setup(E){const c=E,o=P("weight","regular"),g=P("size","1em"),t=P("color","currentColor"),$=P("mirrored",!1),i=f(()=>c.weight??o),w=f(()=>c.size??g),V=f(()=>c.color??t),B=f(()=>c.mirrored!==void 0?c.mirrored?"scale(-1, 1)":void 0:$?"scale(-1, 1)":void 0);return(A,D)=>(u(),p("svg",O({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256",width:w.value,height:w.value,fill:V.value,transform:B.value},A.$attrs),[W(A.$slots,"default"),i.value==="bold"?(u(),p("g",ue,ce)):i.value==="duotone"?(u(),p("g",ie,ve)):i.value==="fill"?(u(),p("g",pe,he)):i.value==="light"?(u(),p("g",ge,_e)):i.value==="regular"?(u(),p("g",ye,He)):i.value==="thin"?(u(),p("g",we,Ae)):h("",!0)],16,oe))}}),Pe={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-3 mb-6"},Se={class:"grid md:grid-cols-2 gap-6 mb-6"},Le={class:"grid gap-6"},ke={class:"bg-white dark:bg-slate-900/95 rounded-2xl lg:flex lg:justify-between"},Ce={class:"w-full"},$e={class:"bg-white dark:bg-slate-900/95 rounded-2xl lg:flex lg:justify-between"},Be={class:"w-full"},qe={__name:"PaseliView",setup(E){const c=S({}),o=S({}),g=S(!0),t=S({}),$=G(),i=parseInt($.params.id);async function w(){try{c.value=null;const a=await te(i);c.value=a}catch(a){console.error("Failed to fetch arcade data:",a)}}async function V(){try{o.value=null;const a=await ne(i);o.value=a,o.value.transactions?.reverse(),g.value=!1}catch(a){console.error("Failed to fetch arcade PASELI:",a)}}K(()=>{g.value=!0,w(),V()});const B=[{text:"Timestamp",value:"timestamp",width:200},{text:"Amount",value:"data.delta",width:200},{text:"Remaining Balance",value:"data.balance",width:200},{text:"Reason",value:"data.reason",width:200}],A=[{text:"Player",value:"username"},{text:"Balance",value:"balance"}];function D(a){var e=[];for(var n of JSON.parse(JSON.stringify(a))){if(n.timestamp){const b=new Date(n.timestamp*1e3);n.timestamp=b.toLocaleString()}e.push(n)}return e}function q(a){var e=a.target.value;e=e.replace(/[^A-Za-z0-9]/g,""),e=e.toUpperCase().replace(/(.{4})/g,"$1-").replace(/-$/,""),t.value.cardId=e}function N(a){var e=a.target.value;e=e.replace(/[^0-9]/g,""),t.value.credit=e}const T=f(()=>o.value?.balances?o.value.balances.reduce((a,e)=>a+(e.balance||0),0):0),I=f(()=>{if(!o.value?.balances?.length)return{};const a=o.value.balances.filter(m=>m.balance>0),e=a.reduce((m,_)=>m+_.balance,0),n=e/a.length,b=a.reduce((m,_)=>_.balance>m.balance?_:m,a[0]);return{total:e,avg:n,count:a.length,topPlayer:b.username||"(anonymous)",topBalance:b.balance}}),x=f(()=>{if(!o.value?.transactions)return{totalDelta:0,count:0,avgDelta:0,last:null};const a=o.value.transactions,e=a.reduce((m,_)=>m+(_.data?.delta||0),0),n=e/(a.length||1),b=a[a.length-1]||null;return{totalDelta:e,count:a.length,avgDelta:n,last:b}}),z=f(()=>{var a=[];for(const e of o.value.balances)a.push({id:e.userId,label:e.username==""?"Unclaimed Account":e.username});return a});async function Z(){!t.value.cardId&&!t.value.userId||t.value.credit&&(g.value=!0,await re(i,t.value.userId,t.value.cardId,t.value.credit),t.value.userId=null,t.value.cardId=null,t.value.credit=null,await V())}return(a,e)=>(u(),y(ee,null,{default:d(()=>[l(Q,null,{default:d(()=>[!g.value&&c.value?(u(),p(Y,{key:0},[l(le,{class:"mb-6",arcade:c.value,"use-small":!0},null,8,["arcade"]),l(X,{icon:s(v),title:"PASELI Stats",main:""},null,8,["icon"]),r("div",Pe,[T.value?(u(),y(H,{key:0,number:T.value,label:"Total PASELI Net Worth",icon:s(v)},null,8,["number","icon"])):h("",!0),x.value.count?(u(),y(H,{key:1,number:x.value.count,label:"Recent Transactions",icon:s(F)},null,8,["number","icon"])):h("",!0),x.value.totalDelta?(u(),y(H,{key:2,number:x.value.totalDelta,label:"Recent Net Flow",icon:s(v)},null,8,["number","icon"])):h("",!0),I.value.avg?(u(),y(H,{key:3,number:I.value.avg,label:"Average Player Balance",icon:s(v)},null,8,["number","icon"])):h("",!0),I.value.topBalance?(u(),y(H,{key:4,number:I.value.topBalance,label:`Top Player: ${I.value.topPlayer}`,icon:s(v)},null,8,["number","label","icon"])):h("",!0)]),l(X,{icon:s(v),title:"Player PASELI Balances",main:""},null,8,["icon"]),r("div",Se,[r("div",Le,[l(L,{"is-form":""},{default:d(()=>[l(M,{label:"Update balance",color:"success",class:"mb-4",icon:s(R)},null,8,["icon"]),l(C,{label:"Card ID",help:"The ACCESS CODE provided by the game."},{default:d(()=>[l(k,{modelValue:t.value.cardId,"onUpdate:modelValue":e[0]||(e[0]=n=>t.value.cardId=n),icon:s(ae),name:"cardId",type:"card",placeholder:"XXXX-XXXX-XXXX-XXXX",minlength:19,maxlength:19,required:"",onInput:q},null,8,["modelValue","icon"])]),_:1}),l(C,{label:"Credit Amount"},{default:d(()=>[l(k,{modelValue:t.value.credit,"onUpdate:modelValue":e[1]||(e[1]=n=>t.value.credit=n),icon:s(v),name:"credit",required:"",maxlength:7,inputmode:"numeric",onInput:N},null,8,["modelValue","icon"])]),_:1}),l(U,{label:"Credit Account",color:"success",onClick:Z})]),_:1}),l(L,{"is-form":""},{default:d(()=>[l(M,{label:"Credit existing account",color:"info",class:"mb-4",icon:s(R)},null,8,["icon"]),l(C,{label:"Select Player"},{default:d(()=>[l(k,{modelValue:t.value.userId,"onUpdate:modelValue":e[2]||(e[2]=n=>t.value.userId=n),options:z.value,required:""},null,8,["modelValue","options"])]),_:1}),l(C,{label:"Credit Amount"},{default:d(()=>[l(k,{modelValue:t.value.credit,"onUpdate:modelValue":e[3]||(e[3]=n=>t.value.credit=n),icon:s(v),name:"credit",required:"",maxlength:7,inputmode:"numeric",onInput:N},null,8,["modelValue","icon"])]),_:1}),l(U,{label:"Credit Selected Player",color:"info",onClick:Z})]),_:1})]),r("div",null,[l(L,{"has-table":""},{default:d(()=>[r("div",ke,[r("div",Ce,[l(j,{headers:A,items:o.value.balances},null,8,["items"])])])]),_:1})])]),l(X,{icon:s(F),title:"PASELI Transaction History",main:""},null,8,["icon"]),l(L,{"has-table":""},{default:d(()=>[r("div",$e,[r("div",Be,[l(j,{headers:B,items:D(o.value.transactions)},null,8,["items"])])])]),_:1})],64)):h("",!0)]),_:1})]),_:1}))}};export{qe as default};
