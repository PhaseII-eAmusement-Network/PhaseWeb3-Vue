import{B as G,E as D,c,k as p,j as n,f as i,a4 as R,t as j,G as C,n as _,u as F,a as L,s as N,M as E,a3 as M,r as $,o as T,e as g,w as y,g as s,i as P,aE as q,aF as H,aB as z,W as O,aG as U,_ as W,p as X,q as J}from"./index.6f72409c.js";import{_ as K}from"./FormControl.0af86766.js";import{_ as Q}from"./ProfileCard.211ef9d7.js";import{_ as Y}from"./GeneralTable.aff14db4.js";import{a as Z,A as ee}from"./profile.029d9e92.js";import{g as te,a as se}from"./sources.0e8cabdf.js";import{d as ae}from"./userData.bcc92478.js";import{g as b}from"./danClass.233b0381.js";const oe={class:"pt-6 mb-6 flex items-center justify-between"},re={class:"flex items-center justify-start space-x-2"},le={class:"text-2xl md:text-3xl leading-tight"},ne={__name:"GameTitleLine",props:{path:{type:String,default:null},title:{type:String,required:!0}},setup(h){const v=G(()=>D().default);return(f,r)=>(c(),p("section",oe,[n("div",re,[i(R,{path:h.path,class:"w-12 h-12 p-1 drop-shadow-md"},null,8,["path"]),n("h1",le,j(h.title),1)]),v.value?C(f.$slots,"default",{key:0}):_("",!0)]))}},ie=["src"],ce={class:"bg-white dark:bg-slate-900/90 rounded-2xl pt-6 p-3 card-content"},de={class:"w-full"},ue={class:"md:flex md:px-5 md:space-x-10 md:justify-between md:items-center"},fe={key:0,class:"md:w-1/3 md:text-right"},me={key:0,class:"w-full pt-6 pb-10"},pe={key:1,class:"md:w-1/2 grid grid-cols-1 md:grid-cols-2 gap-3"},_e={class:"bg-white dark:bg-slate-900/95 rounded-2xl lg:flex lg:justify-between"},he={class:"w-full"},ke={__name:"GameView",setup(h){const v=F(),f=L();var r=null,a=null;const l=N({currentVersion:null});E(()=>l.currentVersion,()=>{w()}),r=v.params.id,a=M(r),a==null&&f.push({name:"ErrorPage",params:{catchAll:"404"}});const d=$(null),x=$([]);T(async()=>{try{const t=await Z(r);x.value=S(t)}catch(t){console.error("Failed to fetch profile data:",t)}w()}),a.versions||(l.currentVersion=1);async function w(){try{d.value=null;const t=await ee(r,l.currentVersion);d.value=t,t&&!l.currentVersion&&(l.currentVersion=t.versions[t.versions.length-1])}catch(t){console.error("Failed to fetch user profile data:",t)}}const u=[];if(u.push({text:"Player",value:"username",sortable:!0,width:120}),a.noRivals||u.push({text:"Rival ID",value:"extid",width:100}),u.push({text:"Last Play",value:"stats.last_play_timestamp",width:150},{text:"Last Arcade",value:"stats.last_play_arcade",width:150},{text:"Plays",value:"stats.total_plays",sortable:!0,width:50}),a.playerHeaders)for(var k of a.playerHeaders)u.push(k);function S(t){var o=[];for(var e of t){if(e.extid&&(e.extid=ae(e.extid)),e.stats){if(e.stats.last_play_timestamp){const m=new Date(e.stats.last_play_timestamp*1e3);e.stats.last_play_timestamp=m.toLocaleString()}e.sgrade&&(e.sgrade=b(e.sgrade).short),e.dgrade&&(e.dgrade=b(e.dgrade).short)}o.push(e)}return o.sort((m,V)=>{const B=m.stats&&m.stats.total_plays||0;return(V.stats&&V.stats.total_plays||0)-B}),o}function I(t){var o=[];for(const e of a.versions)t.includes(e.id)&&o.push(e);return o}const A=t=>{const o=t.userId;f.push(`/games/${r}/profiles/${o}`)};return(t,o)=>(c(),g(J,null,{default:y(()=>[i(X,null,{default:y(()=>[n("div",{style:z(s(se)(s(a),l.currentVersion)),class:"rounded-2xl mb-6 card-container"},[n("video",{autoplay:"",muted:"",loop:"",playsinline:"",src:s(te)(s(a),l.currentVersion),class:"background-video"},null,8,ie),n("div",ce,[n("div",de,[n("div",ue,[i(ne,{path:s(a).icon,title:s(a).name},null,8,["path","title"]),s(a).versions&&d.value?(c(),p("div",fe,[o[1]||(o[1]=n("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Version ",-1)),i(K,{modelValue:l.currentVersion,"onUpdate:modelValue":o[0]||(o[0]=e=>l.currentVersion=e),options:I(d.value.versions)},null,8,["modelValue","options"])])):_("",!0)])]),d.value?(c(),p("div",me,[i(Q,{game:s(r),version:l.currentVersion,profile:d.value},null,8,["game","version","profile"])])):(c(),p("div",pe,[s(a).noScores?_("",!0):(c(),g(P,{key:0,href:`/#/games/${s(r)}/scores`,icon:s(q),outline:!1,color:"info",label:"Network Scores"},null,8,["href","icon"])),s(a).noRecords?_("",!0):(c(),g(P,{key:1,href:`/#/games/${s(r)}/records`,icon:s(H),outline:!1,color:"info",label:"Network Records"},null,8,["href","icon"]))]))])],4),i(O,{icon:s(U),title:"All Players",main:""},null,8,["icon"]),i(W,{"has-table":""},{default:y(()=>[n("div",_e,[n("div",he,[i(Y,{headers:u,items:x.value,path:`/#/${s(r)}/profiles/`,onRowClicked:A},null,8,["items","path"])])])]),_:1})]),_:1})]),_:1}))}};export{ke as default};
