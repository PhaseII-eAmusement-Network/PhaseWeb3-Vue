import{u as E,r as O,o as z,a as t,i as f,j as C,c as i,w as d,g as u,b as m,R as P,k as n,t as b,_ as F,F as k,ad as ee,s as le,N as ae,l as te,e as r,m as se,f as D,aq as re,P as j,ak as ne,al as ie,ac as oe,aj as _,y as ue,Y as g,ar as ce,as as de,n as me,p as _e,q as be}from"./index.8873e6d2.js";import{_ as ye,g as U,a as S}from"./ProfileCard.e3282790.js";import{_ as fe}from"./FormControl.a72ac6c2.js";import{g as N}from"./danClass.233b0381.js";import"./userData.bcc92478.js";const pe={class:"flex space-x-2 mb-2"},ve={class:"flex justify-between items-center"},ge={class:"grid"},ke={class:"text-lg font-bold"},he={class:"text-md"},we={class:"text-lg"},Ve={class:"text-lg"},q={__name:"JubilityTable",props:{jubilityData:{type:Array,required:!0},version:{type:Number,required:!0}},setup(J){const h=J,x=E(),w=O(null),y={0:{label:"Basic",color:"info"},1:{label:"Advanced",color:"warning"},2:{label:"Extreme",color:"danger"}};return z(async()=>{try{w.value=null;const c=h.jubilityData.map(e=>e.song_id),V=await x.getMusicData("jubeat",h.version,c),s=h.jubilityData.map(e=>{const v=V.find($=>$.id===e.song_id&&$.chart===e.chart);return{...e,...v?{songData:v}:{}}});s.sort((e,v)=>v.rate-e.rate),w.value=s}catch(c){console.error("Failed to fetch music data:",c)}}),(c,V)=>w.value?(t(!0),f(k,{key:0},C(w.value,s=>(t(),i(F,{key:s.id,"color-prop":"bg-slate-800 dark:bg-slate-800",class:"my-3 p-5","has-table":""},{default:d(()=>[u("div",pe,[m(P,{label:y[s.chart].label,color:y[s.chart].color},null,8,["label","color"]),s.hard?(t(),i(P,{key:0,label:"Hard Mode",color:"danger"})):n("",!0)]),u("div",ve,[u("div",ge,[u("h1",ke,b(s.songData.name),1),u("h2",he,b(s.songData.artist),1)]),u("div",null,[u("h2",we,"Jubility: "+b(s.value/10),1),u("h2",Ve,"Rate: "+b(s.rate/10),1)])])]),_:2},1024))),128)):n("",!0)}},$e={class:"md:flex pb-6 md:justify-between md:items-center"},Se={key:0,class:"mt-2 md:mt-0 md:w-1/3 md:text-right"},Pe=u("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Version ",-1),xe={class:"bg-white dark:bg-slate-900/90 rounded-2xl pt-6 p-3"},De={class:"w-full"},je={class:"md:w-1/3 grid grid-cols-1 md:grid-cols-2 gap-3"},Ne={class:"my-6 grid grid-cols-1 md:grid-cols-4 gap-6"},Ce={class:"my-6 grid grid-cols-2 md:grid-cols-5 xl:grid-cols-6 gap-6"},Fe={class:"my-6 grid grid-cols-1 md:grid-cols-2 gap-6"},Te={__name:"PlayerView",setup(J){const h=_e(),x=be(),w=E();var y=null,c=null,V=null;y=h.params.game,V=h.params.userId,c=ee(y),c||x.push({name:"ErrorPage",params:{catchAll:"404"}});const s=le({currentVersion:null});ae(()=>s.currentVersion,()=>{v()});const e=O(null);z(async()=>{v()}),c.versions||(s.currentVersion=1);async function v(){try{e.value=null;const l=await w.getUserProfile(y,s.currentVersion,V);e.value=W(l),l&&!s.currentVersion&&(s.currentVersion=l.versions[l.versions.length-1])}catch(l){console.error("Failed to fetch user profile data:",l)}}var $=[{label:"Register Date",type:String,span:"md:col-span-2",key:"first_play_timestamp"},{label:"Last Play",type:String,span:"md:col-span-2",key:"last_play_timestamp"},{label:"First Arcade",type:String,span:"md:col-span-2",key:"first_play_arcade"},{label:"Last Arcade",type:String,span:"md:col-span-2",key:"last_play_arcade"},{label:"Total Plays",type:Number,key:"total_plays"},{label:"EXP",type:Number,key:"exp"},{label:"SP Plays",type:Number,key:"single_plays"},{label:"DP Plays",type:Number,key:"double_plays"},{label:"SP DJPOINT",type:Number,key:"single_dj_points"},{label:"DP DJPOINT",type:Number,key:"double_dj_points"}];function H(){var l=null;return s.currentVersion?l=`/assets/games/${c.id}/card/${s.currentVersion}.webp`:l=c.cardBG,l}function X(){return`
      background-image: url('${H()}');
      background-size: cover;
      background-repeat: no-repeat;
    `}function Y(l,a){if(a){if(l.isSkill&&a.jubility)return U(a.jubility);if(l.isJubility&&a.records.skill)return S(a.records.skill)}return""}function K(l){var a=[];for(const p of c.versions)l.includes(p.id)&&a.push(p);return a}function Q(l,a){return l.isSkill?a.stats[l.key]/100:l.isJubility?a.stats[l.key]/10:a.stats[l.key]}function W(l){if(l.stats){if(l.stats.first_play_timestamp){const a=new Date(l.stats.first_play_timestamp*1e3);l.stats.first_play_timestamp=a.toLocaleString()}if(l.stats.last_play_timestamp){const a=new Date(l.stats.last_play_timestamp*1e3);l.stats.last_play_timestamp=a.toLocaleString()}l.dp&&l.dp.dan!==void 0&&(l.dp.dan=N(l.dp.dan).short)}return l}function Z(l){var p;const a=(p=l.stats)==null?void 0:p.count;return a?[a.mfc!=null?{label:"MFCs",value:a.mfc}:0,a.pfc!=null?{label:"PFCs",value:a.pfc}:0,a.fc!=null?{label:"GFCs",value:a.fc}:0,a.gfc!=null?{label:"FCs",value:a.gfc}:0,a.life4!=null?{label:"Life-4 Clears",value:a.life4}:0]:[]}return(l,a)=>(t(),i(me,null,{default:d(()=>[e.value?(t(),i(te,{key:0},{default:d(()=>{var p,A,B,I,L,T,R,M,G;return[u("div",$e,[m(D,{icon:r(se),href:`/#/games/${r(y)}`,class:"w-full md:w-auto",color:"info",label:`${r(c).shortName?r(c).shortName:r(c).name} Home`},null,8,["icon","href","label"]),r(c).versions&&e.value?(t(),f("div",Se,[Pe,m(fe,{modelValue:s.currentVersion,"onUpdate:modelValue":a[0]||(a[0]=o=>s.currentVersion=o),options:K(e.value.versions)},null,8,["modelValue","options"])])):n("",!0)]),m(j,{icon:r(re),title:"View Profile",main:""},null,8,["icon"]),s.currentVersion&&e.value?(t(),f("div",{key:0,style:oe(X()),class:"rounded-2xl mb-6"},[u("div",xe,[u("div",De,[m(ye,{"use-small":"",game:r(y),version:s.currentVersion,profile:e.value},{default:d(()=>[u("div",je,[m(D,{href:`/#/games/${r(y)}/scores/${e.value.userId}`,icon:r(ne),class:"w-full md:w-auto",color:"info",label:"View Scores"},null,8,["href","icon"]),m(D,{href:`/#/games/${r(y)}/records/${e.value.userId}`,icon:r(ie),class:"w-full md:w-auto",color:"info",label:"View Records"},null,8,["href","icon"])])]),_:1},8,["game","version","profile"])])])],4)):n("",!0),u("div",Ne,[(t(!0),f(k,null,C(r($),o=>(t(),f(k,{key:o},[e.value.stats[o.key]?(t(),i(_,{key:0,class:ue(o.span),label:o.label,number:o.type==Number?Q(o,e.value):null,"num-color":Y(o)},{default:d(()=>[g(b(o.type==String?e.value.stats[o.key]:null)+" ",1)]),_:2},1032,["class","label","number","num-color"])):n("",!0)],64))),128)),(A=(p=e.value.stats)==null?void 0:p.count)!=null&&A.records?(t(),i(_,{key:0,label:"Records",number:(I=(B=e.value.stats)==null?void 0:B.count)==null?void 0:I.records},null,8,["number"])):n("",!0),(T=(L=e.value.stats)==null?void 0:L.count)!=null&&T.attempts?(t(),i(_,{key:1,label:"Attempts",number:(M=(R=e.value.stats)==null?void 0:R.count)==null?void 0:M.attempts},null,8,["number"])):n("",!0),e.value.skill?(t(),i(_,{key:2,label:"Skill Points",number:e.value.skill/100,"num-color":r(U)(e.value.skill)},null,8,["number","num-color"])):n("",!0),e.value.profile_skill?(t(),i(_,{key:3,label:"Skill Level"},{default:d(()=>[g(b(e.value.profile_skill/100),1)]),_:1})):n("",!0),e.value.jubility?(t(),i(_,{key:4,label:"Jubility","num-color":r(S)(e.value.jubility)},{default:d(()=>[g(b(e.value.jubility/10),1)]),_:1},8,["num-color"])):n("",!0),e.value.pick_up_jubility?(t(),i(_,{key:5,label:"Pick-Up Jubility","num-color":r(S)(e.value.pick_up_jubility)},{default:d(()=>[g(b(e.value.pick_up_jubility/10),1)]),_:1},8,["num-color"])):n("",!0),e.value.common_jubility?(t(),i(_,{key:6,label:"Common Jubility","num-color":r(S)(e.value.common_jubility)},{default:d(()=>[g(b(e.value.common_jubility/10),1)]),_:1},8,["num-color"])):n("",!0),e.value.deller?(t(),i(_,{key:7,label:"Deller",number:e.value.deller},null,8,["number"])):n("",!0),e.value.sgrade?(t(),i(_,{key:8,label:"SP DAN"},{default:d(()=>[g(b(r(N)(e.value.sgrade).label),1)]),_:1})):n("",!0),e.value.dgrade?(t(),i(_,{key:9,label:"DP DAN"},{default:d(()=>[g(b(r(N)(e.value.dgrade).label),1)]),_:1})):n("",!0)]),(G=e.value.stats)!=null&&G.count?(t(),f(k,{key:1},[m(j,{icon:r(ce),title:"Stats",main:""},null,8,["icon"]),u("div",Ce,[(t(!0),f(k,null,C(Z(e.value),o=>(t(),f(k,{key:o},[o.value?(t(),i(_,{key:0,label:o.label,number:o.value},null,8,["label","number"])):n("",!0)],64))),128))])],64)):n("",!0),e.value.jubility?(t(),f(k,{key:2},[m(j,{icon:r(de),title:"Jubility Breakdown",main:""},null,8,["icon"]),u("div",Fe,[e.value.pick_up_breakdown?(t(),i(F,{key:0},{default:d(()=>[m(P,{label:"Pick-Up",color:"info"}),m(q,{"jubility-data":e.value.pick_up_breakdown,",":"",version:s.currentVersion},null,8,["jubility-data","version"])]),_:1})):n("",!0),e.value.other_breakdown?(t(),i(F,{key:1},{default:d(()=>[m(P,{label:"Common",color:"info"}),m(q,{"jubility-data":e.value.other_breakdown,",":"",version:s.currentVersion},null,8,["jubility-data","version"])]),_:1})):n("",!0)])],64)):n("",!0)]}),_:1})):n("",!0)]),_:1}))}};export{Te as default};
