import{l as A,m as D,a8 as G,r as w,s as N,o as F,Y as y,c as $,a,w as v,e as f,g as e,_ as B,d as u,F as _,b as d,p as n,q as b,G as T,aq as C,f as E,a2 as U,h as I,n as q,t as g,D as L,k as W}from"./index-BJbTzWNy.js";import{_ as j}from"./FormControl-CT69UUfR.js";import{_ as H}from"./GameHeader-D0o8XpoC.js";import{A as M}from"./music-BqvLhY1u.js";import{A as Y}from"./profile-CKyzd1SI.js";import{s as z,f as J}from"./scoreDataFilters-BXPRPpKA.js";import"./PhGear.vue--wEE-FFP.js";import"./PhHouse.vue-DhrVvVXH.js";const K={class:"flex gap-2 mb-6 md:mb-0"},O={key:0,class:"md:w-1/3 md:text-right"},Q={class:"lg:flex w-full lg:place-content-between"},X={class:"mb-4 lg:mb-0 space-y-1"},Z={class:"text-lg lg:text-xl"},ee={class:"text-md lg:text-lg"},te={class:"grid md:grid-cols-2 lg:flex gap-2 lg:justify-end lg:place-content-end"},se={key:0,class:"bg-gray-900 dark:bg-gray-700 p-4 rounded-lg"},re={class:"text-md lg:text-lg"},fe={__name:"PersonalRecords",setup(ae){const x=A(),V=D();var p=x.params.game;const t=G(p);var h=x.params.userId??null,m=w([]);const o=w(null),i=N({currentVersion:null});t||V.push({name:"ErrorPage",params:{catchAll:"404"}}),h||V.push({name:"ErrorPage",params:{catchAll:"404"}}),t.versions||(i.currentVersion=1),F(async()=>{try{const s=await M(p,h);m.value=s,P(),t.versions&&!i.currentVersion&&(i.currentVersion=k.value.at(-1)?.id??null)}catch(s){console.error("Failed to fetch score data:",s)}});async function P(){try{o.value=null;const s=await Y(p,null,h);o.value=s}catch(s){console.error("Failed to fetch user profile data:",s)}}const k=y(()=>{if(!t.versions)return[];const s=new Set(m.value.map(r=>r.version));return t.versions.filter(r=>s.has(r.id))}),S=y(()=>i.currentVersion?m.value.filter(s=>s.version===i.currentVersion):m.value),R=y(()=>S.value.filter(s=>s.charts.some(r=>r.data?.difficulty!=0&&t.chartTable[r.chart]&&r.record)));return(s,r)=>(a(),$(W,null,{default:v(()=>[e(m)?(a(),$(B,{key:0},{default:v(()=>[o.value?(a(),u(_,{key:0},[d(H,{game:e(t),profile:o.value},null,8,["game","profile"]),n("div",K,[d(b,{icon:e(T),to:`/games/${e(t).id}/profiles/${o.value.userId}`,outline:!1,color:"info",label:`${o.value.username}'s Profile`},null,8,["icon","to","label"]),d(b,{icon:e(C),to:`/games/${e(t).id}/scores/${o.value.userId}`,outline:!1,color:"info",label:`${o.value.username}'s Scores`},null,8,["icon","to","label"])]),d(E,{icon:e(U),title:`${o.value.username}'s ${e(t).shortName?e(t).shortName:e(t).name} Records`,main:""},{default:v(()=>[e(t).versions?(a(),u("div",O,[r[1]||(r[1]=n("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Version ",-1)),d(j,{modelValue:i.currentVersion,"onUpdate:modelValue":r[0]||(r[0]=c=>i.currentVersion=c),options:k.value.slice().reverse()},null,8,["modelValue","options"])])):f("",!0)]),_:1},8,["icon","title"]),(a(!0),u(_,null,I(R.value,c=>(a(),$(q,{key:c.id,class:"mb-6"},{default:v(()=>[n("div",Q,[n("div",X,[n("h1",Z,g(c.name),1),n("h2",ee,g(c.artist),1),d(b,{label:"View Song",color:"info",to:`/games/${e(p)}/song/${c.id}`},null,8,["to"])]),n("div",te,[(a(!0),u(_,null,I(c.charts,l=>(a(),u(_,{key:l.db_id},[l.record?(a(),u(_,{key:0},[e(z)(l.data?.difficulty,e(t).chartTable,l.chart)?(a(),u("div",se,[n("h2",re,g(e(t).chartTable[l.chart])+" - "+g(e(J)(l.data?.difficulty,e(t).difficultyDenom)),1),L(" "+g(l.record?`${l.record?.username} - ${l.record.points?.toLocaleString()}`:"Unclaimed"),1)])):f("",!0)],64)):f("",!0)],64))),128))])])]),_:2},1024))),128))],64)):f("",!0)]),_:1})):f("",!0)]),_:1}))}};export{fe as default};
