import{b as B,r as w,o as I,p as h,c as L,d as _,w as s,e as l,_ as M,i,h as p,P as g,g as f,aP as N,v as D,Q as V,aQ as S,l as v,j as F,f as j,aR as y,R as E,F as T,aS as O,n as Q}from"./index-BfIWj8y-.js";import{_ as z}from"./GeneralTable-hdJeyqHo.js";import{_ as u}from"./FormField-BRMR5tgl.js";import{_ as d}from"./FormControl-B6j5TJF5.js";import{o as G,p as H,q as J,r as K}from"./admin-BaoK9ueM.js";import{_ as W}from"./BaseButtons-DSlNNKGb.js";const X={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},Y={class:"bg-white dark:bg-slate-900/95 rounded-2xl lg:flex lg:justify-between"},Z={class:"w-full"},ie={__name:"NewsView",setup(ee){const x=B(),r=w([]),m=w(null),o=w(null),$=[{text:"Title",value:"title",width:150,sortable:!0},{text:"Body",value:"body",width:300},{text:"Image URL",value:"data.img",width:300}];I(async()=>{c()});async function c(){try{const a=await G();var t=[];for(var e of a){if(e.timestamp){const q=new Date(e.timestamp*1e3);e.timestamp=q.toLocaleString()}t.push(e)}r.value=t}catch(a){console.error("Failed to fetch news data:",a)}}const U=t=>{const e=t.id;x.push(`/news/${e}`)},b={title:null,body:null,data:{img:null}},n=h({...b});async function P(){try{const t=await H(n);r.value=t}catch(t){console.error("Failed to post news:",t)}Object.assign(n,b),c()}async function k(){o.value&&(await J(m.value,o.value),o.value=null,m.value=null,c())}async function A(){o.value&&(await K(o.value.id),o.value=null,m.value=null,c())}function C(t){var e=[];for(const a of t)e.push({id:a.id,label:a.title});return e}function R(t){return!t||!r.value?null:(o.value=r.value?.find(e=>e.id===t),!0)}return(t,e)=>(_(),L(Q,null,{default:s(()=>[l(M,null,{default:s(()=>[l(p,{class:"mb-6 p-1"},{default:s(()=>e[10]||(e[10]=[i("h1",{class:"text-3xl"},"News Management",-1),i("p",{class:"text-sm text-gray-400"},"Enter an post to read it",-1)])),_:1,__:[10]}),l(g,{icon:f(N),title:"Post Management",color:"text-emerald-600",main:""},null,8,["icon"]),i("div",X,[l(p,{"is-form":"",class:"row-span-1 mb-6",onSubmit:e[3]||(e[3]=D(a=>P(),["prevent"]))},{default:s(()=>[l(V,{color:"success",label:"Create Post",icon:f(S),class:"mb-2"},null,8,["icon"]),l(u,{label:"Title",help:"News headline."},{default:s(()=>[l(d,{modelValue:n.title,"onUpdate:modelValue":e[0]||(e[0]=a=>n.title=a),required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"Body",help:"News body."},{default:s(()=>[l(d,{modelValue:n.body,"onUpdate:modelValue":e[1]||(e[1]=a=>n.body=a),required:"",type:"textarea"},null,8,["modelValue"])]),_:1}),l(u,{label:"Image URL",help:"News image URL."},{default:s(()=>[l(d,{modelValue:n.data.img,"onUpdate:modelValue":e[2]||(e[2]=a=>n.data.img=a),required:""},null,8,["modelValue"])]),_:1}),i("div",null,[l(v,{type:"submit",color:"success",label:"Create",small:!1})])]),_:1}),l(p,{"is-form":"",class:"row-span-1 mb-6"},{default:s(()=>[l(V,{color:"warning",label:"Edit Post",icon:f(y),class:"mb-2"},null,8,["icon"]),l(u,{label:"Post"},{default:s(()=>[l(d,{modelValue:m.value,"onUpdate:modelValue":e[4]||(e[4]=a=>m.value=a),name:"news",options:C(r.value),required:""},null,8,["modelValue","options"])]),_:1}),l(E),R(m.value)?(_(),F(T,{key:0},[l(u,{label:"Title",help:"News headline."},{default:s(()=>[l(d,{modelValue:o.value.title,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.title=a),required:""},null,8,["modelValue"])]),_:1}),l(u,{label:"Body",help:"News body."},{default:s(()=>[l(d,{modelValue:o.value.body,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.body=a),required:"",type:"textarea"},null,8,["modelValue"])]),_:1}),l(u,{label:"Image URL",help:"News image URL."},{default:s(()=>[l(d,{modelValue:o.value.data.img,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.data.img=a),required:""},null,8,["modelValue"])]),_:1}),l(W,null,{default:s(()=>[l(v,{color:"info",label:"Update",small:!1,icon:f(N),onClick:e[8]||(e[8]=a=>k())},null,8,["icon"]),l(v,{color:"danger",label:"Delete Post",small:!1,icon:f(y),onClick:e[9]||(e[9]=a=>A())},null,8,["icon"])]),_:1})],64)):j("",!0)]),_:1})]),l(g,{icon:f(O),title:"All News",color:"text-blue-400",main:""},null,8,["icon"]),l(p,{"has-table":"",class:"mb-6"},{default:s(()=>[i("div",Y,[i("div",Z,[l(z,{headers:$,items:r.value,onRowClicked:U},null,8,["items"]),e[11]||(e[11]=i("h1",{class:"mx-4 mt-1 mb-2 text-md lg:text-lg"}," Click row to open arcade ",-1))])])]),_:1})]),_:1})]),_:1}))}};export{ie as default};
