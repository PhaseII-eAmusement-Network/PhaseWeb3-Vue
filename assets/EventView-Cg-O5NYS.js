import{r as V,p as N,a as D,o as E,V as M,M as $,c as d,d as s,w as c,e as i,_ as R,j as p,f as m,F as G,P as T,g as r,aY as W,h as Y,i as u,I as q,t as z,k as H,l as x,n as K,a7 as O}from"./index-CZV9MRmx.js";import{_ as Q}from"./ArcadeCard-BiRovYo5.js";import{_ as U}from"./FormField-BxzsYNTe.js";import{_ as v}from"./FormControl-h3k2K9va.js";import{_ as X}from"./FormCheckRadio-C4_0RGU8.js";import{s as y,g as f}from"./values-CmNcmtTU.js";import{A as Z,c as ee,d as ae}from"./arcade-C-uxRpkM.js";const le={class:"mb-4"},oe={class:"grid md:grid-cols-2 gap-4"},te={key:0},ne={key:0},se={class:"text-xl"},re={key:0,class:"space-x-2 mt-6"},ge={__name:"EventView",setup(ie){const t=V(null),o=N({game:null,version:null}),g=N([]),_=V(null),b=V(null),h=V(!0),w=D(),S=parseInt(w.params.id);async function A(){try{b.value=null,t.value={},_.value={};const l=await Z(S);b.value=l,h.value=!1}catch(l){console.error("Failed to fetch arcade data:",l)}}async function k(){try{t.value={},_.value={};const l=await ae(S,o.game,o.version);t.value=JSON.parse(JSON.stringify(l)),_.value=l}catch(l){console.error("Failed to fetch arcade setting data:",l)}}E(()=>{A(),I()});function I(){for(const l of M){const a=l.gameOptions;a&&g.push({game:l.id,gameOptions:a})}}function F(){var l=[];for(const a of g)a.gameOptions&&l.push({id:a.game,label:O(a.game).name});return l}function B(){const l=g.find(n=>n.game==o.game),a=O(o.game);var e=[];for(const n of Object.entries(l.gameOptions))if(a.versions==null)e.push({id:n[0],label:a.name}),o.version=1;else{const J=a.versions.find(L=>L.id==n[0]);e.push({id:n[0],label:J.label})}return e}function j(){const l=O(o.game);var a=null;return l.versions&&(a=l.versions.find(e=>e.id==o.version)),`${l.name} ${a?.label??""}`}function C(){return g.find(a=>a.game==o.game).gameOptions[o.version]}async function P(){(await ee(S,o.game,o.version,t.value)).status!="error"&&await k()}return $(()=>o.game,()=>{o.version=null,t.value={}}),$(()=>o.version,()=>{o.version&&k()}),(l,a)=>(s(),d(K,null,{default:c(()=>[i(R,null,{default:c(()=>[h.value?m("",!0):(s(),p(G,{key:0},[i(Q,{class:"mb-6",arcade:b.value,"use-small":!0},null,8,["arcade"]),i(T,{icon:r(W),title:"Game Event Settings",main:""},null,8,["icon"]),i(Y,{class:"mb-6"},{default:c(()=>[u("div",le,[i(U,{label:"Select Game",help:"Pick a game and version to get started."},{default:c(()=>[u("div",oe,[u("div",null,[a[4]||(a[4]=u("p",{class:"pb-2 text-lg"},"Game",-1)),i(v,{modelValue:o.game,"onUpdate:modelValue":a[0]||(a[0]=e=>o.game=e),name:"game",options:F()},null,8,["modelValue","options"])]),o.game?(s(),p("div",te,[a[5]||(a[5]=u("p",{class:"pb-2 text-lg"},"Version",-1)),i(v,{modelValue:o.version,"onUpdate:modelValue":a[1]||(a[1]=e=>o.version=e),name:"version",options:B()},null,8,["modelValue","options"])])):m("",!0)])]),_:1})]),o.game&&o.version?(s(),p("div",ne,[u("h2",se,[a[6]||(a[6]=q(" Settings for ",-1)),u("b",null,z(j()),1)]),a[7]||(a[7]=u("hr",{class:"pb-1 my-2"},null,-1)),(s(!0),p(G,null,H(C(),e=>(s(),d(U,{key:e.id,label:e.name,help:e.help},{default:c(()=>[e.type=="String"?(s(),d(v,{key:0,"model-value":r(f)(t.value,e.id)??"",name:e.name,placeholder:"Not Set","onUpdate:modelValue":n=>r(y)(t.value,e.id,n)},null,8,["model-value","name","onUpdate:modelValue"])):m("",!0),e.type=="LargeText"?(s(),d(v,{key:1,"model-value":r(f)(t.value,e.id)??"",name:e.name,placeholder:"Not Set",type:"textarea","onUpdate:modelValue":n=>r(y)(t.value,e.id,n)},null,8,["model-value","name","onUpdate:modelValue"])):m("",!0),e.type=="Boolean"?(s(),d(X,{key:2,name:e.id,"model-value":!!(r(f)(t.value,e.id)??0),"input-value":!0,type:"switch","onUpdate:modelValue":n=>r(y)(t.value,e.id,n??0)},null,8,["name","model-value","onUpdate:modelValue"])):m("",!0),e.type=="Array"?(s(),d(v,{key:3,"model-value":r(f)(t.value,e.id)??0,options:e.options,name:e.id,selected:r(f)(t.value,e.id)??0,placeholder:"Select...","onUpdate:modelValue":n=>r(y)(t.value,e.id,Number(n))},null,8,["model-value","options","name","selected","onUpdate:modelValue"])):m("",!0)]),_:2},1032,["label","help"]))),128)),JSON.stringify(t.value)!=JSON.stringify(_.value)?(s(),p("div",re,[i(x,{color:"success",label:"Save",onClick:a[2]||(a[2]=e=>P())}),i(x,{color:"danger",label:"Revert",onClick:a[3]||(a[3]=e=>k())})])):m("",!0)])):m("",!0)]),_:1})],64))]),_:1})]),_:1}))}};export{ge as default};
