import{l as A,m as G,a8 as N,r as k,s as F,o as R,Y as w,c as $,a as r,w as p,e as g,g as s,_ as B,d as u,F as v,b as d,p as l,q as x,G as D,ap as E,f as U,a2 as C,h as I,n as L,t as f,D as T,k as j}from"./index-e9Wx1hVk.js";import{_ as q}from"./FormControl-YTXPOXsH.js";import{_ as H}from"./GameHeader-D_5GtQLZ.js";import{A as M}from"./music-DmRHAG2T.js";import{A as W}from"./profile-B_czYWqy.js";import"./PhGear.vue-DE_EYguT.js";import"./PhHouse.vue-Ba1qWu1i.js";const Y={class:"flex gap-2 mb-6 md:mb-0"},z={key:0,class:"md:w-1/3 md:text-right"},J={class:"lg:flex w-full lg:place-content-between"},K={class:"mb-4 lg:mb-0 space-y-1"},O={class:"text-lg lg:text-xl"},Q={class:"text-md lg:text-lg"},X={class:"grid md:grid-cols-2 lg:flex gap-2 lg:justify-end lg:place-content-end"},Z={key:0,class:"bg-gray-900 dark:bg-gray-700 p-4 rounded-lg"},ee={class:"text-md lg:text-lg"},ce={__name:"PersonalRecords",setup(se){const y=A(),V=G();var _=y.params.game;const e=N(_);var h=y.params.userId??null,m=k([]);const a=k(null),n=F({currentVersion:null});e||V.push({name:"ErrorPage",params:{catchAll:"404"}}),h||V.push({name:"ErrorPage",params:{catchAll:"404"}}),e.versions||(n.currentVersion=1),R(async()=>{try{const t=await M(_,h);m.value=t,P(),e.versions&&!n.currentVersion&&(n.currentVersion=b.value.at(-1)?.id??null)}catch(t){console.error("Failed to fetch score data:",t)}});async function P(){try{a.value=null;const t=await W(_,null,h);a.value=t}catch(t){console.error("Failed to fetch user profile data:",t)}}const b=w(()=>{if(!e.versions)return[];const t=new Set(m.value.map(o=>o.version));return e.versions.filter(o=>t.has(o.id))}),S=w(()=>n.currentVersion?m.value.filter(t=>t.version===n.currentVersion):m.value);return(t,o)=>(r(),$(j,null,{default:p(()=>[s(m)?(r(),$(B,{key:0},{default:p(()=>[a.value?(r(),u(v,{key:0},[d(H,{game:s(e),profile:a.value},null,8,["game","profile"]),l("div",Y,[d(x,{icon:s(D),to:`/games/${s(e).id}/profiles/${a.value.userId}`,outline:!1,color:"info",label:`${a.value.username}'s Profile`},null,8,["icon","to","label"]),d(x,{icon:s(E),to:`/games/${s(e).id}/scores/${a.value.userId}`,outline:!1,color:"info",label:`${a.value.username}'s Scores`},null,8,["icon","to","label"])]),d(U,{icon:s(C),title:`${a.value.username}'s ${s(e).shortName?s(e).shortName:s(e).name} Records`,main:""},{default:p(()=>[s(e).versions?(r(),u("div",z,[o[1]||(o[1]=l("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Version ",-1)),d(q,{modelValue:n.currentVersion,"onUpdate:modelValue":o[0]||(o[0]=i=>n.currentVersion=i),options:b.value.slice().reverse()},null,8,["modelValue","options"])])):g("",!0)]),_:1},8,["icon","title"]),(r(!0),u(v,null,I(S.value,i=>(r(),$(L,{key:i.id,class:"mb-6"},{default:p(()=>[l("div",J,[l("div",K,[l("h1",O,f(i.name),1),l("h2",Q,f(i.artist),1),d(x,{label:"View Song",color:"info",to:`/games/${s(_)}/song/${i.id}`},null,8,["to"])]),l("div",X,[(r(!0),u(v,null,I(i.charts,c=>(r(),u(v,{key:c.db_id},[c.data?.difficulty!=0?(r(),u("div",Z,[l("h2",ee,f(s(e).chartTable[c.chart])+" - "+f(c.data?.difficulty),1),T(" "+f(c.record?`${c.record?.username} - ${c.record.points?.toLocaleString()}`:"Unclaimed"),1)])):g("",!0)],64))),128))])])]),_:2},1024))),128))],64)):g("",!0)]),_:1})):g("",!0)]),_:1}))}};export{ce as default};
