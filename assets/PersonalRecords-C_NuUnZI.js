import{a as R,b as B,a7 as G,r as S,p as E,o as L,al as A,c as $,d as o,w as g,f as p,g as a,_ as U,j as u,F as v,e as d,i as l,l as b,P as j,bX as C,k as N,h as T,t as f,I as M,n as W}from"./index-D0hKoGh3.js";import{_ as X}from"./FormControl-dmBiWM7h.js";import{_ as q}from"./GameHeader-D30gtdUP.js";import{b as z}from"./music-CyMEC0mx.js";import{A as H}from"./profile-Bv_Iqbkt.js";import"./sources-DLy3s10j.js";const J={class:"flex gap-2 mb-2 md:mb-0"},K={key:0,class:"md:w-1/3 md:text-right"},O={class:"lg:flex w-full lg:place-content-between"},Q={class:"mb-4 lg:mb-0 space-y-1"},Y={class:"text-lg lg:text-xl"},Z={class:"text-md lg:text-lg"},ee={class:"grid md:grid-cols-2 lg:flex gap-2 lg:justify-end lg:place-content-end"},se={key:0,class:"bg-gray-900 dark:bg-gray-700 p-4 rounded-lg"},re={class:"text-md lg:text-lg"},ue={__name:"PersonalRecords",setup(ae){const y=R(),V=B();var _=y.params.game;const e=G(_);var h=y.params.userId??null,m=S([]);const t=S(null),n=E({currentVersion:null});e||V.push({name:"ErrorPage",params:{catchAll:"404"}}),h||V.push({name:"ErrorPage",params:{catchAll:"404"}}),e.versions||(n.currentVersion=1),L(async()=>{var s;try{const r=await z(_,h);m.value=r,F(),e.versions&&!n.currentVersion&&(n.currentVersion=((s=x.value.at(-1))==null?void 0:s.id)??null)}catch(r){console.error("Failed to fetch score data:",r)}});async function F(){try{t.value=null;const s=await H(_,null,h);t.value=s}catch(s){console.error("Failed to fetch user profile data:",s)}}const x=A(()=>{if(!e.versions)return[];const s=new Set(m.value.map(r=>r.version));return e.versions.filter(r=>s.has(r.id))}),D=A(()=>n.currentVersion?m.value.filter(s=>s.version===n.currentVersion):m.value);return(s,r)=>(o(),$(W,null,{default:g(()=>[a(m)?(o(),$(U,{key:0},{default:g(()=>[t.value?(o(),u(v,{key:0},[d(q,{game:a(e),profile:t.value},null,8,["game","profile"]),l("div",J,[d(b,{icon:s.mdiAccountDetails,href:`/#/games/${a(e).id}/profiles/${t.value.userId}`,outline:!1,color:"info",label:`${t.value.username}'s Profile`},null,8,["icon","href","label"]),d(b,{icon:s.mdiAccountDetails,href:`/#/games/${a(e).id}/scores/${t.value.userId}`,outline:!1,color:"info",label:`${t.value.username}'s Scores`},null,8,["icon","href","label"])]),d(j,{icon:a(C),title:`${t.value.username}'s ${a(e).shortName?a(e).shortName:a(e).name} Records`,main:""},{default:g(()=>[a(e).versions?(o(),u("div",K,[r[1]||(r[1]=l("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Version ",-1)),d(X,{modelValue:n.currentVersion,"onUpdate:modelValue":r[0]||(r[0]=i=>n.currentVersion=i),options:x.value.slice().reverse()},null,8,["modelValue","options"])])):p("",!0)]),_:1},8,["icon","title"]),(o(!0),u(v,null,N(D.value,i=>(o(),$(T,{key:i.id,class:"mb-6"},{default:g(()=>[l("div",O,[l("div",Q,[l("h1",Y,f(i.name),1),l("h2",Z,f(i.artist),1),d(b,{label:"View Song",color:"info",href:`/#/games/${a(_)}/song/${i.id}`},null,8,["href"])]),l("div",ee,[(o(!0),u(v,null,N(i.charts,c=>{var k,I,P,w;return o(),u(v,{key:c.db_id},[((k=c.data)==null?void 0:k.difficulty)!=0?(o(),u("div",se,[l("h2",re,f(a(e).chartTable[c.chart])+" - "+f((I=c.data)==null?void 0:I.difficulty),1),M(" "+f(c.record?`${(P=c.record)==null?void 0:P.username} - ${(w=c.record.points)==null?void 0:w.toLocaleString()}`:"Unclaimed"),1)])):p("",!0)],64)}),128))])])]),_:2},1024))),128))],64)):p("",!0)]),_:1})):p("",!0)]),_:1}))}};export{ue as default};
