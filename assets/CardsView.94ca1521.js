import{r as _,s as k,o as $,a as r,c as g,w as i,b as t,W as A,X as h,e as n,a2 as D,_ as V,v as S,f as c,k as w,a3 as E,g as s,Q as F,i as p,F as P,j as B,t as N,l as T,n as O,V as L,a4 as j}from"./index.051d038d.js";import{d as v}from"./userData.bcc92478.js";import{_ as M}from"./FormField.a436ceea.js";import{_ as U}from"./FormControl.bac59ab6.js";import{e as W,f as q,g as z}from"./account.cb592211.js";const G={class:"grid md:grid-cols-2 mb-2"},H=s("div",{class:"text-xl md:text-right"},[s("h4",null,"AC = Web Access Code"),s("h4",null,[L("NFC-ID = Internal ID for "),s("samp",null,"card0.txt")])],-1),Q={key:0,class:"grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5 gap-6"},R={class:"flex justify-between md:grid md:gap-2 mb-4 items-center"},Z=["src"],J={class:"text-xl text-center font-mono"},K={class:"grid grid-cols-3 md:grid-cols-2 gap-2"},ne={__name:"CardsView",setup(Y){const b="https://cdn.phaseii.network/file/PhaseII/web-assets";var d=_([]);const u=_(!1),l=k({newCard:null});async function m(){d.value=null;try{const e=await W();d.value=e}catch(e){console.error("Failed to fetch card data:",e)}}$(async()=>{await m()});function y(e){var a=e.target.value;a=a.replace(/[^A-Za-z0-9]/g,""),a=a.toUpperCase().replace(/(.{4})/g,"$1-").replace(/-$/,""),l.newCard=a}async function x(){u.value=!0,(await z(l.newCard)).status=="success"&&(l.newCard=null,u.value=!1,await m())}async function X(e){(await q(v(e))).status=="success"&&await m()}const C=e=>{navigator.clipboard.writeText(e).then(()=>{alert("Copied to clipboard!")}).catch(()=>{alert("Failed to copy to clipboard!")})};return(e,a)=>{const I=j("BaseIcon");return r(),g(O,null,{default:i(()=>[t(T,null,{default:i(()=>[t(A,{class:"mb-6","use-small":"","even-smaller":""}),t(h,{icon:n(D),title:"Register Card",main:""},null,8,["icon"]),t(V,{"is-form":"",class:"row-span-2 mb-6",onSubmit:a[1]||(a[1]=S(o=>x(),["prevent"]))},{footer:i(()=>[t(c,{type:"submit",color:"success",label:"Add Card"}),u.value?(r(),g(I,{key:0,path:e.mdiLoading,color:"text-yellow-500",class:"animate animate-spin"},null,8,["path"])):w("",!0)]),default:i(()=>[t(M,{label:"Card ID",help:"The 16 character ACCESS CODE. If your card is dated after 2016, you'll need to get the ACCESS CODE from a game."},{default:i(()=>[t(U,{modelValue:l.newCard,"onUpdate:modelValue":a[0]||(a[0]=o=>l.newCard=o),icon:n(E),name:"cardId",type:"card",placeholder:"XXXX-XXXX-XXXX-XXXX",minlength:19,maxlength:19,required:"",onInput:y},null,8,["modelValue","icon"])]),_:1})]),_:1}),s("div",G,[t(h,{icon:n(F),title:"Login Cards",main:""},null,8,["icon"]),H]),n(d)?(r(),p("div",Q,[(r(!0),p(P,null,B(n(d),o=>(r(),p("div",{key:o.id,class:"grid dark:bg-slate-900/70 rounded-2xl p-5"},[s("div",R,[s("img",{src:`${n(b)}/passes/generic.webp`,class:"w-24 md:w-auto"},null,8,Z),s("h1",J,N(n(v)(o.encoded)),1)]),s("div",K,[t(c,{color:"info",label:"Copy AC",onClick:f=>C(o.encoded)},null,8,["onClick"]),t(c,{color:"info",label:"Copy NFC-ID",onClick:f=>C(o.id)},null,8,["onClick"]),t(c,{color:"danger",label:"Delete",onClick:f=>X(o.encoded)},null,8,["onClick"])])]))),128))])):w("",!0)]),_:1})]),_:1})}}};export{ne as default};
