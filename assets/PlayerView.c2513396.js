import{u as I,r as A,o as T,a as r,i as g,j as F,c as n,w as d,g as u,b as m,R as S,k as i,t as _,_ as x,F as V,ad as O,s as z,N as H,l as X,e as s,m as Y,f as P,aq as K,P as J,ak as Q,al as W,ac as Z,aj as b,y as ee,Y as p,ar as ae,n as le,p as te,q as re}from"./index.c03f9d2c.js";import{_ as se,g as B,a as $}from"./ProfileCard.a7e65cae.js";import{_ as ie}from"./FormControl.437b40cc.js";import{g as j}from"./danClass.233b0381.js";import"./userData.bcc92478.js";const oe={class:"flex space-x-2 mb-2"},ne={class:"flex justify-between items-center"},ue={class:"grid"},ce={class:"text-lg font-bold"},de={class:"text-md"},me={class:"text-lg"},_e={class:"text-lg"},C={__name:"JubilityTable",props:{jubilityData:{type:Array,required:!0},version:{type:Number,required:!0}},setup(N){const v=N,D=I(),k=A(null),y={0:{label:"Basic",color:"info"},1:{label:"Advanced",color:"warning"},2:{label:"Extreme",color:"danger"}};return T(async()=>{try{k.value=null;const o=v.jubilityData.map(e=>e.song_id),h=await D.getMusicData("jubeat",v.version,o),l=v.jubilityData.map(e=>{const f=h.find(w=>w.id===e.song_id&&w.chart===e.chart);return{...e,...f?{songData:f}:{}}});l.sort((e,f)=>f.rate-e.rate),k.value=l}catch(o){console.error("Failed to fetch music data:",o)}}),(o,h)=>k.value?(r(!0),g(V,{key:0},F(k.value,l=>(r(),n(x,{key:l.id,"color-prop":"bg-slate-800 dark:bg-slate-800",class:"my-3 p-5","has-table":""},{default:d(()=>[u("div",oe,[m(S,{label:y[l.chart].label,color:y[l.chart].color},null,8,["label","color"]),l.hard?(r(),n(S,{key:0,label:"Hard Mode",color:"danger"})):i("",!0)]),u("div",ne,[u("div",ue,[u("h1",ce,_(l.songData.name),1),u("h2",de,_(l.songData.artist),1)]),u("div",null,[u("h2",me,"Jubility: "+_(l.value/10),1),u("h2",_e,"Rate: "+_(l.rate/10),1)])])]),_:2},1024))),128)):i("",!0)}},ye={class:"md:flex pb-6 md:justify-between md:items-center"},be={key:0,class:"mt-2 md:mt-0 md:w-1/3 md:text-right"},fe=u("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Version ",-1),pe={class:"bg-white dark:bg-slate-900/90 rounded-2xl pt-6 p-3"},ve={class:"w-full"},ke={class:"md:w-1/3 grid grid-cols-1 md:grid-cols-2 gap-3"},ge={class:"my-6 grid grid-cols-1 md:grid-cols-4 gap-6"},he={class:"my-6 grid grid-cols-1 md:grid-cols-2 gap-6"},Pe={__name:"PlayerView",setup(N){const v=te(),D=re(),k=I();var y=null,o=null,h=null;y=v.params.game,h=v.params.userId,o=O(y),o||D.push({name:"ErrorPage",params:{catchAll:"404"}});const l=z({currentVersion:null});H(()=>l.currentVersion,()=>{f()});const e=A(null);T(async()=>{f()}),o.versions||(l.currentVersion=1);async function f(){try{e.value=null;const a=await k.getUserProfile(y,l.currentVersion,h);e.value=G(a),a&&!l.currentVersion&&(l.currentVersion=a.versions[a.versions.length-1])}catch(a){console.error("Failed to fetch user profile data:",a)}}var w=[{label:"Register Date",type:String,span:"md:col-span-2",key:"first_play_timestamp"},{label:"Last Play",type:String,span:"md:col-span-2",key:"last_play_timestamp"},{label:"First Arcade",type:String,span:"md:col-span-2",key:"first_play_arcade"},{label:"Last Arcade",type:String,span:"md:col-span-2",key:"last_play_arcade"},{label:"Total Plays",type:Number,key:"total_plays"},{label:"EXP",type:Number,key:"exp"},{label:"SP Plays",type:Number,key:"single_plays"},{label:"DP Plays",type:Number,key:"double_plays"},{label:"SP DJPOINT",type:Number,key:"single_dj_points"},{label:"DP DJPOINT",type:Number,key:"double_dj_points"}];function L(){var a=null;return l.currentVersion?a=`/assets/games/${o.id}/card/${l.currentVersion}.webp`:a=o.cardBG,a}function R(){return`
      background-image: url('${L()}');
      background-size: cover;
      background-repeat: no-repeat;
    `}function M(a,t){if(t){if(a.isSkill&&t.jubility)return B(t.jubility);if(a.isJubility&&t.records.skill)return $(t.records.skill)}return""}function U(a){var t=[];for(const c of o.versions)a.includes(c.id)&&t.push(c);return t}function q(a,t){return a.isSkill?t.stats[a.key]/100:a.isJubility?t.stats[a.key]/10:t.stats[a.key]}function E(a,t){return t?a/10:a/100}function G(a){if(a.stats){if(a.stats.first_play_timestamp){const t=new Date(a.stats.first_play_timestamp*1e3);a.stats.first_play_timestamp=t.toLocaleString()}if(a.stats.last_play_timestamp){const t=new Date(a.stats.last_play_timestamp*1e3);a.stats.last_play_timestamp=t.toLocaleString()}a.dp&&a.dp.dan!==void 0&&(a.dp.dan=j(a.dp.dan).short)}return a}return(a,t)=>(r(),n(le,null,{default:d(()=>[e.value?(r(),n(X,{key:0},{default:d(()=>[u("div",ye,[m(P,{icon:s(Y),href:`/#/games/${s(y)}`,class:"w-full md:w-auto",color:"info",label:`${s(o).shortName?s(o).shortName:s(o).name} Home`},null,8,["icon","href","label"]),s(o).versions&&e.value?(r(),g("div",be,[fe,m(ie,{modelValue:l.currentVersion,"onUpdate:modelValue":t[0]||(t[0]=c=>l.currentVersion=c),options:U(e.value.versions)},null,8,["modelValue","options"])])):i("",!0)]),m(J,{icon:s(K),title:"View Profile",main:""},null,8,["icon"]),l.currentVersion&&e.value?(r(),g("div",{key:0,style:Z(R()),class:"rounded-2xl mb-6"},[u("div",pe,[u("div",ve,[m(se,{"use-small":"",game:s(y),version:l.currentVersion,profile:e.value},{default:d(()=>[u("div",ke,[m(P,{href:`/#/games/${s(y)}/scores/${e.value.userId}`,icon:s(Q),class:"w-full md:w-auto",color:"info",label:"View Scores"},null,8,["href","icon"]),m(P,{href:`/#/games/${s(y)}/records/${e.value.userId}`,icon:s(W),class:"w-full md:w-auto",color:"info",label:"View Records"},null,8,["href","icon"])])]),_:1},8,["game","version","profile"])])])],4)):i("",!0),u("div",ge,[(r(!0),g(V,null,F(s(w),c=>(r(),g(V,{key:c},[e.value.stats[c.key]?(r(),n(b,{key:0,class:ee(c.span),label:c.label,number:c.type==Number?q(c,e.value):null,"num-color":M(c)},{default:d(()=>[p(_(c.type==String?e.value.stats[c.key]:null)+" ",1)]),_:2},1032,["class","label","number","num-color"])):i("",!0)],64))),128)),e.value.skill?(r(),n(b,{key:0,label:"Skill Points",number:E(e.value.skill,!1),"num-color":s(B)(e.value.skill)},null,8,["number","num-color"])):i("",!0),e.value.profile_skill?(r(),n(b,{key:1,label:"Skill Level"},{default:d(()=>[p(_(e.value.profile_skill/100),1)]),_:1})):i("",!0),e.value.jubility?(r(),n(b,{key:2,label:"Jubility","num-color":s($)(e.value.jubility)},{default:d(()=>[p(_(e.value.jubility/10),1)]),_:1},8,["num-color"])):i("",!0),e.value.pick_up_jubility?(r(),n(b,{key:3,label:"Pick-Up Jubility","num-color":s($)(e.value.pick_up_jubility)},{default:d(()=>[p(_(e.value.pick_up_jubility/10),1)]),_:1},8,["num-color"])):i("",!0),e.value.common_jubility?(r(),n(b,{key:4,label:"Common Jubility","num-color":s($)(e.value.common_jubility)},{default:d(()=>[p(_(e.value.common_jubility/10),1)]),_:1},8,["num-color"])):i("",!0),e.value.deller?(r(),n(b,{key:5,label:"Deller",number:e.value.deller},null,8,["number"])):i("",!0),e.value.sgrade?(r(),n(b,{key:6,label:"SP DAN"},{default:d(()=>[p(_(s(j)(e.value.sgrade).label),1)]),_:1})):i("",!0),e.value.dgrade?(r(),n(b,{key:7,label:"DP DAN"},{default:d(()=>[p(_(s(j)(e.value.dgrade).label),1)]),_:1})):i("",!0)]),e.value.jubility?(r(),g(V,{key:1},[m(J,{icon:s(ae),title:"Jubility Breakdown",main:""},null,8,["icon"]),u("div",he,[e.value.pick_up_breakdown?(r(),n(x,{key:0},{default:d(()=>[m(S,{label:"Pick-Up",color:"info"}),m(C,{"jubility-data":e.value.pick_up_breakdown,",":"",version:l.currentVersion},null,8,["jubility-data","version"])]),_:1})):i("",!0),e.value.other_breakdown?(r(),n(x,{key:1},{default:d(()=>[m(S,{label:"Common",color:"info"}),m(C,{"jubility-data":e.value.other_breakdown,",":"",version:l.currentVersion},null,8,["jubility-data","version"])]),_:1})):i("",!0)])],64)):i("",!0)]),_:1})):i("",!0)]),_:1}))}};export{Pe as default};
