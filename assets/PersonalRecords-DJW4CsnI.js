import{l as A,m as G,aa as N,r as w,z as D,o as F,s as y,c as $,a,w as v,e as f,g as e,_ as B,d as u,F as _,b as d,p as n,q as b,G as T,as as C,f as E,a4 as L,h as I,n as U,t as p,L as W,k as j}from"./index-CI044EBi.js";import{_ as q}from"./FormControl-E3QYYjbd.js";import{_ as z}from"./GameHeader-0XH44gFt.js";import{A as H}from"./music-BMeJ5xvi.js";import{A as M}from"./profile-CX1WhA3b.js";import{s as J,f as K}from"./scoreDataFilters-4V9cRP9S.js";import"./PhGear.vue-CXs__-vb.js";import"./PhHouse.vue-BmdsZNTJ.js";const O={class:"flex gap-2 mb-6 md:mb-0"},Q={key:0,class:"md:w-1/3 md:text-right"},X={class:"lg:flex w-full lg:place-content-between"},Y={class:"mb-4 lg:mb-0 space-y-1"},Z={class:"text-lg lg:text-xl"},ee={class:"text-md lg:text-lg"},se={class:"grid md:grid-cols-2 lg:flex gap-2 lg:justify-end lg:place-content-end"},te={key:0,class:"bg-gray-900 dark:bg-gray-700 p-4 rounded-lg"},re={class:"text-md lg:text-lg"},fe={__name:"PersonalRecords",setup(ae){const x=A(),V=G();var g=x.params.game;const s=N(g);var h=x.params.userId??null,m=w([]);const o=w(null),i=D({currentVersion:null});s||V.push({name:"ErrorPage",params:{catchAll:"404"}}),h||V.push({name:"ErrorPage",params:{catchAll:"404"}}),s.versions||(i.currentVersion=1),F(async()=>{try{const t=await H(g,h);m.value=t,P(),s.versions&&!i.currentVersion&&(i.currentVersion=k.value.at(-1)?.id??null)}catch(t){console.error("Failed to fetch score data:",t)}});async function P(){try{o.value=null;const t=await M(g,null,h);o.value=t.profile}catch(t){console.error("Failed to fetch user profile data:",t)}}const k=y(()=>{if(!s.versions)return[];const t=new Set(m.value.map(r=>r.version));return s.versions.filter(r=>t.has(r.id))}),S=y(()=>i.currentVersion?m.value.filter(t=>t.version===i.currentVersion):m.value),R=y(()=>S.value.filter(t=>t.charts.some(r=>r.data?.difficulty!=0&&s.chartTable[r.chart]&&r.record)));return(t,r)=>(a(),$(j,null,{default:v(()=>[e(m)?(a(),$(B,{key:0},{default:v(()=>[o.value?(a(),u(_,{key:0},[d(z,{game:e(s),profile:o.value},null,8,["game","profile"]),n("div",O,[d(b,{icon:e(T),to:`/games/${e(s).id}/profiles/${o.value.userId}`,outline:!1,color:"info",label:`${o.value.username}'s Profile`},null,8,["icon","to","label"]),d(b,{icon:e(C),to:`/games/${e(s).id}/scores/${o.value.userId}`,outline:!1,color:"info",label:`${o.value.username}'s Scores`},null,8,["icon","to","label"])]),d(E,{icon:e(L),title:`${o.value.username}'s ${e(s).shortName?e(s).shortName:e(s).name} Records`,main:""},{default:v(()=>[e(s).versions?(a(),u("div",Q,[r[1]||(r[1]=n("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Version ",-1)),d(q,{modelValue:i.currentVersion,"onUpdate:modelValue":r[0]||(r[0]=c=>i.currentVersion=c),options:k.value.slice().reverse()},null,8,["modelValue","options"])])):f("",!0)]),_:1},8,["icon","title"]),(a(!0),u(_,null,I(R.value,c=>(a(),$(U,{key:c.id,class:"mb-6"},{default:v(()=>[n("div",X,[n("div",Y,[n("h1",Z,p(c.name),1),n("h2",ee,p(c.artist),1),d(b,{label:"View Song",color:"info",to:`/games/${e(g)}/song/${c.id}`},null,8,["to"])]),n("div",se,[(a(!0),u(_,null,I(c.charts,l=>(a(),u(_,{key:l.db_id},[l.record?(a(),u(_,{key:0},[e(J)(l.data?.difficulty,e(s).chartTable,l.chart)?(a(),u("div",te,[n("h2",re,p(e(s).chartTable[l.chart])+" - "+p(e(K)(l.data?.difficulty,e(s).difficultyDenom)),1),W(" "+p(l.record?`${l.record?.username} - ${l.record.points?.toLocaleString()}`:"Unclaimed"),1)])):f("",!0)],64)):f("",!0)],64))),128))])])]),_:2},1024))),128))],64)):f("",!0)]),_:1})):f("",!0)]),_:1}))}};export{fe as default};
