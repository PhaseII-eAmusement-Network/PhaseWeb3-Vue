import{l as G,m as N,a8 as R,r as w,s as D,o as F,Y as $,c as y,a,w as v,e as f,g as t,_ as B,d as u,F as _,b as d,p as n,q as b,G as T,ap as E,f as U,a2 as C,h as I,n as L,t as g,D as W,k as j}from"./index-B8PF5fsn.js";import{_ as q}from"./FormControl-BtNKEqsc.js";import{_ as H}from"./GameHeader-BFbHBmgM.js";import{A as M}from"./music-qXM57SCO.js";import{A as Y}from"./profile-BIvSLEgz.js";import"./PhGear.vue-CAIbbLcP.js";import"./PhHouse.vue-CmhfH9kZ.js";const z={class:"flex gap-2 mb-6 md:mb-0"},J={key:0,class:"md:w-1/3 md:text-right"},K={class:"lg:flex w-full lg:place-content-between"},O={class:"mb-4 lg:mb-0 space-y-1"},Q={class:"text-lg lg:text-xl"},X={class:"text-md lg:text-lg"},Z={class:"grid md:grid-cols-2 lg:flex gap-2 lg:justify-end lg:place-content-end"},ee={key:0,class:"bg-gray-900 dark:bg-gray-700 p-4 rounded-lg"},te={class:"text-md lg:text-lg"},ue={__name:"PersonalRecords",setup(se){const x=G(),V=N();var p=x.params.game;const e=R(p);var h=x.params.userId??null,m=w([]);const o=w(null),i=D({currentVersion:null});e||V.push({name:"ErrorPage",params:{catchAll:"404"}}),h||V.push({name:"ErrorPage",params:{catchAll:"404"}}),e.versions||(i.currentVersion=1),F(async()=>{try{const s=await M(p,h);m.value=s,P(),e.versions&&!i.currentVersion&&(i.currentVersion=k.value.at(-1)?.id??null)}catch(s){console.error("Failed to fetch score data:",s)}});async function P(){try{o.value=null;const s=await Y(p,null,h);o.value=s}catch(s){console.error("Failed to fetch user profile data:",s)}}const k=$(()=>{if(!e.versions)return[];const s=new Set(m.value.map(r=>r.version));return e.versions.filter(r=>s.has(r.id))}),S=$(()=>i.currentVersion?m.value.filter(s=>s.version===i.currentVersion):m.value),A=$(()=>S.value.filter(s=>s.charts.some(r=>r.data?.difficulty!=0&&e.chartTable[r.chart]&&r.record)));return(s,r)=>(a(),y(j,null,{default:v(()=>[t(m)?(a(),y(B,{key:0},{default:v(()=>[o.value?(a(),u(_,{key:0},[d(H,{game:t(e),profile:o.value},null,8,["game","profile"]),n("div",z,[d(b,{icon:t(T),to:`/games/${t(e).id}/profiles/${o.value.userId}`,outline:!1,color:"info",label:`${o.value.username}'s Profile`},null,8,["icon","to","label"]),d(b,{icon:t(E),to:`/games/${t(e).id}/scores/${o.value.userId}`,outline:!1,color:"info",label:`${o.value.username}'s Scores`},null,8,["icon","to","label"])]),d(U,{icon:t(C),title:`${o.value.username}'s ${t(e).shortName?t(e).shortName:t(e).name} Records`,main:""},{default:v(()=>[t(e).versions?(a(),u("div",J,[r[1]||(r[1]=n("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Version ",-1)),d(q,{modelValue:i.currentVersion,"onUpdate:modelValue":r[0]||(r[0]=c=>i.currentVersion=c),options:k.value.slice().reverse()},null,8,["modelValue","options"])])):f("",!0)]),_:1},8,["icon","title"]),(a(!0),u(_,null,I(A.value,c=>(a(),y(L,{key:c.id,class:"mb-6"},{default:v(()=>[n("div",K,[n("div",O,[n("h1",Q,g(c.name),1),n("h2",X,g(c.artist),1),d(b,{label:"View Song",color:"info",to:`/games/${t(p)}/song/${c.id}`},null,8,["to"])]),n("div",Z,[(a(!0),u(_,null,I(c.charts,l=>(a(),u(_,{key:l.db_id},[l.record?(a(),u(_,{key:0},[l.data?.difficulty!=0&&t(e).chartTable[l.chart]?(a(),u("div",ee,[n("h2",te,g(t(e).chartTable[l.chart])+" - "+g(l.data?.difficulty/(t(e).difficultyDenom??1)),1),W(" "+g(l.record?`${l.record?.username} - ${l.record.points?.toLocaleString()}`:"Unclaimed"),1)])):f("",!0)],64)):f("",!0)],64))),128))])])]),_:2},1024))),128))],64)):f("",!0)]),_:1})):f("",!0)]),_:1}))}};export{ue as default};
