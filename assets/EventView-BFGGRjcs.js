import{r as y,s as $,l as P,o as E,S as R,L as N,c as d,a as s,w as c,b as i,_ as T,d as p,e as m,F as G,f as W,g as r,av as q,n as M,p as u,D as z,t as H,h as K,q as x,k as Q,a8 as O}from"./index-CzFGUGVD.js";import{_ as X}from"./ArcadeCard-BFzaJzmF.js";import{_ as U}from"./FormField-CX5ENjvM.js";import{_ as v}from"./FormControl-BE8C8gtk.js";import{_ as Y}from"./FormCheckRadio-BVMO2t3w.js";import{s as b,g as f}from"./values-CmNcmtTU.js";import{A as Z,c as ee,d as ae}from"./arcade-C9OEW4Mk.js";import"./PhCashRegister.vue-4wMZuTYv.js";import"./PhHouse.vue-CZLZQa2J.js";const oe={class:"mb-4"},le={class:"grid md:grid-cols-2 gap-4"},te={key:0},ne={key:0},se={class:"text-xl"},re={key:0,class:"space-x-2 mt-6"},ye={__name:"EventView",setup(ie){const t=y(null),l=$({game:null,version:null}),g=$([]),_=y(null),V=y(null),h=y(!0),w=P(),S=parseInt(w.params.id);async function A(){try{V.value=null,t.value={},_.value={};const o=await Z(S);V.value=o,h.value=!1}catch(o){console.error("Failed to fetch arcade data:",o)}}async function k(){try{t.value={},_.value={};const o=await ae(S,l.game,l.version);t.value=JSON.parse(JSON.stringify(o)),_.value=o}catch(o){console.error("Failed to fetch arcade setting data:",o)}}E(()=>{A(),I()});function I(){for(const o of R){const a=o.gameOptions;a&&g.push({game:o.id,gameOptions:a})}}function F(){var o=[];for(const a of g)a.gameOptions&&o.push({id:a.game,label:O(a.game).name});return o}function B(){const o=g.find(n=>n.game==l.game),a=O(l.game);var e=[];for(const n of Object.entries(o.gameOptions))if(a.versions==null)e.push({id:n[0],label:a.name}),l.version=1;else{const D=a.versions.find(J=>J.id==n[0]);e.push({id:n[0],label:D.label})}return e}function C(){const o=O(l.game);var a=null;return o.versions&&(a=o.versions.find(e=>e.id==l.version)),`${o.name} ${a?.label??""}`}function L(){return g.find(a=>a.game==l.game).gameOptions[l.version]}async function j(){(await ee(S,l.game,l.version,t.value)).status!="error"&&await k()}return N(()=>l.game,()=>{l.version=null,t.value={}}),N(()=>l.version,()=>{l.version&&k()}),(o,a)=>(s(),d(Q,null,{default:c(()=>[i(T,null,{default:c(()=>[h.value?m("",!0):(s(),p(G,{key:0},[i(X,{class:"mb-6",arcade:V.value,"use-small":!0},null,8,["arcade"]),i(W,{icon:r(q),title:"Game Event Settings",main:""},null,8,["icon"]),i(M,{class:"mb-6"},{default:c(()=>[u("div",oe,[i(U,{label:"Select Game",help:"Pick a game and version to get started."},{default:c(()=>[u("div",le,[u("div",null,[a[4]||(a[4]=u("p",{class:"pb-2 text-lg"},"Game",-1)),i(v,{modelValue:l.game,"onUpdate:modelValue":a[0]||(a[0]=e=>l.game=e),name:"game",options:F()},null,8,["modelValue","options"])]),l.game?(s(),p("div",te,[a[5]||(a[5]=u("p",{class:"pb-2 text-lg"},"Version",-1)),i(v,{modelValue:l.version,"onUpdate:modelValue":a[1]||(a[1]=e=>l.version=e),name:"version",options:B()},null,8,["modelValue","options"])])):m("",!0)])]),_:1})]),l.game&&l.version?(s(),p("div",ne,[u("h2",se,[a[6]||(a[6]=z(" Settings for ",-1)),u("b",null,H(C()),1)]),a[7]||(a[7]=u("hr",{class:"pb-1 my-2"},null,-1)),(s(!0),p(G,null,K(L(),e=>(s(),d(U,{key:e.id,label:e.name,help:e.help},{default:c(()=>[e.type=="String"?(s(),d(v,{key:0,"model-value":r(f)(t.value,e.id)??"",name:e.name,placeholder:"Not Set","onUpdate:modelValue":n=>r(b)(t.value,e.id,n)},null,8,["model-value","name","onUpdate:modelValue"])):m("",!0),e.type=="LargeText"?(s(),d(v,{key:1,"model-value":r(f)(t.value,e.id)??"",name:e.name,placeholder:"Not Set",type:"textarea","onUpdate:modelValue":n=>r(b)(t.value,e.id,n)},null,8,["model-value","name","onUpdate:modelValue"])):m("",!0),e.type=="Boolean"?(s(),d(Y,{key:2,name:e.id,"model-value":!!(r(f)(t.value,e.id)??0),"input-value":!0,type:"switch","onUpdate:modelValue":n=>r(b)(t.value,e.id,n??0)},null,8,["name","model-value","onUpdate:modelValue"])):m("",!0),e.type=="Array"?(s(),d(v,{key:3,"model-value":r(f)(t.value,e.id)??0,options:e.options,name:e.id,selected:r(f)(t.value,e.id)??0,placeholder:"Select...","onUpdate:modelValue":n=>r(b)(t.value,e.id,Number(n))},null,8,["model-value","options","name","selected","onUpdate:modelValue"])):m("",!0)]),_:2},1032,["label","help"]))),128)),JSON.stringify(t.value)!=JSON.stringify(_.value)?(s(),p("div",re,[i(x,{color:"success",label:"Save",onClick:a[2]||(a[2]=e=>j())}),i(x,{color:"danger",label:"Revert",onClick:a[3]||(a[3]=e=>k())})])):m("",!0)])):m("",!0)]),_:1})],64))]),_:1})]),_:1}))}};export{ye as default};
