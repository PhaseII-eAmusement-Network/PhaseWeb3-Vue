import{a as N,r as _,o as H,al as l,c as S,d as o,w as k,e as n,_ as L,j as f,f as w,F as v,i as P,P as h,g as p,x as Q,O as z,am as J,k as T,an as K,ao as W,ab as X,ap as Y,h as Z,aq as ee,ar as ae,n as te,as as se,a7 as re,at as D,au as y,av as le}from"./index-Cn7Qxkym.js";const oe={class:"grid grid-cols-2 sm:grid-cols-3 gap-6 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 3xl:grid-cols-5 mb-6"},ne={class:"grid grid-flow-row auto-rows-auto grid-cols-2 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-3 3xl:grid-cols-4 4xl:grid-cols-6 gap-5 mb-5"},ce={key:0},de={__name:"PublicView",setup(ie){const O=N().params.id,u=_(null),r=_(null),m=_(null);async function $(){try{var e=await se(O);e.name||(e.name="Unclaimed Account"),u.value=e}catch(t){console.error("Failed to fetch user profile data:",t)}}H(async()=>{await $(),r.value=u.value.profiles,m.value=u.value.userScoreStats});const E=l(()=>{var e;return(e=r.value)==null?void 0:e.reduce((t,a)=>t+a.data.total_plays,0)}),I=l(()=>{var e;return(e=r.value)==null?void 0:e.length}),A=l(()=>{var a;const e=s=>{const c={};return s.forEach(i=>{const d=new Date(i*1e3).toISOString().split("T")[0];c[d]=(c[d]||0)+1}),c};var t=0;return(a=r.value)==null||a.forEach(s=>{var g,x;const c=(g=s.data)!=null&&g.arcade_history?(x=s.data)==null?void 0:x.arcade_history:{},i=[];Object.values(c).forEach(M=>{Object.values(M).forEach(q=>{i.push(...q)})});const d=e(i),b=Math.max(...Object.values(d));t=Math.max(t,b)}),t});function B(e){if(e){var t=[];for(const a of e){const s=re(a.game);s&&!s.skip&&t.push(a)}return t.sort(function(a,s){return s.data.last_play_timestamp-a.data.last_play_timestamp}),t}}const C=new Date().toISOString().split("T")[0],U=l(()=>{var e,t;return((t=(e=m.value)==null?void 0:e.attempts)==null?void 0:t.length)||0}),j=l(()=>{var e,t;return((t=(e=m.value)==null?void 0:e.records)==null?void 0:t.length)||0}),F=l(()=>{var e,t;return((t=(e=m.value)==null?void 0:e.attempts)==null?void 0:t.filter(a=>new Date(a.timestamp*1e3).toISOString().split("T")[0]===C).length)||0}),G=l(()=>{var e,t;return((t=(e=m.value)==null?void 0:e.records)==null?void 0:t.filter(a=>new Date(a.timestamp*1e3).toISOString().split("T")[0]===C).length)||0}),R=l(()=>{var a;const e=new Date().toISOString().split("T")[0];let t=0;return(a=r.value)==null||a.forEach(s=>{var i;const c=((i=s.data)==null?void 0:i.arcade_history)||{};Object.values(c).forEach(d=>{Object.values(d).forEach(b=>{b.forEach(g=>{new Date(g*1e3).toISOString().split("T")[0]===e&&t++})})})}),t}),V=_([{label:"Cumulative Plays",icon:D,iconColor:"text-emerald-600",suffix:"play",number:E},{label:"Games Played",icon:y,iconColor:"text-sky-300",suffix:"game",number:I},{label:"Plays Today",icon:D,iconColor:"text-sky-300",suffix:"play",number:R},{label:"Longest Play Streak",icon:le,iconColor:"text-red-500",suffix:"play",number:A},{label:"Total Records",icon:y,iconColor:"text-sky-300",suffix:"record",number:j},{label:"Total Attempts",icon:y,iconColor:"text-sky-300",suffix:"attempt",number:U},{label:"Records Today",icon:y,iconColor:"text-sky-300",suffix:"record",number:G},{label:"Attempts Today",icon:y,iconColor:"text-sky-300",suffix:"attempt",number:F}]);return(e,t)=>(o(),S(te,null,{default:k(()=>[n(L,null,{default:k(()=>[u.value!==null?(o(),f(v,{key:0},[n(h,{icon:p(Q),title:`${u.value.name}'s Profile`,main:""},null,8,["icon","title"]),n(z,{class:"mb-6","override-profile":u.value,"use-small":""},null,8,["override-profile"]),n(h,{icon:p(J),title:"Quick Stats",main:""},null,8,["icon"]),P("div",oe,[(o(!0),f(v,null,T(V.value,a=>(o(),f(v,{key:a.label},[a.number?(o(),S(K,{key:0,icon:a.icon,number:a.number,label:a.label,suffix:`${a.suffix}${a.number==1?"":"s"}`,"icon-color":a.iconColor},null,8,["icon","number","label","suffix","icon-color"])):w("",!0)],64))),128))]),n(h,{icon:p(W),title:"Showcase",main:""},null,8,["icon"]),P("div",ne,[(o(!0),f(v,null,T(B(r.value),a=>(o(),S(X,{key:a.game,game:a.game,value:a.data.total_plays,"profile-name":"",type:"plays"},null,8,["game","value"]))),128))]),n(h,{icon:p(Y),title:"Play Trends",main:""},null,8,["icon"]),n(Z,{class:"mb-6"},{default:k(()=>[r.value?(o(),f("div",ce,[n(ee,{data:p(ae)(r.value,m.value),class:"h-96"},null,8,["data"])])):w("",!0)]),_:1})],64)):w("",!0)]),_:1})]),_:1}))}};export{de as default};
