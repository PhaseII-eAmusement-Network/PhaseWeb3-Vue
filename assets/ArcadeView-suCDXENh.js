import{u as X,r as u,a as Y,b as Z,D as ee,o as ae,c as b,d as o,w as r,e as l,_ as le,j as _,f as g,F as w,i as s,g as i,J as x,h as y,s as S,K as k,l as d,v as E,an as ne,L as te,k as L,ar as se,t as oe,ap as re,ae as ie,m as de}from"./index-D5js98pV.js";import{H as ce}from"./PhCheckCircle.vue-Dt3RylAB.js";import{F as P}from"./PhGear.vue-DqQZLxjy.js";import{H as R}from"./PhInfo.vue-CxYjWatN.js";import{_ as ue}from"./ArcadeCard-Bhs14DiG.js";import{_ as h}from"./FormField-Bh7gS7TO.js";import{_ as D}from"./FormCheckRadio-CuMzS59Y.js";import{_ as U}from"./FormControl-DfNoBpfO.js";import{s as C,g as F}from"./values-CmNcmtTU.js";import{A as me,a as fe,b as pe}from"./arcade-mGzuezTz.js";import{m as ve,s as be,c as _e,t as ge,u as Ae,v as ye}from"./admin-DoTAzMzk.js";import"./PhCashRegister.vue-BZCb9Jzn.js";import"./PhHouse.vue-CIC86uz2.js";const he={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},we={class:"mb-4 flex gap-2 items-stretch"},ke={key:0,class:"space-x-2 mt-6 mb-4"},$e={class:"mb-4"},Ve={class:"mb-4"},Ne={class:"grid gap-4"},xe={class:"flex justify-between items-center"},Se={class:"m-[-5px] md:flex items-center gap-2"},Pe={class:"w-8 md:w-12"},Ue={class:"text-lg lg:text-xl font-bold"},Ce={class:"grid grid-cols-1 w-full gap-2 md:gap-6 md:flex md:place-content-stretch"},Ie={key:0,class:"space-x-2 mt-6"},Me={class:"grid grid-cols-1 gap-6 sm:grid-cols-2 md:grid-cols-3 mb-6"},Te={__name:"ArcadeView",setup(Oe){const $=X(),v=u(null),V=u(null),c=u(null),I=u(!0),N=u(null),t=u(null),A=u(null),M=u(null),J=Y(),j=Z(),m=parseInt(J.params.id);var O=[{id:"paseli_enabled",name:"PASELI Services",help:"Enable PASELI for this arcade.",type:"Boolean"},{id:"paseli_infinite",name:"Infinite PASELI",help:"Enable infinite PASELI for this arcade.",type:"Boolean"},{id:"maint",name:"Maintenance Mode",help:"Place this arcade under maintenance.",type:"Boolean"},{id:"hide_network",name:"Incognito Mode",help:"Hide the network and all ranking data.",type:"Boolean"}];async function f(){try{c.value={},v.value={},V.value={};const n=await me(m);c.value=n,t.value=JSON.parse(JSON.stringify(n));for(const a of O){const e=F(c.value.data,a.id);C(v.value,a.id,e),C(V.value,a.id,e)}I.value=!1}catch(n){console.error("Failed to fetch arcade data:",n)}}async function B(){if($.userAdmin)try{const n=await ve(!0),a=[];for(const e of n)e.username!=null&&a.push({id:e.id,label:e.username});a.sort((e,p)=>e.label.localeCompare(p.label)),M.value=a}catch(n){console.error("Failed to fetch admin user data:",n)}}ee(()=>$.userAdmin,()=>{B()});async function G(){(await fe(m,v.value)).status!="error"&&await f()}ae(()=>{f(),B()});function H(n,a="NA_"){var e=[...n].map(p=>p.charCodeAt(0)<128?p:a).join("");return e=e.replace(/[!"#$%&'()*+,-./:;<=>?@[\\\]^_`{|}~]/g,""),e=e.replace(/\s+/g,"_"),e}async function q(){try{const n=await pe(m),a=new Blob([n],{type:"application/ovpn"}),e=document.createElement("a");e.href=URL.createObjectURL(a),e.download=`gradius-${H(c.value.name)}-phaseii-config.ovpn`,document.body.appendChild(e),e.click(),URL.revokeObjectURL(e.href),document.body.removeChild(e)}catch(n){console.log("Failed to fetch arcade data:",n)}}async function z(){if(t.value.name){const n=await _e(t.value.name);n.unused!=null&&(N.value=n.unused)}}async function K(){(await be(m,{name:t.value.name,description:t.value.description,beta:t.value.data.is_beta})).status!="error"&&await f()}async function T(){if(A.value==null)return;(await Ae(m,A.value)).status!="error"&&(A.value=null,f())}async function Q(n){if(!n)return;(await ye(m,n)).status!="error"&&f()}async function W(){window.confirm(`Are you really?
This will remove all owners, machines, and arcade data.`)&&(await ge(m)).status!="error"&&await j.push({name:"admin_arcades"})}return(n,a)=>(o(),b(de,null,{default:r(()=>[l(le,null,{default:r(()=>[I.value?g("",!0):(o(),_(w,{key:0},[l(ue,{class:"mb-6",arcade:c.value},null,8,["arcade"]),i($).userAdmin?(o(),_(w,{key:0},[l(x,{icon:i(P),title:"Arcade Administration",main:""},null,8,["icon"]),s("div",he,[l(y,{"is-form":"",class:"lg:mb-6",onSubmit:S(K,["prevent"])},{default:r(()=>[l(k,{color:"info",label:"General Information",icon:i(R),class:"mb-2"},null,8,["icon"]),l(h,{label:"Arcade Name"},{default:r(()=>[l(U,{modelValue:t.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>t.value.name=e),"input-value":t.value.name,name:"arcadeName",required:""},null,8,["modelValue","input-value"])]),_:1}),s("div",we,[l(d,{color:"info",label:"Check Name",onClick:a[1]||(a[1]=e=>z())}),N.value==!0?(o(),b(E,{key:0,icon:i(ce),color:"text-green-400",size:"25"},null,8,["icon"])):N.value==!1?(o(),b(E,{key:1,icon:i(ne),color:"text-red-400",size:"25"},null,8,["icon"])):g("",!0)]),l(h,{label:"Description"},{default:r(()=>[l(U,{modelValue:t.value.description,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value.description=e),name:"description",required:""},null,8,["modelValue"])]),_:1}),l(h,{label:"Beta Enabled"},{default:r(()=>[l(D,{modelValue:t.value.data.is_beta,"onUpdate:modelValue":a[3]||(a[3]=e=>t.value.data.is_beta=e),name:"beta","model-value":t.value.data.is_beta,"input-value":t.value.data.is_beta,type:"switch"},null,8,["modelValue","model-value","input-value"])]),_:1}),JSON.stringify(c.value)!==JSON.stringify(t.value)?(o(),_("div",ke,[l(d,{color:"success",label:"Save",type:"submit"}),l(d,{color:"warning",label:"Revert",onClick:a[4]||(a[4]=e=>f())})])):g("",!0),s("div",null,[l(d,{color:"danger",label:"Delete Arcade",onClick:a[5]||(a[5]=e=>W())})])]),_:1}),l(y,{class:"mb-6"},{default:r(()=>[s("div",$e,[l(k,{color:"info",label:"Add Manager",icon:i(R),class:"mb-2"},null,8,["icon"]),s("form",{class:"h-full",onSubmit:S(T,["prevent"])},[l(h,{label:"Username"},{default:r(()=>[l(U,{modelValue:A.value,"onUpdate:modelValue":a[6]||(a[6]=e=>A.value=e),name:"username",options:M.value,required:""},null,8,["modelValue","options"])]),_:1}),l(d,{color:"success",type:"submit",label:"Add Manager"})],32)]),l(te),s("div",Ve,[l(k,{color:"warning",label:"Managers",class:"mb-4"}),s("div",Ne,[(o(!0),_(w,null,L(c.value.owners,e=>(o(),b(y,{key:e,"color-prop":"bg-slate-800 dark:bg-slate-800"},{default:r(()=>[s("div",xe,[s("div",Se,[s("div",Pe,[l(se,{username:e.username,avatar:e.avatar},null,8,["username","avatar"])]),s("h1",Ue,oe(e.username),1)]),l(d,{color:"danger",label:"Remove",onClick:p=>Q(e.id)},null,8,["onClick"])])]),_:2},1024))),128))])])]),_:1})])],64)):g("",!0),l(x,{icon:i(P),title:"Arcade Management",main:""},null,8,["icon"]),l(y,{"is-form":"",class:"mb-6",onSubmit:S(G,["prevent"])},{default:r(()=>[l(k,{color:"info",label:"Settings",icon:i(P),class:"mb-2"},null,8,["icon"]),s("div",Ce,[(o(!0),_(w,null,L(i(O),e=>(o(),b(h,{key:e.id,label:e.name,help:e.help},{default:r(()=>[e.type=="Boolean"?(o(),b(D,{key:0,name:e.id,"model-value":!!(i(F)(v.value,e.id)??!1),"input-value":!0,type:"switch","onUpdate:modelValue":p=>i(C)(v.value,e.id,p??!1)},null,8,["name","model-value","onUpdate:modelValue"])):g("",!0)]),_:2},1032,["label","help"]))),128))]),JSON.stringify(v.value)!==JSON.stringify(V.value)?(o(),_("div",Ie,[l(d,{color:"success",label:"Save",type:"submit"}),l(d,{color:"danger",label:"Revert",onClick:a[7]||(a[7]=e=>f())})])):g("",!0)]),_:1}),l(y,{class:"w-full md:w-1/2 mb-6"},{default:r(()=>[a[9]||(a[9]=s("h1",{class:"text-lg md:text-xl"},"OpenVPN Configuration",-1)),a[10]||(a[10]=s("p",{class:"pb-1 dark:text-white/50"}," Use this to download your VPN config. ",-1)),l(d,{small:!1,color:"success",class:"my-2",label:"Export",onClick:a[8]||(a[8]=e=>q())})]),_:1,__:[9,10]}),l(x,{icon:i(re),title:"Arcade Overview",main:""},null,8,["icon"]),s("div",Me,[l(ie,{number:c.value?.machines?.length,label:"Active Machines"},null,8,["number"])])],64))]),_:1})]),_:1}))}};export{Te as default};
