import{a as A,b as N,a7 as F,r as k,p as D,o as R,al as I,c as $,d as t,w as g,f as p,g as r,_ as B,j as u,F as v,e as d,i as l,l as b,P as G,bY as E,k as P,h as L,t as f,I as U,n as j}from"./index-DuDIkw19.js";import{_ as C}from"./FormControl-Hea20ohr.js";import{_ as T}from"./GameHeader-ClO35Fx_.js";import{b as M}from"./music-BrL7wlqs.js";import{A as W}from"./profile-Dru2pZHV.js";import"./sources-DpAwEq5_.js";const Y={class:"flex gap-2 mb-2 md:mb-0"},q={key:0,class:"md:w-1/3 md:text-right"},z={class:"lg:flex w-full lg:place-content-between"},H={class:"mb-4 lg:mb-0 space-y-1"},J={class:"text-lg lg:text-xl"},K={class:"text-md lg:text-lg"},O={class:"grid md:grid-cols-2 lg:flex gap-2 lg:justify-end lg:place-content-end"},Q={key:0,class:"bg-gray-900 dark:bg-gray-700 p-4 rounded-lg"},X={class:"text-md lg:text-lg"},le={__name:"PersonalRecords",setup(Z){const y=A(),V=N();var _=y.params.game;const s=F(_);var h=y.params.userId??null,m=k([]);const a=k(null),n=D({currentVersion:null});s||V.push({name:"ErrorPage",params:{catchAll:"404"}}),h||V.push({name:"ErrorPage",params:{catchAll:"404"}}),s.versions||(n.currentVersion=1),R(async()=>{try{const e=await M(_,h);m.value=e,w(),s.versions&&!n.currentVersion&&(n.currentVersion=x.value.at(-1)?.id??null)}catch(e){console.error("Failed to fetch score data:",e)}});async function w(){try{a.value=null;const e=await W(_,null,h);a.value=e}catch(e){console.error("Failed to fetch user profile data:",e)}}const x=I(()=>{if(!s.versions)return[];const e=new Set(m.value.map(o=>o.version));return s.versions.filter(o=>e.has(o.id))}),S=I(()=>n.currentVersion?m.value.filter(e=>e.version===n.currentVersion):m.value);return(e,o)=>(t(),$(j,null,{default:g(()=>[r(m)?(t(),$(B,{key:0},{default:g(()=>[a.value?(t(),u(v,{key:0},[d(T,{game:r(s),profile:a.value},null,8,["game","profile"]),l("div",Y,[d(b,{icon:e.mdiAccountDetails,href:`/#/games/${r(s).id}/profiles/${a.value.userId}`,outline:!1,color:"info",label:`${a.value.username}'s Profile`},null,8,["icon","href","label"]),d(b,{icon:e.mdiAccountDetails,href:`/#/games/${r(s).id}/scores/${a.value.userId}`,outline:!1,color:"info",label:`${a.value.username}'s Scores`},null,8,["icon","href","label"])]),d(G,{icon:r(E),title:`${a.value.username}'s ${r(s).shortName?r(s).shortName:r(s).name} Records`,main:""},{default:g(()=>[r(s).versions?(t(),u("div",q,[o[1]||(o[1]=l("h2",{class:"text-md sm:text-lg md:text-xl font-bold p-2"}," Select Version ",-1)),d(C,{modelValue:n.currentVersion,"onUpdate:modelValue":o[0]||(o[0]=i=>n.currentVersion=i),options:x.value.slice().reverse()},null,8,["modelValue","options"])])):p("",!0)]),_:1},8,["icon","title"]),(t(!0),u(v,null,P(S.value,i=>(t(),$(L,{key:i.id,class:"mb-6"},{default:g(()=>[l("div",z,[l("div",H,[l("h1",J,f(i.name),1),l("h2",K,f(i.artist),1),d(b,{label:"View Song",color:"info",href:`/#/games/${r(_)}/song/${i.id}`},null,8,["href"])]),l("div",O,[(t(!0),u(v,null,P(i.charts,c=>(t(),u(v,{key:c.db_id},[c.data?.difficulty!=0?(t(),u("div",Q,[l("h2",X,f(r(s).chartTable[c.chart])+" - "+f(c.data?.difficulty),1),U(" "+f(c.record?`${c.record?.username} - ${c.record.points?.toLocaleString()}`:"Unclaimed"),1)])):p("",!0)],64))),128))])])]),_:2},1024))),128))],64)):p("",!0)]),_:1})):p("",!0)]),_:1}))}};export{le as default};
