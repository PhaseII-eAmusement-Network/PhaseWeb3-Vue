import{u as S,s as E,c as m,a as d,w as n,b as s,_ as G,p as c,R as B,f as I,g as L,I as V,x,n as p,q as f,d as N,F as R,h as U,t as q,e as F,k as j,ah as M,a7 as z,aa as D}from"./index-WESnALLw.js";import{_}from"./FormField-CXNPGohG.js";import{e as i}from"./contentExport-ErA2aU9m.js";import{A as h}from"./profile-BWFjfO-Q.js";import{g as J,A as K}from"./music-BJyrxs2A.js";const O={class:"grid grid-cols-1 sm:grid-cols-2 gap-6 mb-6"},T={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"},H={class:"text-xl font-bold"},Q={class:"grid grid-cols-1 sm:grid-cols-2 gap-4"},oa={__name:"ExportView",setup(W){const t=S(),b=E(()=>t.userProfiles);function w(a){if(a){var r=[];for(const e of a){const o=D(e.game);o&&(e.gameData=o,r.push(e))}return r.sort((e,o)=>e.gameData.name.localeCompare(o.gameData.name)),r}}async function k(){const a=await M(t.userId);i("_user_account",a)}async function P(){const a=await z();i("_user_cards",a)}async function $(a){const e={versionKey:D(a).versions??null},o=await h(a,null,t.userId);if(!o?.versions){window.alert("Failed to export data!");return}const u=[...o.versions],y=u.length>1?u.pop():1,g=l=>{if(!l)return null;const{versions:v,stats:X,machine_judge_adjust:Y,...A}=l;return A};t.continueLoad=u.length>0;for(const l of u){const v=await h(a,l,t.userId);e[l]=g(v)}t.continueLoad=!1,t.isLoading=!1,t.isSaving=!1,t.activeRequests=0,t.activeSavingRequests=0,e[y]=g(o),i(`_${a}_profiles`,e)}async function C(a){const r=await J(a,t.userId);i(`_${a}_attempts`,r);const e=await K(a,t.userId);i(`_${a}_records`,e)}return(a,r)=>(d(),m(j,null,{default:n(()=>[s(G,null,{default:n(()=>[s(B,{class:"mb-6","use-small":"","even-smaller":""}),s(I,{icon:L(V),title:"Export your Data",main:""},null,8,["icon"]),s(x,{color:"success",label:"Personal Data",class:"mb-4"}),c("div",O,[s(p,null,{default:n(()=>[s(_,{label:"General Data",help:"Basic user data for your account (email, Discord info, Tachi info, news, app settings)"},{default:n(()=>[s(f,{color:"success",label:"Export",onClick:k})]),_:1})]),_:1}),s(p,null,{default:n(()=>[s(_,{label:"Card Data",help:"Login cards (exported as internal and access code)"},{default:n(()=>[s(f,{color:"success",label:"Export",onClick:P})]),_:1})]),_:1})]),s(x,{color:"warning",label:"Profile Data",class:"mb-4"}),c("div",T,[(d(!0),N(R,null,U(w(b.value),e=>(d(),m(p,null,{default:n(()=>[c("h1",H,q(e.gameData.name),1),r[0]||(r[0]=c("hr",{class:"mb-4"},null,-1)),c("div",Q,[s(_,{label:"Account Data",help:"Data for the account (all played versions) for event tracking and settings. Does not include scores."},{default:n(()=>[s(f,{color:"success",label:"Export",onClick:o=>$(e.game)},null,8,["onClick"])]),_:2},1024),e.gameData.noScores?F("",!0):(d(),m(_,{key:0,label:"Score Data",help:"Data for music, scores, and records. May take a while to export."},{default:n(()=>[s(f,{color:"success",label:"Export",onClick:o=>C(e.game)},null,8,["onClick"])]),_:2},1024))])]),_:2,__:[0]},1024))),256))])]),_:1})]),_:1}))}};export{oa as default};
